---
ms.date: 12/12/2018
keywords: dsc,powershell,configuration,setup
title: Configuración del LCM en PowerShell 4.0
ms.openlocfilehash: 747b15c483c79a7ecbb62214ef5a59f8dc137bd4
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2019
ms.locfileid: "71953832"
---
# <a name="configuring-the-lcm-in-powershell-40"></a><span data-ttu-id="57323-103">Configuración del LCM en PowerShell 4.0</span><span class="sxs-lookup"><span data-stu-id="57323-103">Configuring the LCM in PowerShell 4.0</span></span>

><span data-ttu-id="57323-104">Se aplica a: Windows PowerShell 4.0</span><span class="sxs-lookup"><span data-stu-id="57323-104">Applies To: Windows PowerShell 4.0</span></span>

<span data-ttu-id="57323-105">**Para obtener información relacionada con Windows PowerShell 5.0 y versiones posteriores, consulte [Configuración del administrador de configuración local](metaConfig.md).**</span><span class="sxs-lookup"><span data-stu-id="57323-105">**For information related to Windows PowerShell 5.0 and later, see [Configuring the Local Configuration Manager](metaConfig.md).**</span></span>

<span data-ttu-id="57323-106">El administrador de configuración local es el motor de la configuración de estado deseado (DSC) de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="57323-106">Local Configuration Manager is the Windows PowerShell Desired State Configuration (DSC) engine.</span></span>
<span data-ttu-id="57323-107">Se ejecuta en todos los nodos de destino y es el responsable de llamar a los recursos de configuración que se incluyen en un script de configuración DSC.</span><span class="sxs-lookup"><span data-stu-id="57323-107">It runs on all target nodes, and it is responsible for calling the configuration resources that are included in a DSC configuration script.</span></span>
<span data-ttu-id="57323-108">En este tema se enumeran las propiedades del administrador de configuración local y se describe cómo puede modificar la configuración del administrador de configuración local en un nodo de destino.</span><span class="sxs-lookup"><span data-stu-id="57323-108">This topic lists the properties of Local Configuration Manager and describes how you can modify the Local Configuration Manager settings on a target node.</span></span>

## <a name="local-configuration-manager-properties"></a><span data-ttu-id="57323-109">Propiedades del administrador de configuración local</span><span class="sxs-lookup"><span data-stu-id="57323-109">Local Configuration Manager properties</span></span>

<span data-ttu-id="57323-110">A continuación se enumeran las propiedades del administrador de configuración local que se pueden establecer o recuperar.</span><span class="sxs-lookup"><span data-stu-id="57323-110">The following lists the Local Configuration Manager properties that you can set or retrieve.</span></span>

- <span data-ttu-id="57323-111">**AllowModuleOverwrite**: controla si se permite que las nuevas configuraciones descargadas desde el servicio de configuración sobrescriban las antiguas en el nodo de destino.</span><span class="sxs-lookup"><span data-stu-id="57323-111">**AllowModuleOverwrite**: Controls whether new configurations downloaded from the configuration service are allowed to overwrite the old ones on the target node.</span></span> <span data-ttu-id="57323-112">Los valores posibles son True y False.</span><span class="sxs-lookup"><span data-stu-id="57323-112">Possible values are True and False.</span></span>
- <span data-ttu-id="57323-113">**CertificateID**: La huella digital de un certificado usado para proteger las credenciales que se han pasado en una configuración.</span><span class="sxs-lookup"><span data-stu-id="57323-113">**CertificateID**: The thumbprint of a certificate used to secure credentials passed in a configuration.</span></span> <span data-ttu-id="57323-114">Para más información, consulte [Want to secure credentials in Windows PowerShell Desired State Configuration?](https://blogs.msdn.microsoft.com/powershell/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration/) (¿Quiere proteger las credenciales de configuración de estado deseado de Windows PowerShell?).</span><span class="sxs-lookup"><span data-stu-id="57323-114">For more information see [Want to secure credentials in Windows PowerShell Desired State Configuration?](https://blogs.msdn.microsoft.com/powershell/2014/01/31/want-to-secure-credentials-in-windows-powershell-desired-state-configuration/).</span></span>
- <span data-ttu-id="57323-115">**ConfigurationID**: indica un GUID que se usa para obtener un archivo de configuración determinado de un servicio de extracción.</span><span class="sxs-lookup"><span data-stu-id="57323-115">**ConfigurationID**: Indicates a GUID which is used to get a particular configuration file from a pull service.</span></span> <span data-ttu-id="57323-116">El GUID garantiza que se acceda al archivo de configuración correcto.</span><span class="sxs-lookup"><span data-stu-id="57323-116">The GUID ensures that the correct configuration file is accessed.</span></span>
- <span data-ttu-id="57323-117">**ConfigurationMode**: especifica cómo aplica realmente el administrador de configuración local la configuración en los nodos de destino.</span><span class="sxs-lookup"><span data-stu-id="57323-117">**ConfigurationMode**: Specifies how the Local Configuration Manager actually applies the configuration to the target nodes.</span></span> <span data-ttu-id="57323-118">Puede tomar los valores siguientes:</span><span class="sxs-lookup"><span data-stu-id="57323-118">It can take the following values:</span></span>
  - <span data-ttu-id="57323-119">**ApplyOnly**: con esta opción, DSC aplica la configuración y no hace nada más, a menos que se detecte una nueva configuración, ya sea porque envíe una configuración nueva directamente al nodo de destino, o bien porque se esté está conectando a un servicio de extracción y DSC detecte una configuración nueva al efectuar una comprobación con el servidor de extracción.</span><span class="sxs-lookup"><span data-stu-id="57323-119">**ApplyOnly**: With this option, DSC applies the configuration and does nothing further unless a new configuration is detected, either by you sending a new configuration directly to the target node or if you are connecting to a pull service and DSC discovers a new configuration when it checks with the pull service.</span></span> <span data-ttu-id="57323-120">Si se desplaza la configuración del nodo de destino, no se realiza ninguna acción.</span><span class="sxs-lookup"><span data-stu-id="57323-120">If the target node's configuration drifts, no action is taken.</span></span>
  - <span data-ttu-id="57323-121">**ApplyAndMonitor**: con esta opción (que es el valor predeterminado), DSC aplica a las nuevas configuraciones, ya sea porque las envía directamente al nodo de destino o porque se detectan en un servicio de extracción.</span><span class="sxs-lookup"><span data-stu-id="57323-121">**ApplyAndMonitor**: With this option (which is the default), DSC applies any new configurations, whether sent by you directly to the target node or discovered on a pull service.</span></span> <span data-ttu-id="57323-122">A partir de ahí, si la configuración del nodo de destino se desplaza del archivo de configuración, DSC notifica la discrepancia en los registros.</span><span class="sxs-lookup"><span data-stu-id="57323-122">Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs.</span></span> <span data-ttu-id="57323-123">Para conocer más sobre el registro de DSC, consulte [Uso de registros de eventos para diagnosticar errores de la configuración de estado deseado](https://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx).</span><span class="sxs-lookup"><span data-stu-id="57323-123">For more about DSC logging, see [Using Event Logs to Diagnose Errors in Desired State Configuration](https://blogs.msdn.com/b/powershell/archive/2014/01/03/using-event-logs-to-diagnose-errors-in-desired-state-configuration.aspx).</span></span>
  - <span data-ttu-id="57323-124">**ApplyAndAutoCorrect**: con esta opción, DSC aplica a las nuevas configuraciones, ya sea porque las envía directamente al nodo de destino o porque se detectan en un servicio de extracción.</span><span class="sxs-lookup"><span data-stu-id="57323-124">**ApplyAndAutoCorrect**: With this option, DSC applies any new configurations, whether sent by you directly to the target node or discovered on a pull service.</span></span> <span data-ttu-id="57323-125">A partir de ahí, si la configuración del nodo de destino se desplaza del archivo de configuración, DSC notifica la discrepancia en los registros y luego intenta ajustar la configuración del nodo de destino para que sea conforme con el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="57323-125">Thereafter, if the configuration of the target node drifts from the configuration file, DSC reports the discrepancy in logs, and then attempts to adjust the target node configuration to bring in compliance with the configuration file.</span></span>
- <span data-ttu-id="57323-126">**ConfigurationModeFrequencyMins**: Representa la frecuencia (en minutos) con la que la aplicación de fondo de DSC intenta implementar la configuración actual en el nodo de destino.</span><span class="sxs-lookup"><span data-stu-id="57323-126">**ConfigurationModeFrequencyMins**: Represents the frequency (in minutes) at which the background application of DSC attempts to implement the current configuration on the target node.</span></span> <span data-ttu-id="57323-127">El valor predeterminado es 15.</span><span class="sxs-lookup"><span data-stu-id="57323-127">The default value is 15.</span></span> <span data-ttu-id="57323-128">Este valor se puede establecer en combinación con RefreshMode.</span><span class="sxs-lookup"><span data-stu-id="57323-128">This value can be set in conjunction with RefreshMode.</span></span> <span data-ttu-id="57323-129">Cuando el valor de RefreshMode se establece en PULL, el nodo de destino contacta con el servicio de configuración en un intervalo que establece el valor de RefreshFrequencyMins y descarga la configuración actual.</span><span class="sxs-lookup"><span data-stu-id="57323-129">When RefreshMode is set to PULL, the target node contacts the configuration service at an interval set by RefreshFrequencyMins and downloads the current configuration.</span></span> <span data-ttu-id="57323-130">Independientemente del valor de RefreshMode, en el intervalo que define ConfigurationModeFrequencyMins, el motor de coherencia aplica la configuración más reciente que se haya descargado en el nodo de destino.</span><span class="sxs-lookup"><span data-stu-id="57323-130">Regardless of the RefreshMode value, at the interval set by ConfigurationModeFrequencyMins, the consistency engine applies the latest configuration that was downloaded to the target node.</span></span> <span data-ttu-id="57323-131">El valor de RefreshFrequencyMins debe establecerse en un entero que sea múltiplo del valor de ConfigurationModeFrequencyMins.</span><span class="sxs-lookup"><span data-stu-id="57323-131">RefreshFrequencyMins should be set to an integer multiple of ConfigurationModeFrequencyMins.</span></span>
- <span data-ttu-id="57323-132">**Credential**: indica las credenciales (como ocurre con Get-Credential) necesarias para acceder a recursos remotos, como para contactar con el servicio de configuración.</span><span class="sxs-lookup"><span data-stu-id="57323-132">**Credential**: Indicates credentials (as with Get-Credential) required to access remote resources, such as to contact the configuration service.</span></span>
- <span data-ttu-id="57323-133">**DownloadManagerCustomData**: representa una matriz que contiene datos personalizados específicos del administrador de descargas.</span><span class="sxs-lookup"><span data-stu-id="57323-133">**DownloadManagerCustomData**: Represents an array that contains custom data specific to the download manager.</span></span>
- <span data-ttu-id="57323-134">**DownloadManagerName**: indica el nombre de la configuración y el administrador de descargas del módulo.</span><span class="sxs-lookup"><span data-stu-id="57323-134">**DownloadManagerName**: Indicates the name of the configuration and module download manager.</span></span>
- <span data-ttu-id="57323-135">**RebootNodeIfNeeded**: Establezca esta opción en `$true` para permitir que los recursos reinicien el nodo usando la marca `$global:DSCMachineStatus`.</span><span class="sxs-lookup"><span data-stu-id="57323-135">**RebootNodeIfNeeded**: Set this to `$true` to allow resources to reboot the Node using the `$global:DSCMachineStatus` flag.</span></span> <span data-ttu-id="57323-136">De lo contrario, tendrá que reiniciar manualmente el nodo de configuración que lo requiera.</span><span class="sxs-lookup"><span data-stu-id="57323-136">Otherwise, you will have to manually reboot the node for any configuration that requires it.</span></span> <span data-ttu-id="57323-137">El valor predeterminado es `$false`.</span><span class="sxs-lookup"><span data-stu-id="57323-137">The default value is `$false`.</span></span> <span data-ttu-id="57323-138">Para usar esta configuración cuando una instancia distinta de DSC (como Windows Installer) implementa una condición de reinicio, combine la configuración con el módulo [xPendingReboot](https://github.com/powershell/xpendingreboot).</span><span class="sxs-lookup"><span data-stu-id="57323-138">To use this setting when a reboot condition is enacted by something other than DSC (such as Windows Installer), combine this setting with the [xPendingReboot](https://github.com/powershell/xpendingreboot) module.</span></span>
- <span data-ttu-id="57323-139">**RefreshFrequencyMins**: se usa cuando se ha configurado un servicio de extracción.</span><span class="sxs-lookup"><span data-stu-id="57323-139">**RefreshFrequencyMins**: Used when you have set up a pull service.</span></span> <span data-ttu-id="57323-140">Representa la frecuencia (en minutos) con que el administrador de configuración local contacta con un servicio de extracción para descargar la configuración actual.</span><span class="sxs-lookup"><span data-stu-id="57323-140">Represents the frequency (in minutes) at which the Local Configuration Manager contacts a pull service to download the current configuration.</span></span> <span data-ttu-id="57323-141">Este valor se puede establecer junto con ConfigurationModeFrequencyMins.</span><span class="sxs-lookup"><span data-stu-id="57323-141">This value can be set in conjunction with ConfigurationModeFrequencyMins.</span></span> <span data-ttu-id="57323-142">Cuando el valor de RefreshMode se establece en PULL, el nodo de destino contacta con el servicio de extracción "pull" en un intervalo que establece el valor de RefreshFrequencyMins y descarga la configuración actual.</span><span class="sxs-lookup"><span data-stu-id="57323-142">When RefreshMode is set to PULL, the target node contacts the pull service at an interval set by RefreshFrequencyMins and downloads the current configuration.</span></span> <span data-ttu-id="57323-143">En el intervalo que define ConfigurationModeFrequencyMins, el motor de coherencia aplica la configuración más reciente que se haya descargado en el nodo de destino.</span><span class="sxs-lookup"><span data-stu-id="57323-143">At the interval set by ConfigurationModeFrequencyMins, the consistency engine then applies the latest configuration that was downloaded to the target node.</span></span> <span data-ttu-id="57323-144">Si el valor de RefreshFrequencyMins no se establece en un entero que sea múltiplo del valor de ConfigurationModeFrequencyMins, el sistema lo redondeará al alza.</span><span class="sxs-lookup"><span data-stu-id="57323-144">If RefreshFrequencyMins is not set to an integer multiple of ConfigurationModeFrequencyMins, the system will round it up.</span></span> <span data-ttu-id="57323-145">El valor predeterminado es 30.</span><span class="sxs-lookup"><span data-stu-id="57323-145">The default value is 30.</span></span>
- <span data-ttu-id="57323-146">**RefreshMode**: los valores posibles son **Push** (el valor predeterminado) y **Pull**.</span><span class="sxs-lookup"><span data-stu-id="57323-146">**RefreshMode**: Possible values are **Push** (the default) and **Pull**.</span></span> <span data-ttu-id="57323-147">En la configuración "push", debe colocar un archivo de configuración en cada nodo de destino, mediante cualquier equipo cliente.</span><span class="sxs-lookup"><span data-stu-id="57323-147">In the "push" configuration, you must place a configuration file on each target node, using any client computer.</span></span> <span data-ttu-id="57323-148">En el modo "pull", debe configurar un servicio de extracción con el que el administrador de configuración local contacte y acceda a los archivos de configuración.</span><span class="sxs-lookup"><span data-stu-id="57323-148">In the "pull" mode, you must set up a pull service for Local Configuration Manager to contact and access the configuration files.</span></span>

> [!NOTE]
> <span data-ttu-id="57323-149">El LCM inicia el ciclo **ConfigurationModeFrequencyMins** según lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="57323-149">The LCM starts the **ConfigurationModeFrequencyMins** cycle based on:</span></span>
>
> - <span data-ttu-id="57323-150">Se aplica una metaconfiguración nueva usando `Set-DscLocalConfigurationManager`</span><span class="sxs-lookup"><span data-stu-id="57323-150">A new metaconfig is applied using `Set-DscLocalConfigurationManager`</span></span>
> - <span data-ttu-id="57323-151">Un reinicio del equipo</span><span class="sxs-lookup"><span data-stu-id="57323-151">A machine restart</span></span>
>
> <span data-ttu-id="57323-152">En cualquier condición en la cual el proceso de temporizador experimente un bloqueo, se detectará dentro del plazo de 30 segundos y se reiniciará el ciclo.</span><span class="sxs-lookup"><span data-stu-id="57323-152">For any condition where the timer process experiences a crash, that will be detected within 30 seconds and the cycle will be restarted.</span></span>
> <span data-ttu-id="57323-153">Una operación simultánea puede retrasar el ciclo de inicio; si la duración de esta operación supera la frecuencia del ciclo configurado, el siguiente temporizador no se iniciará.</span><span class="sxs-lookup"><span data-stu-id="57323-153">A concurrent operation could delay the cycle from being started, if the duration of this operation exceeds the configured cycle frequency, the next timer will not start.</span></span>
>
> <span data-ttu-id="57323-154">Por ejemplo, la metaconfiguración se configura con una frecuencia de extracción de 15 minutos y se produce una extracción en T1.</span><span class="sxs-lookup"><span data-stu-id="57323-154">Example, the metaconfig is configured at a 15 minute pull frequency and a pull occurs at T1.</span></span>  <span data-ttu-id="57323-155">El nodo no finaliza el trabajo en 16 minutos.</span><span class="sxs-lookup"><span data-stu-id="57323-155">The Node does not finish work for 16 minutes.</span></span>  <span data-ttu-id="57323-156">Se omite el primer ciclo de 15 minutos y la extracción siguiente se realizará en T1+15+15.</span><span class="sxs-lookup"><span data-stu-id="57323-156">The first 15 minute cycle is ignored, and next pull will happen at T1+15+15.</span></span>

### <a name="example-of-updating-local-configuration-manager-settings"></a><span data-ttu-id="57323-157">Ejemplo de actualización de la configuración del administrador de configuración local</span><span class="sxs-lookup"><span data-stu-id="57323-157">Example of updating Local Configuration Manager settings</span></span>

<span data-ttu-id="57323-158">Puede actualizar la configuración del administrador de configuración local de un nodo de destino si incluye un bloque **LocalConfigurationManager** dentro del bloque del nodo en un script de configuración, como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="57323-158">You can update the Local Configuration Manager settings of a target node by including a **LocalConfigurationManager** block inside the node block in a configuration script, as shown in the following example.</span></span>

```powershell
Configuration ExampleConfig
{
    Node "Server001"
    {
        LocalConfigurationManager
        {
            ConfigurationID = "646e48cb-3082-4a12-9fd9-f71b9a562d4e"
            ConfigurationModeFrequencyMins = 45
            ConfigurationMode = "ApplyAndAutocorrect"
            RefreshMode = "Pull"
            RefreshFrequencyMins = 90
            DownloadManagerName = "WebDownloadManager"
            DownloadManagerCustomData = (@{ServerUrl="https://$PullService/psdscpullserver.svc"})
            CertificateID = "71AA68562316FE3F73536F1096B85D66289ED60E"
            Credential = $cred
            RebootNodeIfNeeded = $true
            AllowModuleOverwrite = $false
        }
# One or more resource blocks can be added here
    }
}

# The following line invokes the configuration and creates a file called Server001.meta.mof at the specified path
ExampleConfig -OutputPath "c:\users\public\dsc"
```

<span data-ttu-id="57323-159">La ejecución del script del ejemplo anterior genera un archivo MOF que especifica y almacena la configuración deseada.</span><span class="sxs-lookup"><span data-stu-id="57323-159">Running the script in the previous example generates a MOF file that specifies and stores the desired settings.</span></span>
<span data-ttu-id="57323-160">Para aplicar la configuración, puede usar el cmdlet **Set-DscLocalConfigurationManager**, como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="57323-160">To apply the settings, you can use the **Set-DscLocalConfigurationManager** cmdlet, as shown in the following example.</span></span>

```powershell
Set-DscLocalConfigurationManager -Path "c:\users\public\dsc"
```

> [!NOTE]
> <span data-ttu-id="57323-161">Para el parámetro **Path**, debe especificar la misma ruta de acceso que haya especificado para el parámetro **OutputPath** al invocar la configuración del ejemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="57323-161">For the **Path** parameter, you must specify the same path that you specified for the **OutputPath** parameter when you invoked the configuration in the previous example.</span></span>

<span data-ttu-id="57323-162">Para ver la configuración actual del administrador de configuración local, puede utilizar el cmdlet **Get-DscLocalConfigurationManager**.</span><span class="sxs-lookup"><span data-stu-id="57323-162">To see the current Local Configuration Manager settings, you can use the **Get-DscLocalConfigurationManager** cmdlet.</span></span>
<span data-ttu-id="57323-163">Si invoca este cmdlet sin parámetros, de forma predeterminada obtendrá la configuración del administrador de configuración local del nodo en el que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="57323-163">If you invoke this cmdlet with no parameters, by default it will get the Local Configuration Manager settings for the node on which you run it.</span></span>
<span data-ttu-id="57323-164">Para especificar otro nodo, use el parámetro **CimSession** con este cmdlet.</span><span class="sxs-lookup"><span data-stu-id="57323-164">To specify another node, use the **CimSession** parameter with this cmdlet.</span></span>
