---
title: Importar un módulo de PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 697791b3-2135-4a39-b9d7-8566ed67acf2
caps.latest.revision: 13
ms.openlocfilehash: bb5d036e5658c365a4fafa2cac05c0bba9f87019
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/15/2019
ms.locfileid: "72360704"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="be087-102">Importación de un módulo de PowerShell</span><span class="sxs-lookup"><span data-stu-id="be087-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="be087-103">Una vez que haya instalado un módulo en un sistema, es probable que desee importar el módulo.</span><span class="sxs-lookup"><span data-stu-id="be087-103">Once your have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="be087-104">La importación es el proceso que carga el módulo en la memoria activa, para que un usuario pueda acceder a ese módulo en su sesión de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="be087-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="be087-105">En PowerShell 2,0, puede importar un módulo de PowerShell recién instalado con una llamada al cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) .</span><span class="sxs-lookup"><span data-stu-id="be087-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="be087-106">En PowerShell 3,0, PowerShell puede importar implícitamente un módulo cuando un usuario llama a una de las funciones o cmdlets del módulo.</span><span class="sxs-lookup"><span data-stu-id="be087-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="be087-107">Tenga en cuenta que ambas versiones suponen que instala el módulo en una ubicación donde PowerShell puede encontrarlo; para obtener más información, vea [instalar un módulo de PowerShell](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="be087-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span> <span data-ttu-id="be087-108">Puede usar un manifiesto de módulo para restringir qué partes del módulo se exportan y puede usar los parámetros de la llamada `Import-Module` para restringir qué partes se importan.</span><span class="sxs-lookup"><span data-stu-id="be087-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="be087-109">Importar un complemento (PowerShell 1,0)</span><span class="sxs-lookup"><span data-stu-id="be087-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="be087-110">Los módulos no existían en PowerShell 1,0: en su lugar, tenía que registrar y usar complementos. Sin embargo, no se recomienda usar esta tecnología en este momento, ya que los módulos suelen ser más fáciles de instalar e importar.</span><span class="sxs-lookup"><span data-stu-id="be087-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="be087-111">Para obtener más información, vea [Cómo crear un complemento de Windows PowerShell](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="be087-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="be087-112">Importar un módulo con Import-Module (PowerShell 2,0)</span><span class="sxs-lookup"><span data-stu-id="be087-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="be087-113">PowerShell 2,0 usa el cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) con el nombre adecuado para importar módulos.</span><span class="sxs-lookup"><span data-stu-id="be087-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="be087-114">Cuando se ejecuta este cmdlet, Windows PowerShell busca el módulo especificado en los directorios especificados en la variable `PSModulePath`.</span><span class="sxs-lookup"><span data-stu-id="be087-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="be087-115">Cuando se encuentra el directorio especificado, Windows PowerShell busca archivos en el siguiente orden: archivos de manifiesto de módulo (. psd1), archivos de módulo de script (. psm1), archivos de módulo binario (. dll).</span><span class="sxs-lookup"><span data-stu-id="be087-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="be087-116">Para obtener más información sobre cómo agregar directorios a la búsqueda, consulte [modificar la ruta de instalación de PSModulePath](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="be087-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span> <span data-ttu-id="be087-117">En el código siguiente se describe cómo importar un módulo:</span><span class="sxs-lookup"><span data-stu-id="be087-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="be087-118">Suponiendo que MyModule se encuentre en el `PSModulePath`, PowerShell cargaría MyModule en la memoria activa.</span><span class="sxs-lookup"><span data-stu-id="be087-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="be087-119">Si no se encuentra MyModule en una ruta de acceso `PSModulePath`, puede indicar explícitamente a PowerShell dónde encontrarlo:</span><span class="sxs-lookup"><span data-stu-id="be087-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="be087-120">También puede usar el parámetro-verbose para identificar lo que se va a exportar fuera del módulo y lo que se va a importar en la memoria activa.</span><span class="sxs-lookup"><span data-stu-id="be087-120">You can also use the -verbose parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="be087-121">Las exportaciones y las importaciones restringen lo que se expone al usuario: la diferencia es quién controla la visibilidad.</span><span class="sxs-lookup"><span data-stu-id="be087-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="be087-122">Esencialmente, las exportaciones se controlan mediante código dentro del módulo.</span><span class="sxs-lookup"><span data-stu-id="be087-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="be087-123">Por el contrario, la llamada `Import-Module` controla las importaciones.</span><span class="sxs-lookup"><span data-stu-id="be087-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="be087-124">Para obtener más información, vea **restringir los miembros que se importan**a continuación.</span><span class="sxs-lookup"><span data-stu-id="be087-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="be087-125">Importación implícita de un módulo (PowerShell 3,0)</span><span class="sxs-lookup"><span data-stu-id="be087-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="be087-126">A partir de Windows PowerShell 3,0, los módulos se importan automáticamente cuando cualquier cmdlet o función del módulo se usa en un comando.</span><span class="sxs-lookup"><span data-stu-id="be087-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="be087-127">Esta característica funciona en cualquier módulo de un directorio que se incluye en el valor de la variable de entorno **PSModulePath** .</span><span class="sxs-lookup"><span data-stu-id="be087-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="be087-128">Sin embargo, si no guarda el módulo en una ruta de acceso válida, todavía puede cargarlo mediante la opción [de Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) explícita, descrita anteriormente.</span><span class="sxs-lookup"><span data-stu-id="be087-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="be087-129">Las siguientes acciones desencadenan la importación automática de un módulo, también conocido como "carga automática de módulos".</span><span class="sxs-lookup"><span data-stu-id="be087-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="be087-130">Usar un cmdlet en un comando.</span><span class="sxs-lookup"><span data-stu-id="be087-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="be087-131">Por ejemplo, al escribir `Get-ExecutionPolicy` se importa el módulo Microsoft. PowerShell. Security que contiene el cmdlet `Get-ExecutionPolicy`.</span><span class="sxs-lookup"><span data-stu-id="be087-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="be087-132">Usar el cmdlet [get-command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) para obtener el comando.</span><span class="sxs-lookup"><span data-stu-id="be087-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span>  <span data-ttu-id="be087-133">Por ejemplo, al escribir `Get-Command Get-JobTrigger` se importa el módulo **PSScheduledJob** que contiene el cmdlet @no__t 2.</span><span class="sxs-lookup"><span data-stu-id="be087-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="be087-134">Un comando `Get-Command` que incluye caracteres comodín se considera detección y no desencadena la importación de un módulo.</span><span class="sxs-lookup"><span data-stu-id="be087-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="be087-135">Use el cmdlet [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) para obtener ayuda para un cmdlet.</span><span class="sxs-lookup"><span data-stu-id="be087-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="be087-136">Por ejemplo, al escribir `Get-Help Get-WinEvent` se importa el módulo Microsoft. PowerShell. Diagnostics que contiene el cmdlet `Get-WinEvent`.</span><span class="sxs-lookup"><span data-stu-id="be087-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="be087-137">Para admitir la importación automática de módulos, el cmdlet `Get-Command` obtiene todos los cmdlets y las funciones de todos los módulos instalados, incluso si el módulo no se importa en la sesión.</span><span class="sxs-lookup"><span data-stu-id="be087-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="be087-138">Para obtener más información, vea el tema de ayuda para el cmdlet [get-command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) .</span><span class="sxs-lookup"><span data-stu-id="be087-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="be087-139">El proceso de importación</span><span class="sxs-lookup"><span data-stu-id="be087-139">The Importing Process</span></span>

<span data-ttu-id="be087-140">Cuando se importa un módulo, se crea un nuevo estado de sesión para el módulo y se crea un objeto [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) en la memoria.</span><span class="sxs-lookup"><span data-stu-id="be087-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="be087-141">Se crea un estado de sesión para cada módulo que se importa (esto incluye el módulo raíz y los módulos anidados).</span><span class="sxs-lookup"><span data-stu-id="be087-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="be087-142">Los miembros que se exportan desde el módulo raíz, incluidos los miembros que se exportaron al módulo raíz mediante cualquier módulo anidado, se importan después en el estado de sesión del llamador.</span><span class="sxs-lookup"><span data-stu-id="be087-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="be087-143">Los metadatos de los miembros que se exportan desde un módulo tienen una propiedad ModuleName.</span><span class="sxs-lookup"><span data-stu-id="be087-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="be087-144">Esta propiedad se rellena con el nombre del módulo que los exportó.</span><span class="sxs-lookup"><span data-stu-id="be087-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="be087-145">Si el nombre de un miembro exportado usa un verbo no aprobado o si el nombre del miembro usa caracteres restringidos, se muestra una advertencia cuando se ejecuta el cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) .</span><span class="sxs-lookup"><span data-stu-id="be087-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="be087-146">De forma predeterminada, el cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) no devuelve ningún objeto a la canalización.</span><span class="sxs-lookup"><span data-stu-id="be087-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="be087-147">Sin embargo, el cmdlet admite un parámetro `PassThru` que se puede usar para devolver un objeto [System. Management. Automation. PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) para cada módulo que se importa.</span><span class="sxs-lookup"><span data-stu-id="be087-147">However, the cmdlet supports a `PassThru` parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="be087-148">Para enviar la salida al host, los usuarios deben ejecutar el cmdlet [write-host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) .</span><span class="sxs-lookup"><span data-stu-id="be087-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="be087-149">Restringir los miembros que se importan</span><span class="sxs-lookup"><span data-stu-id="be087-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="be087-150">Cuando se importa un módulo mediante el cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) , de forma predeterminada, todos los miembros de módulo exportados se importan en la sesión, incluidos los comandos exportados al módulo por un módulo anidado.</span><span class="sxs-lookup"><span data-stu-id="be087-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="be087-151">De forma predeterminada, las variables y los alias no se exportan.</span><span class="sxs-lookup"><span data-stu-id="be087-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="be087-152">Para restringir los miembros que se exportan, use un [manifiesto del módulo](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="be087-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span> <span data-ttu-id="be087-153">Para restringir los miembros que se importan, use los parámetros siguientes del cmdlet `Import-Module`.</span><span class="sxs-lookup"><span data-stu-id="be087-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="be087-154">`Function`: este parámetro restringe las funciones que se exportan.</span><span class="sxs-lookup"><span data-stu-id="be087-154">`Function`: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="be087-155">(Si usa un manifiesto de módulo, consulte la clave FunctionsToExport).</span><span class="sxs-lookup"><span data-stu-id="be087-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="be087-156">`Cmdlet`: este parámetro restringe los cmdlets que se exportan (si usa un manifiesto de módulo, consulte la clave CmdletsToExport).</span><span class="sxs-lookup"><span data-stu-id="be087-156">`Cmdlet`: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="be087-157">`Variable`: este parámetro restringe las variables que se exportan (si usa un manifiesto de módulo, consulte la clave VariablesToExport).</span><span class="sxs-lookup"><span data-stu-id="be087-157">`Variable`: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="be087-158">`Alias`: este parámetro restringe los alias que se exportan (si usa un manifiesto de módulo, consulte la clave AliasesToExport).</span><span class="sxs-lookup"><span data-stu-id="be087-158">`Alias`: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="be087-159">Véase también</span><span class="sxs-lookup"><span data-stu-id="be087-159">See Also</span></span>

[<span data-ttu-id="be087-160">Escribir un módulo de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="be087-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
