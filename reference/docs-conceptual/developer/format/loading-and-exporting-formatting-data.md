---
title: Cargar y exportar datos de formato | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a48de31-7961-4b0e-b58b-93466e38370b
caps.latest.revision: 6
ms.openlocfilehash: 5c5168ffd74c15066b914ad1b39d9ead947c5e7f
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2019
ms.locfileid: "72365124"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="fba33-102">Carga y exportación de datos de formato</span><span class="sxs-lookup"><span data-stu-id="fba33-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="fba33-103">Una vez que haya creado el archivo de formato, debe actualizar los datos de formato de la sesión cargando los archivos en la sesión actual.</span><span class="sxs-lookup"><span data-stu-id="fba33-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="fba33-104">(Los archivos de formato proporcionados por Windows PowerShell se cargan mediante complementos que se registran cuando se abre la sesión actual). Una vez que se actualizan los datos de formato de la sesión actual, Windows PowerShell usa esos datos para mostrar los objetos .NET asociados a las vistas definidas en los archivos de formato cargados.</span><span class="sxs-lookup"><span data-stu-id="fba33-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="fba33-105">No hay ningún límite en cuanto al número de archivos de formato que se pueden cargar en la sesión actual.</span><span class="sxs-lookup"><span data-stu-id="fba33-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="fba33-106">Además de actualizar los datos de formato, puede volver a exportar los datos de formato de la sesión actual a un archivo de formato.</span><span class="sxs-lookup"><span data-stu-id="fba33-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="fba33-107">Cargando datos de formato</span><span class="sxs-lookup"><span data-stu-id="fba33-107">Loading format data</span></span>

<span data-ttu-id="fba33-108">Los archivos de formato se pueden cargar en la sesión actual mediante los métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="fba33-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="fba33-109">Puede importar el archivo de formato a la sesión actual desde la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="fba33-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="fba33-110">Use el cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) como se describe en el procedimiento siguiente.</span><span class="sxs-lookup"><span data-stu-id="fba33-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="fba33-111">Puede crear un manifiesto de módulo que haga referencia al archivo de formato.</span><span class="sxs-lookup"><span data-stu-id="fba33-111">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="fba33-112">Los módulos le permiten empaquetar los archivos de formato para su distribución.</span><span class="sxs-lookup"><span data-stu-id="fba33-112">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="fba33-113">Use el cmdlet [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) para crear el manifiesto y el cmdlet [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) para cargar el módulo en la sesión actual.</span><span class="sxs-lookup"><span data-stu-id="fba33-113">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="fba33-114">Para obtener más información sobre los módulos, consulte [escribir un módulo de Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="fba33-114">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="fba33-115">Puede crear un complemento que haga referencia al archivo de formato.</span><span class="sxs-lookup"><span data-stu-id="fba33-115">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="fba33-116">Use [System. Management. Automation. PSSnapIn. Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) para hacer referencia a los archivos de formato.</span><span class="sxs-lookup"><span data-stu-id="fba33-116">Use the [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="fba33-117">Se recomienda encarecidamente usar módulos para empaquetar los cmdlets y los archivos de formato y tipos asociados para la distribución.</span><span class="sxs-lookup"><span data-stu-id="fba33-117">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="fba33-118">Para obtener más información sobre los módulos, consulte [escribir un módulo de Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="fba33-118">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="fba33-119">Si va a invocar comandos mediante programación, puede Agregar una entrada de archivo de formato al estado de sesión inicial del espacio de ejecución en el que se ejecutan los comandos.</span><span class="sxs-lookup"><span data-stu-id="fba33-119">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="fba33-120">Para obtener más información sobre el tipo de .NET que se usa para agregar el archivo de formato, vea [System. Management. Automation. espacios de Sessionstateformatentry? Displayproperty = FullName](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) (clase).</span><span class="sxs-lookup"><span data-stu-id="fba33-120">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="fba33-121">Cuando se carga un archivo de formato, se agrega a una lista interna que Windows PowerShell usa para determinar la vista que se va a usar al mostrar objetos en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="fba33-121">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="fba33-122">Puede anteponer el archivo de formato al principio de la lista, o puede anexarlo al final de la lista.</span><span class="sxs-lookup"><span data-stu-id="fba33-122">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="fba33-123">Saber dónde se agrega el archivo de formato a esta lista es importante si está cargando un archivo de formato que define una vista para un objeto que tiene una vista existente definida, como cuando desea cambiar la forma en que un objeto devuelto por un cmdlet de Windows PowerShell Core es  indica.</span><span class="sxs-lookup"><span data-stu-id="fba33-123">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="fba33-124">Si está cargando un archivo de formato que define la única vista para un objeto, puede usar cualquiera de los métodos descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="fba33-124">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="fba33-125">Si está cargando un archivo de formato que define otra vista para un objeto, debe usar el cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) y anteponer el archivo al principio de la lista.</span><span class="sxs-lookup"><span data-stu-id="fba33-125">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="fba33-126">Almacenar el archivo de formato</span><span class="sxs-lookup"><span data-stu-id="fba33-126">Storing Your Formatting File</span></span>

<span data-ttu-id="fba33-127">No es necesario que los archivos de formato se almacenen en disco.</span><span class="sxs-lookup"><span data-stu-id="fba33-127">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="fba33-128">Sin embargo, se recomienda encarecidamente que los almacene en la siguiente carpeta: `user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="fba33-128">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="fba33-129">Cargar un archivo de formato mediante Import-FormatData</span><span class="sxs-lookup"><span data-stu-id="fba33-129">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="fba33-130">Almacene el archivo de formato en el disco.</span><span class="sxs-lookup"><span data-stu-id="fba33-130">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="fba33-131">Ejecute el cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) con uno de los siguientes comandos.</span><span class="sxs-lookup"><span data-stu-id="fba33-131">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="fba33-132">Para agregar el archivo de formato al principio de la lista, use este comando.</span><span class="sxs-lookup"><span data-stu-id="fba33-132">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="fba33-133">Use este comando si va a cambiar el modo en que se muestra un objeto.</span><span class="sxs-lookup"><span data-stu-id="fba33-133">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="fba33-134">Use este comando para agregar el archivo de formato al final de la lista.</span><span class="sxs-lookup"><span data-stu-id="fba33-134">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="fba33-135">Una vez que se ha agregado un archivo mediante el cmdlet [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) , no se puede quitar el archivo de la lista mientras la sesión está abierta.</span><span class="sxs-lookup"><span data-stu-id="fba33-135">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="fba33-136">Debe cerrar la sesión para quitar el archivo de formato de la lista.</span><span class="sxs-lookup"><span data-stu-id="fba33-136">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="fba33-137">Exportar datos de formato</span><span class="sxs-lookup"><span data-stu-id="fba33-137">Exporting format data</span></span>

<span data-ttu-id="fba33-138">Insertar el cuerpo de la sección aquí.</span><span class="sxs-lookup"><span data-stu-id="fba33-138">Insert section body here.</span></span>
