---
title: Crear un proveedor de elementos de Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- item providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], item provider
ms.assetid: a5a304ce-fc99-4a5b-a779-de7d85e031fe
caps.latest.revision: 6
ms.openlocfilehash: a2d0f2b435b4b56ac491804f3af695641449e17a
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/15/2019
ms.locfileid: "72360504"
---
# <a name="creating-a-windows-powershell-item-provider"></a><span data-ttu-id="40a0a-102">Creación de un proveedor de elementos de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-102">Creating a Windows PowerShell Item Provider</span></span>

<span data-ttu-id="40a0a-103">En este tema se describe cómo crear un proveedor de Windows PowerShell que pueda manipular los datos de un almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-103">This topic describes how to create a Windows PowerShell provider that can manipulate the data in a data store.</span></span> <span data-ttu-id="40a0a-104">En este tema, se hace referencia a los elementos de datos del almacén como "elementos" del almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-104">In this topic, the elements of data in the store are referred to as the "items" of the data store.</span></span> <span data-ttu-id="40a0a-105">Como consecuencia, se hace referencia a un proveedor que puede manipular los datos del almacén como un proveedor de elementos de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="40a0a-105">As a consequence, a provider that can manipulate the data in the store is referred to as a Windows PowerShell item provider.</span></span>

> [!NOTE]
> <span data-ttu-id="40a0a-106">Puede descargar el C# archivo de código fuente (AccessDBSampleProvider03.CS) para este proveedor mediante el kit de desarrollo de software de Microsoft Windows para Windows Vista y los componentes de tiempo de ejecución de .NET Framework 3,0.</span><span class="sxs-lookup"><span data-stu-id="40a0a-106">You can download the C# source file (AccessDBSampleProvider03.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="40a0a-107">Para obtener instrucciones de descarga, consulte [Cómo instalar Windows PowerShell y descargar el SDK de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="40a0a-107">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="40a0a-108">Los archivos de origen descargados están disponibles en el directorio **@no__t ejemplos de 1PowerShell >** .</span><span class="sxs-lookup"><span data-stu-id="40a0a-108">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="40a0a-109">Para obtener más información sobre otras implementaciones del proveedor de Windows PowerShell, vea [diseñar el proveedor de Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="40a0a-109">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="40a0a-110">El proveedor de elementos de Windows PowerShell que se describe en este tema obtiene elementos de datos de una base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="40a0a-110">The Windows PowerShell item provider described in this topic gets items of data from an Access database.</span></span> <span data-ttu-id="40a0a-111">En este caso, un "elemento" es una tabla de la base de datos de Access o una fila de una tabla.</span><span class="sxs-lookup"><span data-stu-id="40a0a-111">In this case, an "item" is either a table in the Access database or a row in a table.</span></span>

## <a name="defining-the-windows-powershell-item-provider-class"></a><span data-ttu-id="40a0a-112">Definir la clase de proveedor de elementos de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-112">Defining the Windows PowerShell Item Provider Class</span></span>

<span data-ttu-id="40a0a-113">Un proveedor de elementos de Windows PowerShell debe definir una clase .NET que derive de la clase base [System. Management. Automation. Provider. Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-113">A Windows PowerShell item provider must define a .NET class that derives from the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="40a0a-114">A continuación se indica la definición de clase para el proveedor de elementos descrito en esta sección.</span><span class="sxs-lookup"><span data-stu-id="40a0a-114">The following is the class definition for the item provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L34-L36 "AccessDBProviderSample03.cs")]

<span data-ttu-id="40a0a-115">Tenga en cuenta que en esta definición de clase, el atributo [System. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) incluye dos parámetros.</span><span class="sxs-lookup"><span data-stu-id="40a0a-115">Note that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="40a0a-116">El primer parámetro especifica un nombre descriptivo para el proveedor que usa Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="40a0a-116">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="40a0a-117">El segundo parámetro especifica las capacidades específicas de Windows PowerShell que el proveedor expone al tiempo de ejecución de Windows PowerShell durante el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-117">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="40a0a-118">Para este proveedor, no hay ninguna funcionalidad específica de Windows PowerShell adicional.</span><span class="sxs-lookup"><span data-stu-id="40a0a-118">For this provider, there are no added Windows PowerShell specific capabilities.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="40a0a-119">Definir la funcionalidad básica</span><span class="sxs-lookup"><span data-stu-id="40a0a-119">Defining Base Functionality</span></span>

<span data-ttu-id="40a0a-120">Como se describe en [diseñar un proveedor de Windows PowerShell](./designing-your-windows-powershell-provider.md), la clase [System. Management. Automation. Provider. Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) se deriva de otras clases que proporcionan una funcionalidad de proveedor diferente.</span><span class="sxs-lookup"><span data-stu-id="40a0a-120">As described in [Design Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="40a0a-121">Por lo tanto, un proveedor de elementos de Windows PowerShell debe definir toda la funcionalidad proporcionada por esas clases.</span><span class="sxs-lookup"><span data-stu-id="40a0a-121">A Windows PowerShell item provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="40a0a-122">Para obtener más información sobre cómo implementar la funcionalidad para agregar información de inicialización específica de la sesión y para liberar los recursos utilizados por el proveedor, consulte [crear un proveedor básico de Windows PowerShell](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="40a0a-122">For more information about how to implement functionality for adding session-specific initialization information and for releasing resources used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="40a0a-123">Sin embargo, la mayoría de los proveedores, incluido el proveedor descrito aquí, pueden usar la implementación predeterminada de esta funcionalidad proporcionada por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="40a0a-123">However, most providers, including the provider described here, can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="40a0a-124">Antes de que el proveedor de elementos de Windows PowerShell pueda manipular los elementos del almacén, debe implementar los métodos de la clase base [System. Management. Automation. Provider. Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) para tener acceso al almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-124">Before the Windows PowerShell item provider can manipulate the items in the store, it must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class to access to the data store.</span></span> <span data-ttu-id="40a0a-125">Para obtener más información sobre la implementación de esta clase, vea [crear un proveedor de unidades de Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="40a0a-125">For more information about implementing this class, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="checking-for-path-validity"></a><span data-ttu-id="40a0a-126">Comprobando la validez de la ruta de acceso</span><span class="sxs-lookup"><span data-stu-id="40a0a-126">Checking for Path Validity</span></span>

<span data-ttu-id="40a0a-127">Al buscar un elemento de datos, el tiempo de ejecución de Windows PowerShell suministra una ruta de acceso de Windows PowerShell al proveedor, tal como se define en la sección "conceptos de PSPath" de [Cómo funciona Windows PowerShell](https://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span><span class="sxs-lookup"><span data-stu-id="40a0a-127">When looking for an item of data, the Windows PowerShell runtime furnishes a Windows PowerShell path to the provider, as defined in the "PSPath Concepts" section of [How Windows PowerShell Works](https://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span></span> <span data-ttu-id="40a0a-128">Un proveedor de elementos de Windows PowerShell debe comprobar la validez sintáctica y semántica de cualquier ruta de acceso que se le haya pasado implementando el método [System. Management. Automation. Provider. Itemcmdletprovider. Isvalidpath \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-128">An Windows PowerShell item provider must verify the syntactic and semantic validity of any path passed to it by implementing the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method.</span></span> <span data-ttu-id="40a0a-129">Este método devuelve `true` si la ruta de acceso es válida y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="40a0a-129">This method returns `true` if the path is valid, and `false` otherwise.</span></span> <span data-ttu-id="40a0a-130">Tenga en cuenta que la implementación de este método no debe comprobar la existencia del elemento en la ruta de acceso, pero solo la ruta de acceso es sintácticamente correcta y semánticamente.</span><span class="sxs-lookup"><span data-stu-id="40a0a-130">Be aware that the implementation of this method should not verify the existence of the item at the path, but only that the path is syntactically and semantically correct.</span></span>

<span data-ttu-id="40a0a-131">Esta es la implementación del método [System. Management. Automation. Provider. Itemcmdletprovider. Isvalidpath \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="40a0a-131">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method for this provider.</span></span> <span data-ttu-id="40a0a-132">Tenga en cuenta que esta implementación llama a un método auxiliar de NormalizePath para convertir todos los separadores de la ruta de acceso en una uniforme.</span><span class="sxs-lookup"><span data-stu-id="40a0a-132">Note that this implementation calls a NormalizePath helper method to convert all separators in the path to a uniform one.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L274-L298 "AccessDBProviderSample03.cs")]

## <a name="determining-if-an-item-exists"></a><span data-ttu-id="40a0a-133">Determinar si existe un elemento</span><span class="sxs-lookup"><span data-stu-id="40a0a-133">Determining if an Item Exists</span></span>

<span data-ttu-id="40a0a-134">Después de comprobar la ruta de acceso, el tiempo de ejecución de Windows PowerShell debe determinar si un elemento de datos existe en esa ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="40a0a-134">After verifying the path, the Windows PowerShell runtime must determine if an item of data exists at that path.</span></span> <span data-ttu-id="40a0a-135">Para admitir este tipo de consulta, el proveedor de elementos de Windows PowerShell implementa el método [System. Management. Automation. Provider. Itemcmdletprovider. Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-135">To support this type of query, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method.</span></span> <span data-ttu-id="40a0a-136">Este método devuelve `true` un elemento se encuentra en la ruta de acceso especificada y `false` (valor predeterminado) en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="40a0a-136">This method returns `true` an item is found at the specified path and `false` (default) otherwise.</span></span>

<span data-ttu-id="40a0a-137">Esta es la implementación del método [System. Management. Automation. Provider. Itemcmdletprovider. Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="40a0a-137">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method for this provider.</span></span> <span data-ttu-id="40a0a-138">Tenga en cuenta que este método llama a los métodos auxiliares PathIsDrive, ChunkPath y GetTable, y usa un objeto DatabaseTableInfo definido por el proveedor.</span><span class="sxs-lookup"><span data-stu-id="40a0a-138">Note that this method calls the PathIsDrive, ChunkPath, and GetTable helper methods, and uses a provider defined DatabaseTableInfo object.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L229-L267 "AccessDBProviderSample03.cs")]

#### <a name="things-to-remember-about-implementing-itemexists"></a><span data-ttu-id="40a0a-139">Aspectos que se deben recordar sobre la implementación de ItemExists</span><span class="sxs-lookup"><span data-stu-id="40a0a-139">Things to Remember About Implementing ItemExists</span></span>

<span data-ttu-id="40a0a-140">Se pueden aplicar las siguientes condiciones a su implementación de [System. Management. Automation. Provider. Itemcmdletprovider. Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span><span class="sxs-lookup"><span data-stu-id="40a0a-140">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span></span>

- <span data-ttu-id="40a0a-141">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell podría declarar las capacidades del proveedor de ExpandWildcards, Filter, include o exclude de la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-141">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="40a0a-142">En estos casos, la implementación del método [System. Management. Automation. Provider. Itemcmdletprovider. Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) debe asegurarse de que la ruta de acceso que se pasa al método cumple los requisitos de las capacidades especificadas.</span><span class="sxs-lookup"><span data-stu-id="40a0a-142">In these cases, the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="40a0a-143">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, las propiedades [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-143">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="40a0a-144">La implementación de este método debe controlar cualquier forma de acceso al elemento que pueda hacer que el elemento sea visible para el usuario.</span><span class="sxs-lookup"><span data-stu-id="40a0a-144">The implementation of this method should handle any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="40a0a-145">Por ejemplo, si un usuario tiene acceso de escritura a un archivo a través del proveedor FileSystem (proporcionado por Windows PowerShell), pero no de acceso de lectura, el archivo sigue existiendo y [System. Management. Automation. Provider. Itemcmdletprovider. Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) devuelve @no__ t-1.</span><span class="sxs-lookup"><span data-stu-id="40a0a-145">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="40a0a-146">La implementación puede requerir la comprobación de un elemento primario para ver si el elemento secundario se puede enumerar.</span><span class="sxs-lookup"><span data-stu-id="40a0a-146">Your implementation might require checking a parent item to see if the child item can be enumerated.</span></span>

## <a name="attaching-dynamic-parameters-to-the-test-path-cmdlet"></a><span data-ttu-id="40a0a-147">Adjuntar parámetros dinámicos al cmdlet Test-path</span><span class="sxs-lookup"><span data-stu-id="40a0a-147">Attaching Dynamic Parameters to the Test-Path Cmdlet</span></span>

<span data-ttu-id="40a0a-148">A veces, el cmdlet `Test-Path` que llama a [System. Management. Automation. Provider. Itemcmdletprovider. Itemexists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) requiere parámetros adicionales que se especifican dinámicamente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="40a0a-148">Sometimes the `Test-Path` cmdlet that calls [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="40a0a-149">Para proporcionar estos parámetros dinámicos, el proveedor de elementos de Windows PowerShell debe implementar el método [System. Management. Automation. Provider. Itemcmdletprovider. Itemexistsdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-149">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexistsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) method.</span></span> <span data-ttu-id="40a0a-150">Este método recupera los parámetros dinámicos para el elemento en la ruta de acceso indicada y devuelve un objeto que tiene propiedades y campos con atributos de análisis similares a una clase de cmdlet o [System. Management. Automation. Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)objeto.</span><span class="sxs-lookup"><span data-stu-id="40a0a-150">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="40a0a-151">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros al cmdlet `Test-Path`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-151">The Windows PowerShell runtime uses the returned object to add the parameters to the `Test-Path` cmdlet.</span></span>

<span data-ttu-id="40a0a-152">Este proveedor de elementos de Windows PowerShell no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-152">This Windows PowerShell item provider does not implement this method.</span></span> <span data-ttu-id="40a0a-153">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-153">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovideritemexistdynamicparameters](Msh_samplestestcmdlets#testprovideritemexistdynamicparameters)]  -->

## <a name="retrieving-an-item"></a><span data-ttu-id="40a0a-154">Recuperar un elemento</span><span class="sxs-lookup"><span data-stu-id="40a0a-154">Retrieving an Item</span></span>

<span data-ttu-id="40a0a-155">Para recuperar un elemento, el proveedor de elementos de Windows PowerShell debe invalidar el método [System. Management. Automation. Provider. Itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) para admitir llamadas del cmdlet `Get-Item`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-155">To retrieve an item, the Windows PowerShell item provider must override [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method to support calls from the `Get-Item` cmdlet.</span></span> <span data-ttu-id="40a0a-156">Este método escribe el elemento mediante el método [System. Management. Automation. Provider. Cmdletprovider. Writeitemobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-156">This method writes the item using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method.</span></span>

<span data-ttu-id="40a0a-157">Esta es la implementación del método [System. Management. Automation. Provider. Itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="40a0a-157">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for this provider.</span></span> <span data-ttu-id="40a0a-158">Tenga en cuenta que este método usa los métodos de aplicación auxiliar GetTable y GetRow para recuperar elementos que son tablas en la base de datos de Access o en filas de una tabla de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-158">Note that this method uses the GetTable and GetRow helper methods to retrieve items that are either tables in the Access database or rows in a data table.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L132-L163 "AccessDBProviderSample03.cs")]

#### <a name="things-to-remember-about-implementing-getitem"></a><span data-ttu-id="40a0a-159">Aspectos que se deben recordar sobre la implementación de GetItem</span><span class="sxs-lookup"><span data-stu-id="40a0a-159">Things to Remember About Implementing GetItem</span></span>

<span data-ttu-id="40a0a-160">Las condiciones siguientes pueden aplicarse a una implementación de [System. Management. Automation. Provider. Itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem):</span><span class="sxs-lookup"><span data-stu-id="40a0a-160">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem):</span></span>

- <span data-ttu-id="40a0a-161">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell podría declarar las capacidades del proveedor de ExpandWildcards, Filter, include o exclude de la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-161">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="40a0a-162">En estos casos, la implementación de [System. Management. Automation. Provider. Itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-162">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="40a0a-163">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, las propiedades [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-163">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="40a0a-164">De forma predeterminada, las invalidaciones de este método no deben recuperar objetos que normalmente están ocultos del usuario a menos que la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esté establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-164">By default, overrides of this method should not retrieve objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="40a0a-165">Por ejemplo, el método [System. Management. Automation. Provider. Itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) para el proveedor filesystem comprueba la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) antes de intentar llamar a. [System. Management. Automation. Provider. Cmdletprovider. Writeitemobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) para los archivos ocultos o del sistema.</span><span class="sxs-lookup"><span data-stu-id="40a0a-165">For example, the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the FileSystem provider checks the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property before it attempts to call [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) for hidden or system files.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-item-cmdlet"></a><span data-ttu-id="40a0a-166">Adjuntar parámetros dinámicos al cmdlet Get-Item</span><span class="sxs-lookup"><span data-stu-id="40a0a-166">Attaching Dynamic Parameters to the Get-Item Cmdlet</span></span>

<span data-ttu-id="40a0a-167">A veces, el cmdlet `Get-Item` requiere parámetros adicionales que se especifican dinámicamente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="40a0a-167">Sometimes the `Get-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="40a0a-168">Para proporcionar estos parámetros dinámicos, el proveedor de elementos de Windows PowerShell debe implementar el método [System. Management. Automation. Provider. Itemcmdletprovider. Getitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-168">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Getitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) method.</span></span> <span data-ttu-id="40a0a-169">Este método recupera los parámetros dinámicos para el elemento en la ruta de acceso indicada y devuelve un objeto que tiene propiedades y campos con atributos de análisis similares a una clase de cmdlet o [System. Management. Automation. Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)objeto.</span><span class="sxs-lookup"><span data-stu-id="40a0a-169">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="40a0a-170">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros al cmdlet `Get-Item`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-170">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-Item` cmdlet.</span></span>

<span data-ttu-id="40a0a-171">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-171">This provider does not implement this method.</span></span> <span data-ttu-id="40a0a-172">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-172">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetitemdynamicparameters](Msh_samplestestcmdlets#testprovidergetitemdynamicparameters)]  -->

## <a name="setting-an-item"></a><span data-ttu-id="40a0a-173">Establecer un elemento</span><span class="sxs-lookup"><span data-stu-id="40a0a-173">Setting an Item</span></span>

<span data-ttu-id="40a0a-174">Para establecer un elemento, el proveedor de elementos de Windows PowerShell debe invalidar el método [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) para admitir llamadas del cmdlet `Set-Item`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-174">To set an item, the Windows PowerShell item provider must override the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method to support calls from the `Set-Item` cmdlet.</span></span> <span data-ttu-id="40a0a-175">Este método establece el valor del elemento en la ruta de acceso especificada.</span><span class="sxs-lookup"><span data-stu-id="40a0a-175">This method sets the value of the item at the specified path.</span></span>

<span data-ttu-id="40a0a-176">Este proveedor no proporciona una invalidación para el método [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-176">This provider does not provide an override for the  [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method.</span></span> <span data-ttu-id="40a0a-177">Sin embargo, la siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-177">However, the following is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitem](Msh_samplestestcmdlets#testprovidersetitem)]  -->

#### <a name="things-to-remember-about-implementing-setitem"></a><span data-ttu-id="40a0a-178">Aspectos que se deben recordar sobre la implementación de SetItem</span><span class="sxs-lookup"><span data-stu-id="40a0a-178">Things to Remember About Implementing SetItem</span></span>

<span data-ttu-id="40a0a-179">Se pueden aplicar las siguientes condiciones a su implementación de [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem):</span><span class="sxs-lookup"><span data-stu-id="40a0a-179">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem):</span></span>

- <span data-ttu-id="40a0a-180">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell podría declarar las capacidades del proveedor de ExpandWildcards, Filter, include o exclude de la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-180">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="40a0a-181">En estos casos, la implementación de [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-181">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="40a0a-182">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, las propiedades [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-182">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="40a0a-183">De forma predeterminada, las invalidaciones de este método no deben establecer ni escribir objetos que estén ocultos para el usuario a menos que la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esté establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-183">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="40a0a-184">Se debe enviar un error al método [System. Management. Automation. Provider. Cmdletprovider. WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) si la ruta de acceso representa un elemento oculto y [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) está establecido en `false`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-184">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents a hidden item and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="40a0a-185">La implementación del método [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe llamar a [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de efectuar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-185">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="40a0a-186">Este método se utiliza para confirmar la ejecución de una operación cuando se realiza un cambio en el almacén de datos, por ejemplo, la eliminación de archivos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-186">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="40a0a-187">El método [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envía el nombre del recurso que se va a cambiar al usuario, con el tiempo de ejecución de Windows PowerShell teniendo en cuenta cualquier configuración de línea de comandos o variables de preferencia en determinar lo que se debe mostrar.</span><span class="sxs-lookup"><span data-stu-id="40a0a-187">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="40a0a-188">Después de que la llamada a [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelva `true`, el método [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe llamar a la [ Método System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-188">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="40a0a-189">Este método envía un mensaje al usuario para permitir que los comentarios comprueben si la operación debe continuar.</span><span class="sxs-lookup"><span data-stu-id="40a0a-189">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="40a0a-190">La llamada a [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permite realizar una comprobación adicional de las modificaciones del sistema potencialmente peligrosas.</span><span class="sxs-lookup"><span data-stu-id="40a0a-190">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieving-dynamic-parameters-for-setitem"></a><span data-ttu-id="40a0a-191">Recuperando parámetros dinámicos para SetItem</span><span class="sxs-lookup"><span data-stu-id="40a0a-191">Retrieving Dynamic Parameters for SetItem</span></span>

<span data-ttu-id="40a0a-192">A veces, el cmdlet `Set-Item` requiere parámetros adicionales que se especifican dinámicamente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="40a0a-192">Sometimes the `Set-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="40a0a-193">Para proporcionar estos parámetros dinámicos, el proveedor de elementos de Windows PowerShell debe implementar el método [System. Management. Automation. Provider. Itemcmdletprovider. Setitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-193">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Setitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) method.</span></span> <span data-ttu-id="40a0a-194">Este método recupera los parámetros dinámicos para el elemento en la ruta de acceso indicada y devuelve un objeto que tiene propiedades y campos con atributos de análisis similares a una clase de cmdlet o [System. Management. Automation. Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)objeto.</span><span class="sxs-lookup"><span data-stu-id="40a0a-194">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="40a0a-195">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros al cmdlet `Set-Item`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-195">The Windows PowerShell runtime uses the returned object to add the parameters to the `Set-Item` cmdlet.</span></span>

<span data-ttu-id="40a0a-196">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-196">This provider does not implement this method.</span></span> <span data-ttu-id="40a0a-197">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-197">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitemdynamicparameters](Msh_samplestestcmdlets#testprovidersetitemdynamicparameters)]  -->

## <a name="clearing-an-item"></a><span data-ttu-id="40a0a-198">Borrar un elemento</span><span class="sxs-lookup"><span data-stu-id="40a0a-198">Clearing an Item</span></span>

<span data-ttu-id="40a0a-199">Para borrar un elemento, el proveedor de elementos de Windows PowerShell implementa el método [System. Management. Automation. Provider. Itemcmdletprovider. Clearitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) para admitir llamadas del cmdlet `Clear-Item`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-199">To clear an item, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) method to support calls from the `Clear-Item` cmdlet.</span></span> <span data-ttu-id="40a0a-200">Este método borra el elemento de datos en la ruta de acceso especificada.</span><span class="sxs-lookup"><span data-stu-id="40a0a-200">This method erases the data item at the specified path.</span></span>

<span data-ttu-id="40a0a-201">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-201">This provider does not implement this method.</span></span> <span data-ttu-id="40a0a-202">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-202">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitem](Msh_samplestestcmdlets#testproviderclearitem)]  -->

#### <a name="things-to-remember-about-implementing-clearitem"></a><span data-ttu-id="40a0a-203">Aspectos que se deben recordar sobre la implementación de ClearItem</span><span class="sxs-lookup"><span data-stu-id="40a0a-203">Things to Remember About Implementing ClearItem</span></span>

<span data-ttu-id="40a0a-204">Las condiciones siguientes pueden aplicarse a una implementación de [System. Management. Automation. Provider. Itemcmdletprovider. Clearitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span><span class="sxs-lookup"><span data-stu-id="40a0a-204">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span></span>

- <span data-ttu-id="40a0a-205">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell podría declarar las capacidades del proveedor de ExpandWildcards, Filter, include o exclude de la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-205">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="40a0a-206">En estos casos, la implementación de [System. Management. Automation. Provider. Itemcmdletprovider. Clearitem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-206">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="40a0a-207">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, las propiedades [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-207">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="40a0a-208">De forma predeterminada, las invalidaciones de este método no deben establecer ni escribir objetos que estén ocultos para el usuario a menos que la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esté establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-208">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="40a0a-209">Se debe enviar un error al método [System. Management. Automation. Provider. Cmdletprovider. WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) si la ruta de acceso representa un elemento que está oculto para el usuario y [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) establézcalo en `false`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-209">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="40a0a-210">La implementación del método [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe llamar a [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de efectuar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-210">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="40a0a-211">Este método se utiliza para confirmar la ejecución de una operación cuando se realiza un cambio en el almacén de datos, por ejemplo, la eliminación de archivos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-211">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="40a0a-212">El método [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envía el nombre del recurso que se va a cambiar al usuario, con el tiempo de ejecución de Windows PowerShell y controla cualquier configuración de línea de comandos o variables de preferencia en determinar lo que se debe mostrar.</span><span class="sxs-lookup"><span data-stu-id="40a0a-212">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handle any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="40a0a-213">Después de que la llamada a [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelva `true`, el método [System. Management. Automation. Provider. Itemcmdletprovider. SetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe llamar a la [ Método System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-213">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="40a0a-214">Este método envía un mensaje al usuario para permitir que los comentarios comprueben si la operación debe continuar.</span><span class="sxs-lookup"><span data-stu-id="40a0a-214">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="40a0a-215">La llamada a [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permite realizar una comprobación adicional de las modificaciones del sistema potencialmente peligrosas.</span><span class="sxs-lookup"><span data-stu-id="40a0a-215">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieve-dynamic-parameters-for-clearitem"></a><span data-ttu-id="40a0a-216">Recuperación de parámetros dinámicos para ClearItem</span><span class="sxs-lookup"><span data-stu-id="40a0a-216">Retrieve Dynamic Parameters for ClearItem</span></span>

<span data-ttu-id="40a0a-217">A veces, el cmdlet `Clear-Item` requiere parámetros adicionales que se especifican dinámicamente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="40a0a-217">Sometimes the `Clear-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="40a0a-218">Para proporcionar estos parámetros dinámicos, el proveedor de elementos de Windows PowerShell debe implementar el método [System. Management. Automation. Provider. Itemcmdletprovider. Clearitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-218">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) method.</span></span> <span data-ttu-id="40a0a-219">Este método recupera los parámetros dinámicos para el elemento en la ruta de acceso indicada y devuelve un objeto que tiene propiedades y campos con atributos de análisis similares a una clase de cmdlet o [System. Management. Automation. Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)objeto.</span><span class="sxs-lookup"><span data-stu-id="40a0a-219">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="40a0a-220">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros al cmdlet `Clear-Item`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-220">The Windows PowerShell runtime uses the returned object to add the parameters to the `Clear-Item` cmdlet.</span></span>

<span data-ttu-id="40a0a-221">Este proveedor de elementos no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-221">This item provider does not implement this method.</span></span> <span data-ttu-id="40a0a-222">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-222">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitemdynamicparameters](Msh_samplestestcmdlets#testproviderclearitemdynamicparameters)]  -->

## <a name="performing-a-default-action-for-an-item"></a><span data-ttu-id="40a0a-223">Realizar una acción predeterminada para un elemento</span><span class="sxs-lookup"><span data-stu-id="40a0a-223">Performing a Default Action for an Item</span></span>

<span data-ttu-id="40a0a-224">Un proveedor de elementos de Windows PowerShell puede implementar el método [System. Management. Automation. Provider. Itemcmdletprovider. Invokedefaultaction \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) para admitir llamadas del cmdlet `Invoke-Item`, lo que permite al proveedor realizar una acción predeterminada para el cmdlet elemento en la ruta de acceso especificada.</span><span class="sxs-lookup"><span data-stu-id="40a0a-224">A Windows PowerShell item provider can implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) method to support calls from the `Invoke-Item` cmdlet, which allows the provider to perform a default action for the item at the specified path.</span></span> <span data-ttu-id="40a0a-225">Por ejemplo, el proveedor FileSystem podría usar este método para llamar a ShellExecute para un elemento específico.</span><span class="sxs-lookup"><span data-stu-id="40a0a-225">For example, the FileSystem provider might use this method to call ShellExecute for a specific item.</span></span>

<span data-ttu-id="40a0a-226">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-226">This provider does not implement this method.</span></span> <span data-ttu-id="40a0a-227">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-227">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultaction](Msh_samplestestcmdlets#testproviderinvokedefaultaction)]  -->

#### <a name="things-to-remember-about-implementing-invokedefaultaction"></a><span data-ttu-id="40a0a-228">Aspectos que se deben recordar sobre la implementación de InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="40a0a-228">Things to Remember About Implementing InvokeDefaultAction</span></span>

<span data-ttu-id="40a0a-229">Las condiciones siguientes pueden aplicarse a una implementación de [System. Management. Automation. Provider. Itemcmdletprovider. Invokedefaultaction \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction):</span><span class="sxs-lookup"><span data-stu-id="40a0a-229">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction):</span></span>

- <span data-ttu-id="40a0a-230">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell podría declarar las capacidades del proveedor de ExpandWildcards, Filter, include o exclude de la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-230">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="40a0a-231">En estos casos, la implementación de [System. Management. Automation. Provider. Itemcmdletprovider. Invokedefaultaction \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-231">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="40a0a-232">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, las propiedades [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-232">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="40a0a-233">De forma predeterminada, las invalidaciones de este método no deben establecer ni escribir objetos ocultos del usuario a menos que la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esté establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-233">By default, overrides of this method should not set or write objects hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="40a0a-234">Se debe enviar un error al método [System. Management. Automation. Provider. Cmdletprovider. WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) si la ruta de acceso representa un elemento que está oculto para el usuario y [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) establézcalo en `false`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-234">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="retrieve-dynamic-parameters-for-invokedefaultaction"></a><span data-ttu-id="40a0a-235">Recuperación de parámetros dinámicos para InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="40a0a-235">Retrieve Dynamic Parameters for InvokeDefaultAction</span></span>

<span data-ttu-id="40a0a-236">A veces, el cmdlet `Invoke-Item` requiere parámetros adicionales que se especifican dinámicamente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="40a0a-236">Sometimes the `Invoke-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="40a0a-237">Para proporcionar estos parámetros dinámicos, el proveedor de elementos de Windows PowerShell debe implementar el método [System. Management. Automation. Provider. Itemcmdletprovider. Invokedefaultactiondynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-237">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultactiondynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) method.</span></span> <span data-ttu-id="40a0a-238">Este método recupera los parámetros dinámicos para el elemento en la ruta de acceso indicada y devuelve un objeto que tiene propiedades y campos con atributos de análisis similares a una clase de cmdlet o [System. Management. Automation. Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary)objeto.</span><span class="sxs-lookup"><span data-stu-id="40a0a-238">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="40a0a-239">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros dinámicos al cmdlet `Invoke-Item`.</span><span class="sxs-lookup"><span data-stu-id="40a0a-239">The Windows PowerShell runtime uses the returned object to add the dynamic parameters to the `Invoke-Item` cmdlet.</span></span>

<span data-ttu-id="40a0a-240">Este proveedor de elementos no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-240">This item provider does not implement this method.</span></span> <span data-ttu-id="40a0a-241">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="40a0a-241">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters](Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters)]  -->

## <a name="implementing-helper-methods-and-classes"></a><span data-ttu-id="40a0a-242">Implementar métodos y clases auxiliares</span><span class="sxs-lookup"><span data-stu-id="40a0a-242">Implementing Helper Methods and Classes</span></span>

<span data-ttu-id="40a0a-243">Este proveedor de elementos implementa varios métodos y clases auxiliares que usan los métodos de invalidación públicos definidos por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="40a0a-243">This item provider implements several helper methods and classes that are used by the public override methods defined by Windows PowerShell.</span></span> <span data-ttu-id="40a0a-244">El código de estos métodos auxiliares y clases se muestra en la sección [código de ejemplo](#code-sample) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-244">The code for these helper methods and classes are shown in the [Code Sample](#code-sample) section.</span></span>

### <a name="normalizepath-method"></a><span data-ttu-id="40a0a-245">Método NormalizePath</span><span class="sxs-lookup"><span data-stu-id="40a0a-245">NormalizePath Method</span></span>

<span data-ttu-id="40a0a-246">Este proveedor de elementos implementa un método auxiliar de NormalizePath para asegurarse de que la ruta de acceso tiene un formato coherente.</span><span class="sxs-lookup"><span data-stu-id="40a0a-246">This item provider implements a NormalizePath helper method to ensure that the path has a consistent format.</span></span> <span data-ttu-id="40a0a-247">El formato especificado usa una barra diagonal inversa (\\) como separador.</span><span class="sxs-lookup"><span data-stu-id="40a0a-247">The format specified uses a backslash (\\) as a separator.</span></span>

### <a name="pathisdrive-method"></a><span data-ttu-id="40a0a-248">Método PathIsDrive</span><span class="sxs-lookup"><span data-stu-id="40a0a-248">PathIsDrive Method</span></span>

<span data-ttu-id="40a0a-249">Este proveedor de elementos implementa un método auxiliar de PathIsDrive para determinar si la ruta de acceso especificada es realmente el nombre de la unidad.</span><span class="sxs-lookup"><span data-stu-id="40a0a-249">This item provider implements a PathIsDrive helper method to determine if the specified path is actually the drive name.</span></span>

### <a name="chunkpath-method"></a><span data-ttu-id="40a0a-250">Método ChunkPath</span><span class="sxs-lookup"><span data-stu-id="40a0a-250">ChunkPath Method</span></span>

<span data-ttu-id="40a0a-251">Este proveedor de elementos implementa un método auxiliar ChunkPath que divide la ruta de acceso especificada para que el proveedor pueda identificar sus elementos individuales.</span><span class="sxs-lookup"><span data-stu-id="40a0a-251">This item provider implements a ChunkPath helper method that breaks up the specified path so that the provider can identify its individual elements.</span></span> <span data-ttu-id="40a0a-252">Devuelve una matriz formada por los elementos de la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="40a0a-252">It returns an array composed of the path elements.</span></span>

### <a name="gettable-method"></a><span data-ttu-id="40a0a-253">GetTable (método)</span><span class="sxs-lookup"><span data-stu-id="40a0a-253">GetTable Method</span></span>

<span data-ttu-id="40a0a-254">Este proveedor de elementos implementa el método auxiliar GetTables que devuelve un objeto DatabaseTableInfo que representa información sobre la tabla especificada en la llamada.</span><span class="sxs-lookup"><span data-stu-id="40a0a-254">This item provider implements the GetTables helper method that returns a DatabaseTableInfo object that represents information about the table specified in the call.</span></span>

### <a name="getrow-method"></a><span data-ttu-id="40a0a-255">Método GetRow</span><span class="sxs-lookup"><span data-stu-id="40a0a-255">GetRow Method</span></span>

<span data-ttu-id="40a0a-256">El método [System. Management. Automation. Provider. Itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) de este proveedor de elementos llama al método auxiliar de GetRows.</span><span class="sxs-lookup"><span data-stu-id="40a0a-256">The [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method of this item provider calls the GetRows helper method.</span></span> <span data-ttu-id="40a0a-257">Este método auxiliar recupera un objeto DatabaseRowInfo que representa información sobre la fila especificada en la tabla.</span><span class="sxs-lookup"><span data-stu-id="40a0a-257">This helper method retrieves a DatabaseRowInfo object that represents information about the specified row in the table.</span></span>

### <a name="databasetableinfo-class"></a><span data-ttu-id="40a0a-258">Clase DatabaseTableInfo</span><span class="sxs-lookup"><span data-stu-id="40a0a-258">DatabaseTableInfo Class</span></span>

<span data-ttu-id="40a0a-259">Este proveedor de elementos define una clase DatabaseTableInfo que representa una colección de información de una tabla de datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-259">This item provider defines a DatabaseTableInfo class that represents a collection of information in a data table in the database.</span></span> <span data-ttu-id="40a0a-260">Esta clase es similar a la clase [System. IO. DirectoryInfo](/dotnet/api/System.IO.DirectoryInfo) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-260">This class is similar to the [System.IO.Directoryinfo](/dotnet/api/System.IO.DirectoryInfo) class.</span></span>

<span data-ttu-id="40a0a-261">El proveedor del elemento de ejemplo define un método DatabaseTableInfo. GetTables que devuelve una colección de objetos de información de tabla que definen las tablas de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-261">The sample item provider defines a DatabaseTableInfo.GetTables method that returns a collection of table information objects defining the tables in the database.</span></span> <span data-ttu-id="40a0a-262">Este método incluye un bloque try/catch para asegurarse de que cualquier error de base de datos se muestra como una fila con cero entradas.</span><span class="sxs-lookup"><span data-stu-id="40a0a-262">This method includes a try/catch block to ensure that any database error shows up as a row with zero entries.</span></span>

### <a name="databaserowinfo-class"></a><span data-ttu-id="40a0a-263">Clase DatabaseRowInfo</span><span class="sxs-lookup"><span data-stu-id="40a0a-263">DatabaseRowInfo Class</span></span>

<span data-ttu-id="40a0a-264">Este proveedor de elementos define la clase auxiliar DatabaseRowInfo que representa una fila de una tabla de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-264">This item provider defines the DatabaseRowInfo helper class that represents a row in a table of the database.</span></span> <span data-ttu-id="40a0a-265">Esta clase es similar a la clase [System. IO. FileInfo](/dotnet/api/System.IO.FileInfo) .</span><span class="sxs-lookup"><span data-stu-id="40a0a-265">This class is similar to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) class.</span></span>

<span data-ttu-id="40a0a-266">El proveedor de ejemplo define un método DatabaseRowInfo. GetRows para devolver una colección de objetos de información de fila para la tabla especificada.</span><span class="sxs-lookup"><span data-stu-id="40a0a-266">The sample provider defines a DatabaseRowInfo.GetRows method to return a collection of row information objects for the specified table.</span></span> <span data-ttu-id="40a0a-267">Este método incluye un bloque try/catch para detectar excepciones.</span><span class="sxs-lookup"><span data-stu-id="40a0a-267">This method includes a try/catch block to trap exceptions.</span></span> <span data-ttu-id="40a0a-268">Los errores no producirán ninguna información de fila.</span><span class="sxs-lookup"><span data-stu-id="40a0a-268">Any errors will result in no row information.</span></span>

## <a name="code-sample"></a><span data-ttu-id="40a0a-269">Código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="40a0a-269">Code Sample</span></span>

<span data-ttu-id="40a0a-270">Para obtener el código de ejemplo completo, vea el [ejemplo de código AccessDbProviderSample03](./accessdbprovidersample03-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="40a0a-270">For complete sample code, see [AccessDbProviderSample03 Code Sample](./accessdbprovidersample03-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="40a0a-271">Definir tipos de objeto y formato</span><span class="sxs-lookup"><span data-stu-id="40a0a-271">Defining Object Types and Formatting</span></span>

<span data-ttu-id="40a0a-272">Al escribir un proveedor, puede ser necesario agregar miembros a los objetos existentes o definir nuevos objetos.</span><span class="sxs-lookup"><span data-stu-id="40a0a-272">When writing a provider, it may be necessary to add members to existing objects or define new objects.</span></span> <span data-ttu-id="40a0a-273">Cuando termine, cree un archivo de tipos que Windows PowerShell pueda usar para identificar a los miembros del objeto y un archivo de formato que define cómo se muestra el objeto.</span><span class="sxs-lookup"><span data-stu-id="40a0a-273">When finished, create a Types file that Windows PowerShell can use to identify the members of the object and a Format file that defines how the object is displayed.</span></span> <span data-ttu-id="40a0a-274">Para obtener más información acerca de, vea [extender tipos de objeto y formato](https://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="40a0a-274">For more information about , see [Extending Object Types and Formatting](https://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="40a0a-275">Compilar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-275">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="40a0a-276">Vea [Cómo registrar cmdlets, proveedores y aplicaciones host](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="40a0a-276">See [How to Register Cmdlets, Providers, and Host Applications](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="40a0a-277">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-277">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="40a0a-278">Cuando este proveedor de elementos de Windows PowerShell se registra con Windows PowerShell, solo puede probar la funcionalidad básica y de unidad del proveedor.</span><span class="sxs-lookup"><span data-stu-id="40a0a-278">When this Windows PowerShell item provider is registered with Windows PowerShell, you can only test the basic and drive functionality of the provider.</span></span> <span data-ttu-id="40a0a-279">Para probar la manipulación de los elementos, también debe implementar la funcionalidad de contenedor descrita en [implementación de un proveedor de Windows PowerShell de contenedor](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="40a0a-279">To test the manipulation of items, you must also implement container functionality described in [Implementing a Container Windows PowerShell Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="40a0a-280">Véase también</span><span class="sxs-lookup"><span data-stu-id="40a0a-280">See Also</span></span>

[<span data-ttu-id="40a0a-281">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="40a0a-281">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="40a0a-282">Guía del programador de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-282">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="40a0a-283">Crear proveedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-283">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="40a0a-284">Diseño del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-284">Designing Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="40a0a-285">Extender tipos de objeto y formato</span><span class="sxs-lookup"><span data-stu-id="40a0a-285">Extending Object Types and Formatting</span></span>](https://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="40a0a-286">Cómo funciona Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-286">How Windows PowerShell Works</span></span>](https://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="40a0a-287">Creación de un contenedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="40a0a-287">Creating a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="40a0a-288">Crear un proveedor de Windows PowerShell para la unidad</span><span class="sxs-lookup"><span data-stu-id="40a0a-288">Creating a Drive Windows PowerShell provider</span></span>](./creating-a-windows-powershell-drive-provider.md)

[<span data-ttu-id="40a0a-289">Cómo registrar cmdlets, proveedores y aplicaciones host</span><span class="sxs-lookup"><span data-stu-id="40a0a-289">How to Register Cmdlets, Providers, and Host Applications</span></span>](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)
