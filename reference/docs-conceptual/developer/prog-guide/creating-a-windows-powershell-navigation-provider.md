---
title: Crear un proveedor de navegación de Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- navigation providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], navigation provider
ms.assetid: 8bd3224d-ca6f-4640-9464-cb4d9f4e13b1
caps.latest.revision: 5
ms.openlocfilehash: f73e732ca9416b906b3647c5090dfa04ad940484
ms.sourcegitcommit: d43f66071f1f33b350d34fa1f46f3a35910c5d24
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/23/2019
ms.locfileid: "74416195"
---
# <a name="creating-a-windows-powershell-navigation-provider"></a><span data-ttu-id="490cf-102">Creación de un proveedor de navegación de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-102">Creating a Windows PowerShell Navigation Provider</span></span>

<span data-ttu-id="490cf-103">En este tema se describe cómo crear un proveedor de navegación de Windows PowerShell que pueda navegar por el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="490cf-103">This topic describes how to create a Windows PowerShell navigation provider that can navigate the data store.</span></span> <span data-ttu-id="490cf-104">Este tipo de proveedor admite comandos recursivos, contenedores anidados y rutas de acceso relativas.</span><span class="sxs-lookup"><span data-stu-id="490cf-104">This type of provider supports recursive commands, nested containers, and relative paths.</span></span>

> [!NOTE]
> <span data-ttu-id="490cf-105">Puede descargar el C# archivo de código fuente (AccessDBSampleProvider05.CS) para este proveedor mediante el kit de desarrollo de software de Microsoft Windows para Windows Vista y los componentes de tiempo de ejecución de .NET Framework 3,0.</span><span class="sxs-lookup"><span data-stu-id="490cf-105">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="490cf-106">Para obtener instrucciones de descarga, consulte [Cómo instalar Windows PowerShell y descargar el SDK de Windows PowerShell](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="490cf-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="490cf-107">Los archivos de código fuente descargados están disponibles en el directorio **\<ejemplos de PowerShell >** .</span><span class="sxs-lookup"><span data-stu-id="490cf-107">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="490cf-108">Para obtener más información sobre otras implementaciones del proveedor de Windows PowerShell, vea [diseñar el proveedor de Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="490cf-108">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="490cf-109">El proveedor descrito aquí permite que el usuario controle una base de datos de Access como una unidad para que el usuario pueda navegar a las tablas de datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="490cf-109">The provider described here enables the user handle an Access database as a drive so that the user can navigate to the data tables in the database.</span></span> <span data-ttu-id="490cf-110">Al crear su propio proveedor de navegación, puede implementar métodos que pueden hacer que las rutas de acceso calificadas por unidad sean necesarias para la navegación, normalizar las rutas de acceso relativas, desplazar elementos del almacén de datos, así como métodos que obtienen nombres secundarios, obtienen la ruta de acceso primaria de un elemento y prueban para identificar si un elemento es un contenedor.</span><span class="sxs-lookup"><span data-stu-id="490cf-110">When creating your own navigation provider, you can implement methods that can make drive-qualified paths required for navigation, normalize relative paths, move items of the data store, as well as methods that get child names, get the parent path of an item, and test to identify if an item is a container.</span></span>

> [!CAUTION]
> <span data-ttu-id="490cf-111">Tenga en cuenta que este diseño supone que hay una base de datos que tiene un campo con el identificador de nombre y que el tipo del campo es LongInteger.</span><span class="sxs-lookup"><span data-stu-id="490cf-111">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="define-the-windows-powershell-provider"></a><span data-ttu-id="490cf-112">Definir el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-112">Define the Windows PowerShell provider</span></span>

<span data-ttu-id="490cf-113">Un proveedor de navegación de Windows PowerShell debe crear una clase .NET que derive de la clase base [System. Management. Automation. Provider. Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="490cf-113">A Windows PowerShell navigation provider must create a .NET class that derives from the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="490cf-114">Esta es la definición de clase del proveedor de navegación que se describe en esta sección.</span><span class="sxs-lookup"><span data-stu-id="490cf-114">Here is the class definition for the navigation provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L31-L32 "AccessDBProviderSample05.cs")]

<span data-ttu-id="490cf-115">Tenga en cuenta que en este proveedor, el atributo [System. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) incluye dos parámetros.</span><span class="sxs-lookup"><span data-stu-id="490cf-115">Note that in this provider, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="490cf-116">El primer parámetro especifica un nombre descriptivo para el proveedor que usa Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="490cf-116">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="490cf-117">El segundo parámetro especifica las capacidades específicas de Windows PowerShell que el proveedor expone al tiempo de ejecución de Windows PowerShell durante el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="490cf-117">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="490cf-118">Para este proveedor, no hay ninguna funcionalidad específica de Windows PowerShell que se agregue.</span><span class="sxs-lookup"><span data-stu-id="490cf-118">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="490cf-119">Definir la funcionalidad básica</span><span class="sxs-lookup"><span data-stu-id="490cf-119">Defining Base Functionality</span></span>

<span data-ttu-id="490cf-120">Tal y como se describe en [diseñar su proveedor de PS](./designing-your-windows-powershell-provider.md), la clase base [System. Management. Automation. Provider. Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) deriva de otras clases que proporcionan una funcionalidad de proveedor diferente.</span><span class="sxs-lookup"><span data-stu-id="490cf-120">As described in [Design Your PS Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="490cf-121">Por lo tanto, un proveedor de navegación de Windows PowerShell debe definir toda la funcionalidad proporcionada por esas clases.</span><span class="sxs-lookup"><span data-stu-id="490cf-121">A Windows PowerShell navigation provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="490cf-122">Para implementar la funcionalidad para agregar información de inicialización específica de la sesión y para liberar recursos utilizados por el proveedor, consulte [crear un proveedor de PS básico](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="490cf-122">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic PS Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="490cf-123">Sin embargo, la mayoría de los proveedores (incluido el proveedor descrito aquí) pueden usar la implementación predeterminada de esta funcionalidad proporcionada por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="490cf-123">However, most providers (including the provider described here) can use the default implementation of this functionality provided by Windows PowerShell.</span></span>

<span data-ttu-id="490cf-124">Para obtener acceso al almacén de datos a través de una unidad de Windows PowerShell, debe implementar los métodos de la clase base [System. Management. Automation. Provider. Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="490cf-124">To get access to the data store through a Windows PowerShell drive, you must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="490cf-125">Para obtener más información sobre la implementación de estos métodos, vea [crear un proveedor de unidades de Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="490cf-125">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="490cf-126">Para manipular los elementos de un almacén de datos, como obtener, establecer y borrar elementos, el proveedor debe implementar los métodos proporcionados por la clase base [System. Management. Automation. Provider. Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="490cf-126">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="490cf-127">Para obtener más información sobre la implementación de estos métodos, vea [crear un proveedor de elementos de Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="490cf-127">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="490cf-128">Para llegar a los elementos secundarios, o sus nombres, del almacén de datos, así como a los métodos que crean, copian, cambia el nombre y quitan elementos, debe implementar los métodos proporcionados por la clase base [System. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="490cf-128">To get to the child items, or their names, of the data store, as well as methods that create, copy, rename, and remove items, you must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="490cf-129">Para obtener más información sobre la implementación de estos métodos, vea [crear un proveedor de contenedores de Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="490cf-129">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="creating-a-windows-powershell-path"></a><span data-ttu-id="490cf-130">Crear una ruta de acceso de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-130">Creating a Windows PowerShell Path</span></span>

<span data-ttu-id="490cf-131">El proveedor de navegación de Windows PowerShell usa una ruta de acceso de Windows PowerShell interna del proveedor para navegar por los elementos del almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="490cf-131">Windows PowerShell navigation provider use a provider-internal Windows PowerShell path to navigate the items of the data store.</span></span> <span data-ttu-id="490cf-132">Para crear una ruta de acceso interna del proveedor, el proveedor debe implementar el método [System. Management. Automation. Provider. Navigationcmdletprovider. Makepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) para admitir llamadas del cmdlet combine-path.</span><span class="sxs-lookup"><span data-stu-id="490cf-132">To create a provider-internal path the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method to supports calls from the Combine-Path cmdlet.</span></span> <span data-ttu-id="490cf-133">Este método combina una ruta de acceso primaria y secundaria en una ruta de acceso interna del proveedor mediante un separador de ruta de acceso específico del proveedor entre las rutas de acceso primarias y secundarias.</span><span class="sxs-lookup"><span data-stu-id="490cf-133">This method combines a parent and child path into a provider-internal path, using a provider-specific path separator between the parent and child paths.</span></span>

<span data-ttu-id="490cf-134">La implementación predeterminada toma rutas de acceso con "/" o "\\" como separador de ruta de acceso, normaliza el separador de la ruta de acceso a "\\", combina las partes de la ruta de acceso primaria y secundaria con el separador entre ellas y, a continuación, devuelve una cadena que contiene las rutas de acceso combinadas.</span><span class="sxs-lookup"><span data-stu-id="490cf-134">The default implementation takes paths with "/" or "\\" as the path separator, normalizes the path separator to "\\", combines the parent and child path parts with the separator between them, and then returns a string that contains the combined paths.</span></span>

<span data-ttu-id="490cf-135">Este proveedor de navegación no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="490cf-135">This navigation provider does not implement this method.</span></span> <span data-ttu-id="490cf-136">Sin embargo, el código siguiente es la implementación predeterminada del método [System. Management. Automation. Provider. Navigationcmdletprovider. Makepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) .</span><span class="sxs-lookup"><span data-stu-id="490cf-136">However, the following code is the default implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermakepath](Msh_samplestestcmdlets#testprovidermakepath)]  -->

#### <a name="things-to-remember-about-implementing-makepath"></a><span data-ttu-id="490cf-137">Aspectos que se deben recordar sobre la implementación de MakePath</span><span class="sxs-lookup"><span data-stu-id="490cf-137">Things to Remember About Implementing MakePath</span></span>

<span data-ttu-id="490cf-138">Se pueden aplicar las siguientes condiciones a su implementación de [System. Management. Automation. Provider. Navigationcmdletprovider. Makepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span><span class="sxs-lookup"><span data-stu-id="490cf-138">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span></span>

- <span data-ttu-id="490cf-139">La implementación del método [System. Management. Automation. Provider. Navigationcmdletprovider. Makepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) no debe validar la ruta de acceso como una ruta de acceso completa válida en el espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="490cf-139">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method should not validate the path as a legal fully-qualified path in the provider namespace.</span></span> <span data-ttu-id="490cf-140">Tenga en cuenta que cada parámetro solo puede representar una parte de una ruta de acceso, y es posible que los elementos combinados no generen una ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="490cf-140">Be aware that each parameter can only represent a part of a path, and the combined parts might not generate a fully-qualified path.</span></span> <span data-ttu-id="490cf-141">Por ejemplo, el método [System. Management. Automation. Provider. Navigationcmdletprovider. Makepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) para el proveedor filesystem podría recibir "Windows\System32" en el parámetro `parent` y "ABC. dll" en el parámetro `child`.</span><span class="sxs-lookup"><span data-stu-id="490cf-141">For example, the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method for the filesystem provider might receive "windows\system32" in the `parent` parameter and "abc.dll" in the `child` parameter.</span></span> <span data-ttu-id="490cf-142">El método combina estos valores con el separador "\\" y devuelve "windows\system32\abc.dll", que no es una ruta de acceso completa del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="490cf-142">The method joins these values with the "\\" separator and returns "windows\system32\abc.dll", which is not a fully-qualified file system path.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="490cf-143">Las partes de la ruta de acceso proporcionadas en la llamada a [System. Management. Automation. Provider. Navigationcmdletprovider. Makepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) pueden contener caracteres no permitidos en el espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="490cf-143">The path parts provided in the call to [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) might contain characters not allowed in the provider namespace.</span></span> <span data-ttu-id="490cf-144">Normalmente, estos caracteres se usan para la expansión de caracteres comodín y la implementación de este método no debe quitarlos.</span><span class="sxs-lookup"><span data-stu-id="490cf-144">These characters are most likely used for wildcard expansion and the implementation of this method should not remove them.</span></span>

## <a name="retrieving-the-parent-path"></a><span data-ttu-id="490cf-145">Recuperación de la ruta de acceso primaria</span><span class="sxs-lookup"><span data-stu-id="490cf-145">Retrieving the Parent Path</span></span>

<span data-ttu-id="490cf-146">Los proveedores de navegación de Windows PowerShell implementan el método [System. Management. Automation. Provider. Navigationcmdletprovider. GetParentPath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) para recuperar la parte primaria de la ruta de acceso específica de proveedor completa o parcial indicada.</span><span class="sxs-lookup"><span data-stu-id="490cf-146">Windows PowerShell navigation providers implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method to retrieve the parent part of the indicated full or partial provider-specific path.</span></span> <span data-ttu-id="490cf-147">El método quita la parte secundaria de la ruta de acceso y devuelve la parte de la ruta de acceso primaria.</span><span class="sxs-lookup"><span data-stu-id="490cf-147">The method removes the child part of the path and returns the parent path part.</span></span> <span data-ttu-id="490cf-148">El parámetro `root` especifica la ruta de acceso completa a la raíz de una unidad.</span><span class="sxs-lookup"><span data-stu-id="490cf-148">The `root` parameter specifies the fully-qualified path to the root of a drive.</span></span> <span data-ttu-id="490cf-149">Este parámetro puede ser null o estar vacío si no se está usando una unidad montada para la operación de recuperación.</span><span class="sxs-lookup"><span data-stu-id="490cf-149">This parameter can be null or empty if a mounted drive is not in use for the retrieval operation.</span></span> <span data-ttu-id="490cf-150">Si se especifica una raíz, el método debe devolver una ruta de acceso a un contenedor en el mismo árbol que la raíz.</span><span class="sxs-lookup"><span data-stu-id="490cf-150">If a root is specified, the method must return a path to a container in the same tree as the root.</span></span>

<span data-ttu-id="490cf-151">El proveedor de navegación de ejemplo no invalida este método, pero utiliza la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="490cf-151">The sample navigation provider does not override this method, but uses the default implementation.</span></span> <span data-ttu-id="490cf-152">Acepta rutas de acceso que usan "/" y "\\" como separadores de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="490cf-152">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="490cf-153">Primero normaliza la ruta de acceso para que solo tenga separadores "\\" y, a continuación, divide la ruta de acceso primaria en la última "\\" y devuelve la ruta de acceso primaria.</span><span class="sxs-lookup"><span data-stu-id="490cf-153">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the parent path.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetparentpath](Msh_samplestestcmdlets#testprovidergetparentpath)]  -->

#### <a name="to-remember-about-implementing-getparentpath"></a><span data-ttu-id="490cf-154">Para recordar la implementación de GetParentPath</span><span class="sxs-lookup"><span data-stu-id="490cf-154">To Remember About Implementing GetParentPath</span></span>

<span data-ttu-id="490cf-155">La implementación del método [System. Management. Automation. Provider. Navigationcmdletprovider. GetParentPath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) debe dividir la ruta de acceso léxicamente en el separador de ruta de acceso del espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="490cf-155">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method should split the path lexically on the path separator for the provider namespace.</span></span> <span data-ttu-id="490cf-156">Por ejemplo, el proveedor filesystem usa este método para buscar el último "\\" y devuelve todo lo que queda a la izquierda del separador.</span><span class="sxs-lookup"><span data-stu-id="490cf-156">For example, the filesystem provider uses this method to look for the last "\\" and returns everything to the left of the separator.</span></span>

## <a name="retrieve-the-child-path-name"></a><span data-ttu-id="490cf-157">Recuperar el nombre de la ruta de acceso secundaria</span><span class="sxs-lookup"><span data-stu-id="490cf-157">Retrieve the Child Path Name</span></span>

<span data-ttu-id="490cf-158">El proveedor de navegación implementa el método [System. Management. Automation. Provider. Navigationcmdletprovider. Getchildname \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) para recuperar el nombre (elemento hoja) del elemento secundario del elemento que se encuentra en la ruta de acceso específica del proveedor completa o parcial indicada.</span><span class="sxs-lookup"><span data-stu-id="490cf-158">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method to retrieve the name (leaf element) of the child of the item located at the indicated full or partial provider-specific path.</span></span>

<span data-ttu-id="490cf-159">El proveedor de navegación de ejemplo no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="490cf-159">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="490cf-160">A continuación se muestra la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="490cf-160">The default implementation is shown below.</span></span> <span data-ttu-id="490cf-161">Acepta rutas de acceso que usan "/" y "\\" como separadores de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="490cf-161">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="490cf-162">Primero normaliza la ruta de acceso para que solo tenga separadores "\\" y, a continuación, divide la ruta de acceso primaria en la última "\\" y devuelve el nombre de la parte de ruta de acceso secundaria.</span><span class="sxs-lookup"><span data-stu-id="490cf-162">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the name of the child path part.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildname](Msh_samplestestcmdlets#testprovidergetchildname)]  -->

#### <a name="things-to-remember-about-implementing-getchildname"></a><span data-ttu-id="490cf-163">Aspectos que se deben recordar sobre la implementación de GetChildName</span><span class="sxs-lookup"><span data-stu-id="490cf-163">Things to Remember About Implementing GetChildName</span></span>

<span data-ttu-id="490cf-164">La implementación del método [System. Management. Automation. Provider. Navigationcmdletprovider. Getchildname \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) debe dividir la ruta de acceso léxicamente en el separador de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="490cf-164">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method should split the path lexically on the path separator.</span></span> <span data-ttu-id="490cf-165">Si la ruta de acceso proporcionada no contiene separadores de ruta de acceso, el método debe devolver la ruta de acceso sin modificar.</span><span class="sxs-lookup"><span data-stu-id="490cf-165">If the supplied path contains no path separators, the method should return the path unmodified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="490cf-166">La ruta de acceso proporcionada en la llamada a este método podría contener caracteres que no son válidos en el espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="490cf-166">The path provided in the call to this method might contain characters that are illegal in the provider namespace.</span></span> <span data-ttu-id="490cf-167">Probablemente, estos caracteres se usan para la expansión de caracteres comodín o la coincidencia de expresiones regulares, y la implementación de este método no debería quitarlos.</span><span class="sxs-lookup"><span data-stu-id="490cf-167">These characters are most likely used for wildcard expansion or regular expression matching, and the implementation of this method should not remove them.</span></span>

## <a name="determining-if-an-item-is-a-container"></a><span data-ttu-id="490cf-168">Determinar si un elemento es un contenedor</span><span class="sxs-lookup"><span data-stu-id="490cf-168">Determining if an Item is a Container</span></span>

<span data-ttu-id="490cf-169">El proveedor de navegación puede implementar el método [System. Management. Automation. Provider. Navigationcmdletprovider. Isitemcontainer \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) para determinar si la ruta de acceso especificada indica un contenedor.</span><span class="sxs-lookup"><span data-stu-id="490cf-169">The navigation provider can implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) method to determine if the specified path indicates a container.</span></span> <span data-ttu-id="490cf-170">Devuelve true si la ruta de acceso representa un contenedor y false en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="490cf-170">It returns true if the path represents a container, and false otherwise.</span></span> <span data-ttu-id="490cf-171">El usuario necesita este método para poder usar el cmdlet `Test-Path` para la ruta de acceso proporcionada.</span><span class="sxs-lookup"><span data-stu-id="490cf-171">The user needs this method to be able to use the `Test-Path` cmdlet for the supplied path.</span></span>

<span data-ttu-id="490cf-172">En el código siguiente se muestra la implementación de [System. Management. Automation. Provider. Navigationcmdletprovider. Isitemcontainer \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) en nuestro proveedor de navegación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="490cf-172">The following code shows the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementation in our sample navigation provider.</span></span> <span data-ttu-id="490cf-173">El método comprueba que la ruta de acceso especificada es correcta y si la tabla existe, y devuelve true si la ruta de acceso indica un contenedor.</span><span class="sxs-lookup"><span data-stu-id="490cf-173">The method verifies that  the specified path is correct and if the table exists, and returns true if the path indicates a container.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L847-L872 "AccessDBProviderSample05.cs")]

#### <a name="things-to-remember-about-implementing-isitemcontainer"></a><span data-ttu-id="490cf-174">Aspectos que se deben recordar sobre la implementación de IsItemContainer</span><span class="sxs-lookup"><span data-stu-id="490cf-174">Things to Remember About Implementing IsItemContainer</span></span>

<span data-ttu-id="490cf-175">La clase .NET del proveedor de navegación podría declarar las capacidades del proveedor de ExpandWildcards, Filter, include o exclude de la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="490cf-175">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="490cf-176">En este caso, la implementación de [System. Management. Automation. Provider. Navigationcmdletprovider. Isitemcontainer \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) necesita asegurarse de que la ruta de acceso pasada cumple los requisitos.</span><span class="sxs-lookup"><span data-stu-id="490cf-176">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) needs to ensure that the path passed meets requirements.</span></span> <span data-ttu-id="490cf-177">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, la propiedad [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .</span><span class="sxs-lookup"><span data-stu-id="490cf-177">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) property.</span></span>

## <a name="moving-an-item"></a><span data-ttu-id="490cf-178">Mover un elemento</span><span class="sxs-lookup"><span data-stu-id="490cf-178">Moving an Item</span></span>

<span data-ttu-id="490cf-179">En la compatibilidad del cmdlet `Move-Item`, el proveedor de navegación implementa el método [System. Management. Automation. Provider. Navigationcmdletprovider. MoveItem \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) .</span><span class="sxs-lookup"><span data-stu-id="490cf-179">In support of the `Move-Item` cmdlet, your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="490cf-180">Este método mueve el elemento especificado por el parámetro `path` al contenedor en la ruta de acceso proporcionada en el parámetro `destination`.</span><span class="sxs-lookup"><span data-stu-id="490cf-180">This method moves the item specified by the `path` parameter to the container at the path supplied in the `destination` parameter.</span></span>

<span data-ttu-id="490cf-181">El proveedor de navegación de ejemplo no invalida el método [System. Management. Automation. Provider. Navigationcmdletprovider. MoveItem \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) .</span><span class="sxs-lookup"><span data-stu-id="490cf-181">The sample navigation provider does not override the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="490cf-182">A continuación se encuentra la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="490cf-182">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitem](Msh_samplestestcmdlets#testprovidermoveitem)]  -->

#### <a name="things-to-remember-about-implementing-moveitem"></a><span data-ttu-id="490cf-183">Aspectos que se deben recordar sobre la implementación de MoveItem</span><span class="sxs-lookup"><span data-stu-id="490cf-183">Things to Remember About Implementing MoveItem</span></span>

<span data-ttu-id="490cf-184">La clase .NET del proveedor de navegación podría declarar las capacidades del proveedor de ExpandWildcards, Filter, include o exclude de la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="490cf-184">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="490cf-185">En este caso, la implementación de [System. Management. Automation. Provider. Navigationcmdletprovider. MoveItem \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe asegurarse de que la ruta de acceso pasada cumple los requisitos.</span><span class="sxs-lookup"><span data-stu-id="490cf-185">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) must ensure that the path passed meets requirements.</span></span> <span data-ttu-id="490cf-186">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, la propiedad **CmdletProvider. Exclude** .</span><span class="sxs-lookup"><span data-stu-id="490cf-186">To do this, the method should access the appropriate property, for example, the **CmdletProvider.Exclude** property.</span></span>

<span data-ttu-id="490cf-187">De forma predeterminada, las invalidaciones de este método no deben trasladar objetos sobre objetos existentes a menos que la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esté establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="490cf-187">By default, overrides of this method should not move objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="490cf-188">Por ejemplo, el proveedor filesystem no copiará c:\temp\abc.txt sobre un archivo c:\bar.txt existente, a menos que la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) esté establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="490cf-188">For example, the filesystem provider will not copy c:\temp\abc.txt over an existing c:\bar.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="490cf-189">Si la ruta de acceso especificada en el parámetro `destination` existe y es un contenedor, la propiedad [System. Management. Automation. Provider. Cmdletprovider. Force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) no es necesaria.</span><span class="sxs-lookup"><span data-stu-id="490cf-189">If the path specified in the `destination` parameter exists and is a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="490cf-190">En este caso, [System. Management. Automation. Provider. Navigationcmdletprovider. MoveItem \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe trasladar el elemento indicado por el parámetro `path` al contenedor indicado por el parámetro `destination` como un elemento secundario.</span><span class="sxs-lookup"><span data-stu-id="490cf-190">In this case, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) should move the item indicated by the `path` parameter to the container indicated by the `destination` parameter as a child.</span></span>

<span data-ttu-id="490cf-191">La implementación del método [System. Management. Automation. Provider. Navigationcmdletprovider. MoveItem \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe llamar a [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de realizar cambios en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="490cf-191">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="490cf-192">Este método se usa para confirmar la ejecución de una operación cuando se realiza un cambio en el estado del sistema, por ejemplo, la eliminación de archivos.</span><span class="sxs-lookup"><span data-stu-id="490cf-192">This method is used to confirm execution of an operation when a change is made to system state, for example, deleting files.</span></span> <span data-ttu-id="490cf-193">[System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envía el nombre del recurso que se va a cambiar al usuario, con el tiempo de ejecución de Windows PowerShell teniendo en cuenta cualquier configuración de línea de comandos o variables de preferencia para determinar lo que se debe mostrar al usuario.</span><span class="sxs-lookup"><span data-stu-id="490cf-193">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed to the user.</span></span>

<span data-ttu-id="490cf-194">Después de que la llamada a [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelva `true`, el método [System. Management. Automation. Provider. Navigationcmdletprovider. MoveItem \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe llamar al método [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="490cf-194">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="490cf-195">Este método envía un mensaje al usuario para permitir que los comentarios indiquen si la operación debe continuar.</span><span class="sxs-lookup"><span data-stu-id="490cf-195">This method sends a message to the user to allow feedback to say if the operation should be continued.</span></span> <span data-ttu-id="490cf-196">El proveedor debe llamar a [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como una comprobación adicional para las modificaciones potencialmente peligrosas del sistema.</span><span class="sxs-lookup"><span data-stu-id="490cf-196">Your provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-move-item-cmdlet"></a><span data-ttu-id="490cf-197">Asociar parámetros dinámicos al cmdlet Move-Item</span><span class="sxs-lookup"><span data-stu-id="490cf-197">Attaching Dynamic Parameters to the Move-Item Cmdlet</span></span>

<span data-ttu-id="490cf-198">A veces, el cmdlet `Move-Item` requiere parámetros adicionales que se proporcionan dinámicamente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="490cf-198">Sometimes the `Move-Item` cmdlet requires additional parameters that are provided dynamically at runtime.</span></span> <span data-ttu-id="490cf-199">Para proporcionar estos parámetros dinámicos, el proveedor de navegación debe implementar el método [System. Management. Automation. Provider. Navigationcmdletprovider. Moveitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) para obtener los valores de parámetro necesarios del elemento en la ruta de acceso indicada y devolver un objeto que tiene propiedades y campos con atributos de análisis similares a una clase de cmdlet o un objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="490cf-199">To provide these dynamic parameters, the navigation provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) method to get the required parameter values from the item at the indicated path, and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="490cf-200">Este proveedor de navegación no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="490cf-200">This navigation provider does not implement this method.</span></span> <span data-ttu-id="490cf-201">Sin embargo, el código siguiente es la implementación predeterminada de [System. Management. Automation. Provider. Navigationcmdletprovider. Moveitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="490cf-201">However, the following code is the default implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters](Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters)]  -->

## <a name="normalizing-a-relative-path"></a><span data-ttu-id="490cf-202">Normalización de una ruta de acceso relativa</span><span class="sxs-lookup"><span data-stu-id="490cf-202">Normalizing a Relative Path</span></span>

<span data-ttu-id="490cf-203">El proveedor de navegación implementa el método [System. Management. Automation. Provider. Navigationcmdletprovider. Normalizerelativepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) para normalizar la ruta de acceso completa indicada en el parámetro `path` como relativa a la ruta de acceso especificada por el parámetro `basePath`.</span><span class="sxs-lookup"><span data-stu-id="490cf-203">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) method to normalize the fully-qualified path indicated in the `path` parameter as being relative to the path specified by the `basePath` parameter.</span></span> <span data-ttu-id="490cf-204">El método devuelve una representación de cadena de la ruta de acceso normalizada.</span><span class="sxs-lookup"><span data-stu-id="490cf-204">The method returns a string representation of the normalized path.</span></span> <span data-ttu-id="490cf-205">Escribe un error si el parámetro `path` especifica una ruta de acceso inexistente.</span><span class="sxs-lookup"><span data-stu-id="490cf-205">It writes an error if the `path` parameter specifies a nonexistent path.</span></span>

<span data-ttu-id="490cf-206">El proveedor de navegación de ejemplo no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="490cf-206">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="490cf-207">A continuación se encuentra la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="490cf-207">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernormalizepath](Msh_samplestestcmdlets#testprovidernormalizepath)]  -->

#### <a name="things-to-remember-about-implementing-normalizerelativepath"></a><span data-ttu-id="490cf-208">Aspectos que se deben recordar sobre la implementación de NormalizeRelativePath</span><span class="sxs-lookup"><span data-stu-id="490cf-208">Things to Remember About Implementing NormalizeRelativePath</span></span>

<span data-ttu-id="490cf-209">La implementación de [System. Management. Automation. Provider. Navigationcmdletprovider. Normalizerelativepath \*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) debe analizar el parámetro `path`, pero no tiene que usar el análisis puramente sintáctico.</span><span class="sxs-lookup"><span data-stu-id="490cf-209">Your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) should parse the `path` parameter, but it does not have to use purely syntactical parsing.</span></span> <span data-ttu-id="490cf-210">Se recomienda diseñar este método para usar la ruta de acceso para buscar la información de la ruta de acceso en el almacén de datos y crear una ruta de acceso que coincida con el uso de mayúsculas y minúsculas con la sintaxis de ruta de acceso normalizada.</span><span class="sxs-lookup"><span data-stu-id="490cf-210">You are encouraged to design this method to use the path to look up the path information in the data store and create a path that matches the casing and standardized path syntax.</span></span>

## <a name="code-sample"></a><span data-ttu-id="490cf-211">Código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="490cf-211">Code Sample</span></span>

<span data-ttu-id="490cf-212">Para obtener el código de ejemplo completo, vea el [ejemplo de código AccessDbProviderSample05](./accessdbprovidersample05-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="490cf-212">For complete sample code, see [AccessDbProviderSample05 Code Sample](./accessdbprovidersample05-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="490cf-213">Definir tipos de objeto y formato</span><span class="sxs-lookup"><span data-stu-id="490cf-213">Defining Object Types and Formatting</span></span>

<span data-ttu-id="490cf-214">Un proveedor puede Agregar miembros a objetos existentes o definir nuevos objetos.</span><span class="sxs-lookup"><span data-stu-id="490cf-214">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="490cf-215">Para obtener más información, vea[extender tipos de objeto y formato](https://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="490cf-215">For more information, see[Extending Object Types and Formatting](https://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="490cf-216">Compilar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-216">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="490cf-217">Para obtener más información, vea [Cómo registrar cmdlets, proveedores y aplicaciones host](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="490cf-217">For more information, see [How to Register Cmdlets, Providers, and Host Applications](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="490cf-218">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-218">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="490cf-219">Cuando el proveedor de Windows PowerShell se ha registrado con Windows PowerShell, puede probarlo mediante la ejecución de los cmdlets admitidos en la línea de comandos, incluidos los cmdlets disponibles por derivación.</span><span class="sxs-lookup"><span data-stu-id="490cf-219">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line, including cmdlets made available by derivation.</span></span> <span data-ttu-id="490cf-220">En este ejemplo se probará el proveedor de navegación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="490cf-220">This example will test the sample navigation provider.</span></span>

1. <span data-ttu-id="490cf-221">Ejecute el nuevo Shell y use el cmdlet `Set-Location` para establecer la ruta de acceso que indica la base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="490cf-221">Run your new shell and use the `Set-Location` cmdlet to set the path to indicate the Access database.</span></span>

   ```powershell
   Set-Location mydb:
   ```

2. <span data-ttu-id="490cf-222">Ahora ejecute el cmdlet `Get-Childitem` para recuperar una lista de los elementos de base de datos, que son las tablas de base de datos disponibles.</span><span class="sxs-lookup"><span data-stu-id="490cf-222">Now run the `Get-Childitem` cmdlet to retrieve a list of the database items, which are the available database tables.</span></span> <span data-ttu-id="490cf-223">Para cada tabla, este cmdlet también recupera el número de filas de la tabla.</span><span class="sxs-lookup"><span data-stu-id="490cf-223">For each table, this cmdlet also retrieves the number of table rows.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rowcount,name -AutoSize
   ```

   ```output
   RowCount   Name
   --------   ----
        180   MSysAccessObjects
          0   MSysACEs
          1   MSysCmdbars
          0   MSysIMEXColumns
          0   MSysIMEXSpecs
          0   MSysObjects
          0   MSysQueries
          7   MSysRelationships
          8   Categories
         91   Customers
          9   Employees
       2155   Order Details
        830   Orders
         77   Products
          3   Shippers
         29   Suppliers
   ```

3. <span data-ttu-id="490cf-224">Vuelva a usar el cmdlet `Set-Location` para establecer la ubicación de la tabla de datos Employees.</span><span class="sxs-lookup"><span data-stu-id="490cf-224">Use the `Set-Location` cmdlet again to set the location of the Employees data table.</span></span>

   ```powershell
   Set-Location Employees
   ```

4. <span data-ttu-id="490cf-225">Ahora vamos a usar el cmdlet `Get-Location` para recuperar la ruta de acceso a la tabla Employees.</span><span class="sxs-lookup"><span data-stu-id="490cf-225">Let's now use the `Get-Location` cmdlet to retrieve the path to the Employees table.</span></span>

   ```powershell
   Get-Location
   ```

   ```output
   Path
   ----
   mydb:\Employees
   ```

5. <span data-ttu-id="490cf-226">Ahora use el cmdlet `Get-Childitem` canalizado al cmdlet `Format-Table`.</span><span class="sxs-lookup"><span data-stu-id="490cf-226">Now use the `Get-Childitem` cmdlet piped to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="490cf-227">Este conjunto de cmdlets recupera los elementos de la tabla de datos Employees, que son las filas de la tabla.</span><span class="sxs-lookup"><span data-stu-id="490cf-227">This set of cmdlets retrieves the items for the Employees data table, which are the table rows.</span></span> <span data-ttu-id="490cf-228">Tienen el formato especificado por el cmdlet `Format-Table`.</span><span class="sxs-lookup"><span data-stu-id="490cf-228">They are formatted as specified by the `Format-Table` cmdlet.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rownumber,psiscontainer,data -AutoSize
   ```

   ```output
   RowNumber   PSIsContainer   Data
   ---------   --------------   ----
   0           False            System.Data.DataRow
   1           False            System.Data.DataRow
   2           False            System.Data.DataRow
   3           False            System.Data.DataRow
   4           False            System.Data.DataRow
   5           False            System.Data.DataRow
   6           False            System.Data.DataRow
   7           False            System.Data.DataRow
   8           False            System.Data.DataRow
   ```

6. <span data-ttu-id="490cf-229">Ahora puede ejecutar el cmdlet `Get-Item` para recuperar los elementos de la fila 0 de la tabla de datos Employees.</span><span class="sxs-lookup"><span data-stu-id="490cf-229">You can now run the `Get-Item` cmdlet to retrieve the items for row 0 of the Employees data table.</span></span>

   ```powershell
   Get-Item 0
   ```

   ```output
   PSPath        : AccessDB::C:\PS\Northwind.mdb\Employees\0
   PSParentPath  : AccessDB::C:\PS\Northwind.mdb\Employees
   PSChildName   : 0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data           : System.Data.DataRow
   RowNumber      : 0
   ```

7. <span data-ttu-id="490cf-230">Vuelva a usar el cmdlet `Get-Item` para recuperar los datos de empleados de los elementos de la fila 0.</span><span class="sxs-lookup"><span data-stu-id="490cf-230">Use the `Get-Item` cmdlet again to retrieve the employee data for the items in row 0.</span></span>

   ```powershell
   (Get-Item 0).data
   ```

   ```output
   EmployeeID      : 1
   LastName        : Davis
   FirstName       : Sara
   Title           : Sales Representative
   TitleOfCourtesy : Ms.
   BirthDate       : 12/8/1968 12:00:00 AM
   HireDate        : 5/1/1992 12:00:00 AM
   Address         : 4567 Main Street
                     Apt. 2A
   City            : Buffalo
   Region          : NY
   PostalCode      : 98052
   Country         : USA
   HomePhone       : (206) 555-9857
   Extension       : 5467
   Photo           : EmpID1.bmp
   Notes           : Education includes a BA in psychology from
                     Colorado State University. She also completed "The
                     Art of the Cold Call."  Nancy is a member of
                     Toastmasters International.
   ReportsTo       : 2
   ```

## <a name="see-also"></a><span data-ttu-id="490cf-231">Vea también</span><span class="sxs-lookup"><span data-stu-id="490cf-231">See Also</span></span>

[<span data-ttu-id="490cf-232">Crear proveedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-232">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="490cf-233">Diseño del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-233">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="490cf-234">Extender tipos de objeto y formato</span><span class="sxs-lookup"><span data-stu-id="490cf-234">Extending Object Types and Formatting</span></span>](https://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="490cf-235">Implementar un proveedor de Windows PowerShell de contenedor</span><span class="sxs-lookup"><span data-stu-id="490cf-235">Implement a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="490cf-236">Cómo registrar cmdlets, proveedores y aplicaciones host</span><span class="sxs-lookup"><span data-stu-id="490cf-236">How to Register Cmdlets, Providers, and Host Applications</span></span>](https://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="490cf-237">Guía del programador de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="490cf-237">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="490cf-238">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="490cf-238">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
