---
title: Crear un proveedor básico de Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- base provider [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], base provider
ms.assetid: 11eeea41-15c8-47ad-9016-0f4b72573305
caps.latest.revision: 7
ms.openlocfilehash: e825581b96f0f33893b38f9f6499dd46a7bf38eb
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2019
ms.locfileid: "72360524"
---
# <a name="creating-a-basic-windows-powershell-provider"></a><span data-ttu-id="277b7-102">Diseño de un proveedor de Windows PowerShell básico</span><span class="sxs-lookup"><span data-stu-id="277b7-102">Creating a Basic Windows PowerShell Provider</span></span>

<span data-ttu-id="277b7-103">Este tema es el punto de partida para aprender a crear un proveedor de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="277b7-103">This topic is the starting point for learning how to create a Windows PowerShell provider.</span></span> <span data-ttu-id="277b7-104">El proveedor básico que se describe aquí proporciona métodos para iniciar y detener el proveedor y, aunque este proveedor no proporciona un medio para tener acceso a un almacén de datos o para obtener o establecer los datos en el almacén de datos, proporciona la funcionalidad básica que requiere todos los proveedores.</span><span class="sxs-lookup"><span data-stu-id="277b7-104">The basic provider described here provides methods for starting and stopping the provider, and although this provider does not provide a means to access a data store or to get or set the data in the data store, it does provide the basic functionality that is required by all providers.</span></span>

<span data-ttu-id="277b7-105">Como se mencionó anteriormente, el proveedor básico que se describe aquí implementa métodos para iniciar y detener el proveedor.</span><span class="sxs-lookup"><span data-stu-id="277b7-105">As mentioned previously, the basic provider described here implements methods for starting and stopping the provider.</span></span> <span data-ttu-id="277b7-106">El tiempo de ejecución de Windows PowerShell llama a estos métodos para inicializar y anular la inicialización del proveedor.</span><span class="sxs-lookup"><span data-stu-id="277b7-106">The Windows PowerShell runtime calls these methods to initialize and uninitialize the provider.</span></span>

> [!NOTE]
> <span data-ttu-id="277b7-107">Puede encontrar un ejemplo de este proveedor en el archivo AccessDBSampleProvider01.cs proporcionado por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="277b7-107">You can find a sample of this provider in the AccessDBSampleProvider01.cs file provided by Windows PowerShell.</span></span>

## <a name="defining-the-windows-powershell-provider-class"></a><span data-ttu-id="277b7-108">Definir la clase de proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="277b7-108">Defining the Windows PowerShell Provider Class</span></span>

<span data-ttu-id="277b7-109">El primer paso para crear un proveedor de Windows PowerShell es definir su clase .NET.</span><span class="sxs-lookup"><span data-stu-id="277b7-109">The first step in creating a Windows PowerShell provider is to define its .NET class.</span></span> <span data-ttu-id="277b7-110">Este proveedor básico define una clase denominada `AccessDBProvider` que se deriva de la clase base [System. Management. Automation. Provider. Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="277b7-110">This basic provider defines a class called `AccessDBProvider` that derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span>

<span data-ttu-id="277b7-111">Se recomienda colocar las clases de proveedor en un espacio de nombres `Providers` del espacio de nombres de la API, por ejemplo, xxx. PowerShell. Providers.</span><span class="sxs-lookup"><span data-stu-id="277b7-111">It is recommended that you place your provider classes in a `Providers` namespace of your API namespace, for example, xxx.PowerShell.Providers.</span></span> <span data-ttu-id="277b7-112">Este proveedor usa el espacio de nombres `Microsoft.Samples.PowerShell.Provider`, en el que se ejecutan todos los ejemplos del proveedor de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="277b7-112">This provider uses the `Microsoft.Samples.PowerShell.Provider` namespace, in which all Windows PowerShell provider samples run.</span></span>

> [!NOTE]
> <span data-ttu-id="277b7-113">La clase de un proveedor de Windows PowerShell debe marcarse explícitamente como Public.</span><span class="sxs-lookup"><span data-stu-id="277b7-113">The class for a Windows PowerShell provider must be explicitly marked as public.</span></span> <span data-ttu-id="277b7-114">Las clases no marcadas como públicas tendrán como valor predeterminado Internal y no se encontrarán en tiempo de ejecución de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="277b7-114">Classes not marked as public will default to internal and will not be found by the Windows PowerShell runtime.</span></span>

<span data-ttu-id="277b7-115">Esta es la definición de clase para este proveedor básico:</span><span class="sxs-lookup"><span data-stu-id="277b7-115">Here is the class definition for this basic provider:</span></span>

[!code-csharp[AccessDBProviderSample01.cs](../../../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample01/AccessDBProviderSample01.cs#L23-L24 "AccessDBProviderSample01.cs")]

<span data-ttu-id="277b7-116">Justo antes de la definición de clase, debe declarar el atributo [System. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) con la sintaxis [CmdletProvider ()].</span><span class="sxs-lookup"><span data-stu-id="277b7-116">Right before the class definition, you must declare the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute, with the syntax [CmdletProvider()].</span></span>

<span data-ttu-id="277b7-117">Puede establecer palabras clave de atributo para declarar más la clase si es necesario.</span><span class="sxs-lookup"><span data-stu-id="277b7-117">You can set attribute keywords to further declare the class if necessary.</span></span> <span data-ttu-id="277b7-118">Observe que el atributo [System. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) declarado aquí incluye dos parámetros.</span><span class="sxs-lookup"><span data-stu-id="277b7-118">Notice that the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute declared here includes two parameters.</span></span> <span data-ttu-id="277b7-119">El primer parámetro de atributo especifica el nombre descriptivo predeterminado para el proveedor, que el usuario puede modificar más adelante.</span><span class="sxs-lookup"><span data-stu-id="277b7-119">The first attribute parameter specifies the default-friendly name for the provider, which the user can modify later.</span></span> <span data-ttu-id="277b7-120">El segundo parámetro especifica las capacidades definidas por Windows PowerShell que el proveedor expone al tiempo de ejecución de Windows PowerShell durante el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="277b7-120">The second parameter specifies the Windows PowerShell-defined capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="277b7-121">Los valores posibles para las capacidades del proveedor se definen mediante la enumeración [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="277b7-121">The possible values for the provider capabilities are defined by the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="277b7-122">Dado que se trata de un proveedor base, no admite ninguna funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="277b7-122">Because this is a base provider, it supports no capabilities.</span></span>

> [!NOTE]
> <span data-ttu-id="277b7-123">El nombre completo del proveedor de Windows PowerShell incluye el nombre del ensamblado y otros atributos determinados por Windows PowerShell en el momento del registro del proveedor.</span><span class="sxs-lookup"><span data-stu-id="277b7-123">The fully qualified name of the Windows PowerShell provider includes the assembly name and other attributes determined by Windows PowerShell upon registration of the provider.</span></span>

## <a name="defining-provider-specific-state-information"></a><span data-ttu-id="277b7-124">Definir la información de estado específica del proveedor</span><span class="sxs-lookup"><span data-stu-id="277b7-124">Defining Provider-Specific State Information</span></span>

<span data-ttu-id="277b7-125">La clase base [System. Management. Automation. Provider. Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) y todas las clases derivadas se consideran sin estado porque el tiempo de ejecución de Windows PowerShell crea instancias de proveedor solo según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="277b7-125">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class and all derived classes are considered stateless because the Windows PowerShell runtime creates provider instances only as required.</span></span> <span data-ttu-id="277b7-126">Por consiguiente, si el proveedor requiere un control total y el mantenimiento del estado de los datos específicos del proveedor, debe derivar una clase de la clase [System. Management. Automation. providerinfo devuelto por](/dotnet/api/System.Management.Automation.ProviderInfo) .</span><span class="sxs-lookup"><span data-stu-id="277b7-126">Therefore, if your provider requires full control and state maintenance for provider-specific data, it must derive a class from the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) class.</span></span> <span data-ttu-id="277b7-127">La clase derivada debe definir los miembros necesarios para mantener el estado de forma que se pueda tener acceso a los datos específicos del proveedor cuando el tiempo de ejecución de Windows PowerShell llame al método [System. Management. Automation. Provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) para inicializar el proveedor.</span><span class="sxs-lookup"><span data-stu-id="277b7-127">Your derived class should define the members necessary to maintain the state so that the provider-specific data can be accessed when the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to initialize the provider.</span></span>

<span data-ttu-id="277b7-128">Un proveedor de Windows PowerShell también puede mantener el estado basado en la conexión.</span><span class="sxs-lookup"><span data-stu-id="277b7-128">A Windows PowerShell provider can also maintain connection-based state.</span></span> <span data-ttu-id="277b7-129">Para obtener más información sobre cómo mantener el estado de conexión, vea [crear un proveedor de unidades de PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="277b7-129">For more information about maintaining connection state, see [Creating a PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="initializing-the-provider"></a><span data-ttu-id="277b7-130">Inicializar el proveedor</span><span class="sxs-lookup"><span data-stu-id="277b7-130">Initializing the Provider</span></span>

<span data-ttu-id="277b7-131">Para inicializar el proveedor, el tiempo de ejecución de Windows PowerShell llama al método [System. Management. Automation. Provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) cuando se inicia Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="277b7-131">To initialize the provider, the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method when Windows PowerShell is started.</span></span> <span data-ttu-id="277b7-132">En su mayor parte, el proveedor puede usar la implementación predeterminada de este método, que simplemente devuelve el objeto [System. Management. Automation. providerinfo devuelto por](/dotnet/api/System.Management.Automation.ProviderInfo) que describe el proveedor.</span><span class="sxs-lookup"><span data-stu-id="277b7-132">For the most part, your provider can use the default implementation of this method, which simply returns the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that describes your provider.</span></span> <span data-ttu-id="277b7-133">Sin embargo, en caso de que desee agregar información de inicialización adicional, debe implementar su propio método [System. Management. Automation. Provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) que devuelve una versión modificada del objeto [System. Management. Automation. providerinfo devuelto por](/dotnet/api/System.Management.Automation.ProviderInfo) que se pasa al proveedor.</span><span class="sxs-lookup"><span data-stu-id="277b7-133">However, in the case where you want to add additional initialization information, you should implement your own [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method that returns a modified version of the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that is passed to your provider.</span></span> <span data-ttu-id="277b7-134">En general, este método debe devolver el objeto [System. Management. Automation. providerinfo devuelto por](/dotnet/api/System.Management.Automation.ProviderInfo) proporcionado que se le ha pasado o un objeto [System. Management. Automation. providerinfo devuelto por](/dotnet/api/System.Management.Automation.ProviderInfo) modificado que contiene otra información de inicialización.</span><span class="sxs-lookup"><span data-stu-id="277b7-134">In general, this method should return the provided [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object passed to it or a modified [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that contains other initialization information.</span></span>

<span data-ttu-id="277b7-135">Este proveedor básico no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="277b7-135">This basic provider does not override this method.</span></span> <span data-ttu-id="277b7-136">Sin embargo, en el código siguiente se muestra la implementación predeterminada de este método:</span><span class="sxs-lookup"><span data-stu-id="277b7-136">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStart](Msh_samplesaccessdbprov01#accessdbprov01ProviderStart)]  -->

<span data-ttu-id="277b7-137">El proveedor puede mantener el estado de la información específica del proveedor, tal como se describe en definir el estado de los [datos específicos del proveedor](#defining-provider-specific-state-information).</span><span class="sxs-lookup"><span data-stu-id="277b7-137">The provider can maintain the state of provider-specific information as described in [Defining Provider-specific Data State](#defining-provider-specific-state-information).</span></span> <span data-ttu-id="277b7-138">En este caso, la implementación debe reemplazar el método [System. Management. Automation. Provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) para devolver una instancia de la clase derivada.</span><span class="sxs-lookup"><span data-stu-id="277b7-138">In this case, your implementation must override the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to return an instance of the derived class.</span></span>

## <a name="start-dynamic-parameters"></a><span data-ttu-id="277b7-139">Iniciar parámetros dinámicos</span><span class="sxs-lookup"><span data-stu-id="277b7-139">Start Dynamic Parameters</span></span>

<span data-ttu-id="277b7-140">La implementación del proveedor del método [System. Management. Automation. Provider. Cmdletprovider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) podría requerir parámetros adicionales.</span><span class="sxs-lookup"><span data-stu-id="277b7-140">Your provider implementation of the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method might require additional parameters.</span></span> <span data-ttu-id="277b7-141">En este caso, el proveedor debe reemplazar el método [System. Management. Automation. Provider. Cmdletprovider. Startdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) y devolver un objeto que tiene propiedades y campos con atributos de análisis similares a una clase de cmdlet o un objeto [System. Management. Automation. Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="277b7-141">In this case, the provider should override the [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) method and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="277b7-142">Este proveedor básico no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="277b7-142">This basic provider does not override this method.</span></span> <span data-ttu-id="277b7-143">Sin embargo, en el código siguiente se muestra la implementación predeterminada de este método:</span><span class="sxs-lookup"><span data-stu-id="277b7-143">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters](Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters)]  -->

## <a name="uninitializing-the-provider"></a><span data-ttu-id="277b7-144">Anulando la inicialización del proveedor</span><span class="sxs-lookup"><span data-stu-id="277b7-144">Uninitializing the Provider</span></span>

<span data-ttu-id="277b7-145">Para liberar los recursos que usa el proveedor de Windows PowerShell, el proveedor debe implementar su propio método [System. Management. Automation. Provider. Cmdletprovider. Stop \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) .</span><span class="sxs-lookup"><span data-stu-id="277b7-145">To free resources that the Windows PowerShell provider uses, your provider should implement its own [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) method.</span></span> <span data-ttu-id="277b7-146">Este método es llamado por el tiempo de ejecución de Windows PowerShell para anular la inicialización del proveedor al cerrar una sesión.</span><span class="sxs-lookup"><span data-stu-id="277b7-146">This method is called by the Windows PowerShell runtime to uninitialize the provider at the close of a session.</span></span>

<span data-ttu-id="277b7-147">Este proveedor básico no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="277b7-147">This basic provider does not override this method.</span></span> <span data-ttu-id="277b7-148">Sin embargo, en el código siguiente se muestra la implementación predeterminada de este método:</span><span class="sxs-lookup"><span data-stu-id="277b7-148">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStop](Msh_samplesaccessdbprov01#accessdbprov01ProviderStop)]  -->

## <a name="code-sample"></a><span data-ttu-id="277b7-149">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="277b7-149">Code Sample</span></span>

<span data-ttu-id="277b7-150">Para obtener el código de ejemplo completo, vea el [ejemplo de código AccessDbProviderSample01](./accessdbprovidersample01-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="277b7-150">For complete sample code, see [AccessDbProviderSample01 Code Sample](./accessdbprovidersample01-code-sample.md).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="277b7-151">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="277b7-151">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="277b7-152">Una vez que el proveedor de Windows PowerShell se ha registrado con Windows PowerShell, puede probarlo mediante la ejecución de los cmdlets admitidos en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="277b7-152">Once your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="277b7-153">Para este proveedor básico, ejecute el nuevo Shell y use el cmdlet `Get-PSProvider` para recuperar la lista de proveedores y asegurarse de que el proveedor AccessDb está presente.</span><span class="sxs-lookup"><span data-stu-id="277b7-153">For this basic provider, run the new shell and use the `Get-PSProvider` cmdlet to retrieve the list of providers and ensure that the AccessDb provider is present.</span></span>

```powershell
Get-PSProvider
```

<span data-ttu-id="277b7-154">Aparecerá el siguiente resultado:</span><span class="sxs-lookup"><span data-stu-id="277b7-154">The following output appears:</span></span>

```output
Name                 Capabilities                  Drives
----                 ------------                  ------
AccessDb             None                          {}
Alias                ShouldProcess                 {Alias}
Environment          ShouldProcess                 {Env}
FileSystem           Filter, ShouldProcess         {C, Z}
Function             ShouldProcess                 {function}
Registry             ShouldProcess                 {HKLM, HKCU}
```

## <a name="see-also"></a><span data-ttu-id="277b7-155">Véase también</span><span class="sxs-lookup"><span data-stu-id="277b7-155">See Also</span></span>

[<span data-ttu-id="277b7-156">Crear proveedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="277b7-156">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="277b7-157">Diseño del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="277b7-157">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)
