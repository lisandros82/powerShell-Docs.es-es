---
ms.date: 06/27/2017
keywords: powershell, cmdlet
title: Reglas de autorización y características de seguridad de Windows PowerShell Web Access
ms.openlocfilehash: c426b8cfb10829241ba244a5d840c91e1de9f66e
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2019
ms.locfileid: "62058427"
---
# <a name="authorization-rules-and-security-features-of-windows-powershell-web-access"></a><span data-ttu-id="02c47-103">Reglas de autorización y características de seguridad de Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="02c47-103">Authorization Rules and Security Features of Windows PowerShell Web Access</span></span>

<span data-ttu-id="02c47-104">Actualizado: 24 de junio de 2013</span><span class="sxs-lookup"><span data-stu-id="02c47-104">Updated: June 24, 2013</span></span>

<span data-ttu-id="02c47-105">Se aplica a: Windows Server 2012 R2, Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="02c47-105">Applies To: Windows Server 2012 R2, Windows Server 2012</span></span>

<span data-ttu-id="02c47-106">Windows PowerShell Web Access en Windows Server 2012 R2 y Windows Server 2012 tienen un modelo de seguridad restrictiva.</span><span class="sxs-lookup"><span data-stu-id="02c47-106">Windows PowerShell Web Access in Windows Server 2012 R2 and Windows Server 2012 has a restrictive security model.</span></span> <span data-ttu-id="02c47-107">Los usuarios tienen que tener el acceso concedido explícitamente antes de iniciar sesión en la puerta de enlace de Windows PowerShell ISE y usar la consola basada en web de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="02c47-107">Users must explicitly be granted access before they can sign in to the Windows PowerShell Web Access gateway and use the web-based Windows PowerShell console.</span></span>

## <a name="configuring-authorization-rules-and-site-security"></a><span data-ttu-id="02c47-108">Configurar las reglas de autorización y la seguridad del sitio</span><span class="sxs-lookup"><span data-stu-id="02c47-108">Configuring authorization rules and site security</span></span>

<span data-ttu-id="02c47-109">Una vez instalado Windows PowerShell Web Access y configurada la puerta de enlace, los usuarios podrán abrir la página de inicio de sesión en un explorador, pero no podrán iniciar sesión hasta que el administrador de Windows PowerShell Web Access les conceda acceso de manera explícita.</span><span class="sxs-lookup"><span data-stu-id="02c47-109">After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.</span></span> <span data-ttu-id="02c47-110">El control de acceso de Windows PowerShell Web Access se administra mediante el conjunto de cmdlets de Windows PowerShell descrito en la siguiente tabla.</span><span class="sxs-lookup"><span data-stu-id="02c47-110">'Windows PowerShell Web Access' access control is managed by using the set of Windows PowerShell cmdlets described in the following table.</span></span> <span data-ttu-id="02c47-111">No existe una GUI comparable para agregar o administrar reglas de autorización.</span><span class="sxs-lookup"><span data-stu-id="02c47-111">There is no comparable GUI for adding or managing authorization rules.</span></span>
<span data-ttu-id="02c47-112">Vea [Windows PowerShell Web Access Cmdlets](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps) (Cmdlets de Windows PowerShell Web Access).</span><span class="sxs-lookup"><span data-stu-id="02c47-112">See [Windows PowerShell Web Access Cmdlets](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps).</span></span>

<span data-ttu-id="02c47-113">Los administradores pueden definir entre `{0-n}` reglas de autenticación para Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-113">Administrators can define `{0-n}` authentication rules for Windows PowerShell Web Access.</span></span> <span data-ttu-id="02c47-114">La seguridad predeterminada es restrictiva más que permisiva; si no se define ninguna regla de autenticación, ningún usuario tendrá acceso a ningún sitio.</span><span class="sxs-lookup"><span data-stu-id="02c47-114">The default security is restrictive rather than permissive; zero authentication rules means no users have access to anything.</span></span>

<span data-ttu-id="02c47-115">[Add-PswaAuthorizationRule](/powershell/module/powershellwebaccess/add-pswaauthorizationrule?view=winserver2012r2-ps) y [Test-PswaAuthorizationRule](/powershell/module/powershellwebaccess/test-pswaauthorizationrule?view=winserver2012r2-ps) de Windows Server 2012 R2 incluyen un parámetro de credenciales que le permite agregar y probar reglas de autorización de Windows PowerShell Web Access desde un equipo remoto o desde una sesión activa de Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-115">[Add-PswaAuthorizationRule](/powershell/module/powershellwebaccess/add-pswaauthorizationrule?view=winserver2012r2-ps) and [Test-PswaAuthorizationRule](/powershell/module/powershellwebaccess/test-pswaauthorizationrule?view=winserver2012r2-ps) in Windows Server 2012 R2 include a Credential parameter that allows you to add and test Windows PowerShell Web Access authorization rules from a remote computer, or from within an active Windows PowerShell Web Access session.</span></span> <span data-ttu-id="02c47-116">Como ocurre con otros cmdlets de Windows PowerShell que tienen un parámetro de credenciales, puede especificar un objeto PSCredential como valor del parámetro.</span><span class="sxs-lookup"><span data-stu-id="02c47-116">As with other Windows PowerShell cmdlets that have a Credential parameter, you can specify a PSCredential object as the value of the parameter.</span></span> <span data-ttu-id="02c47-117">Para crear un objeto PSCredential que contenga las credenciales que quiere pasar a un equipo remoto, ejecute el cmdlet [Get-Credential](/powershell/module/microsoft.powershell.security/Get-Credential).</span><span class="sxs-lookup"><span data-stu-id="02c47-117">To create a PSCredential object that contains credentials you want to pass to a remote computer, run the [Get-Credential](/powershell/module/microsoft.powershell.security/Get-Credential) cmdlet.</span></span>

<span data-ttu-id="02c47-118">Las reglas de autenticación de Windows PowerShell Web Access son reglas de la lista blanca.</span><span class="sxs-lookup"><span data-stu-id="02c47-118">Windows PowerShell Web Access authentication rules are whitelist rules.</span></span> <span data-ttu-id="02c47-119">Cada regla es una definición de una conexión permitida entre usuarios, equipos de destino y [configuraciones de sesión](/powershell/module/microsoft.powershell.core/about/about_session_configurations?view=powershell-5.1) de Windows PowerShell determinadas (también denominadas puntos de conexión o _espacios de ejecución_) en equipos de destino especificados.</span><span class="sxs-lookup"><span data-stu-id="02c47-119">Each rule is a definition of an allowed connection between users, target computers, and particular Windows PowerShell [session configurations](/powershell/module/microsoft.powershell.core/about/about_session_configurations?view=powershell-5.1) (also referred to as endpoints or _runspaces_) on specified target computers.</span></span>
<span data-ttu-id="02c47-120">Para ver una explicación sobre los **espacios de ejecución**, vea [Uso inicial de los espacios de ejecución de PowerShell](https://blogs.technet.microsoft.com/heyscriptingguy/2015/11/26/beginning-use-of-powershell-runspaces-part-1/)</span><span class="sxs-lookup"><span data-stu-id="02c47-120">For an explanation on **runspaces** see [Beginning Use of PowerShell Runspaces](https://blogs.technet.microsoft.com/heyscriptingguy/2015/11/26/beginning-use-of-powershell-runspaces-part-1/)</span></span>

> [!IMPORTANT]
> <span data-ttu-id="02c47-121">Un usuario solo necesita que una regla sea verdadera para obtener el acceso.</span><span class="sxs-lookup"><span data-stu-id="02c47-121">A user needs only one rule to be true to get access.</span></span> <span data-ttu-id="02c47-122">Si a un usuario se le concede acceso a un equipo con acceso de lenguaje completo o acceso únicamente a los cmdlets de administración remota de Windows PowerShell, desde la consola basada en web, el usuario puede saltar a otros equipos conectados al primer equipo de destino e iniciar sesión en ellos.</span><span class="sxs-lookup"><span data-stu-id="02c47-122">If a user is given access to one computer with either full language access or access only to Windows PowerShell remote management cmdlets, from the web-based console, the user can log on (or hop) to other computers that are connected to the first target computer.</span></span> <span data-ttu-id="02c47-123">El modo más seguro de configurar Windows PowerShell Web Access consiste en permitir a los usuarios acceder únicamente a configuraciones de sesión restringidas que les permitan llevar a cabo tareas específicas que, por lo general, deben realizar de forma remota.</span><span class="sxs-lookup"><span data-stu-id="02c47-123">The most secure way to configure Windows PowerShell Web Access is to allow users access only to constrained session configurations that allow them to accomplish specific tasks that they normally need to perform remotely.</span></span>

<span data-ttu-id="02c47-124">Los cmdlets a los que se hace referencia en [Cmdlets de Windows PowerShell Web Access](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps) permiten crear un conjunto de reglas de acceso que se usan para autorizar a un usuario en la puerta de enlace de Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-124">The cmdlets referenced in [Windows PowerShell Web Access Cmdlets](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps) allow to create a set of access rules which are used to authorize a user on the Windows PowerShell Web Access gateway.</span></span> <span data-ttu-id="02c47-125">Las reglas difieren de las listas de control de acceso (ACL) en el equipo de destino y proporcionan un nivel de seguridad adicional para el acceso web.</span><span class="sxs-lookup"><span data-stu-id="02c47-125">The rules are different from the access control lists (ACLs) on the destination computer, and provide an additional layer of security for web access.</span></span> <span data-ttu-id="02c47-126">En la siguiente sección, se proporcionan más detalles sobre la seguridad.</span><span class="sxs-lookup"><span data-stu-id="02c47-126">More details about security are described in the following section.</span></span>

<span data-ttu-id="02c47-127">Si los usuarios no pueden pasar alguno de los niveles de seguridad anteriores, recibirán un mensaje de "acceso denegado" genérico en la ventana del explorador.</span><span class="sxs-lookup"><span data-stu-id="02c47-127">If users cannot pass any of the preceding security layers, they receive a generic 'access denied' message in their browser windows.</span></span> <span data-ttu-id="02c47-128">Si bien los detalles de seguridad se registran en el servidor de puerta de enlace, los usuarios finales no verán ninguna información acerca de cuántos niveles de seguridad pasaron ni en qué nivel se produjo el error de autenticación o de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="02c47-128">Although security details are logged on the gateway server, end users are not shown information about how many security layers they passed, or at which layer the sign-in or authentication failure occurred.</span></span>

<span data-ttu-id="02c47-129">Para más información sobre cómo configurar las reglas de autorización, vea [Configuración de reglas de autorización](#configuring-authorization-rules-and-site-security) en este tema.</span><span class="sxs-lookup"><span data-stu-id="02c47-129">For more information about configuring authorization rules, see [configuring authorization rules](#configuring-authorization-rules-and-site-security) in this topic.</span></span>

### <a name="security"></a><span data-ttu-id="02c47-130">Seguridad</span><span class="sxs-lookup"><span data-stu-id="02c47-130">Security</span></span>

<span data-ttu-id="02c47-131">El modelo de seguridad de Windows PowerShell Web Access tiene cuatro niveles entre un usuario final de la consola basada en web y un equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-131">The Windows PowerShell Web Access security model has four layers between an end user of the web-based console, and a target computer.</span></span> <span data-ttu-id="02c47-132">Los administradores de Windows PowerShell Web Access pueden agregar niveles de seguridad mediante configuración adicional en la consola del Administrador de IIS.</span><span class="sxs-lookup"><span data-stu-id="02c47-132">Windows PowerShell Web Access administrators can add security layers through additional configuration in the IIS Manager console.</span></span> <span data-ttu-id="02c47-133">Para más información sobre la protección de sitios web en la consola del Administrador de IIS, consulte [Configurar la seguridad de los servidores web (IIS 7)](https://technet.microsoft.com/library/cc731278).</span><span class="sxs-lookup"><span data-stu-id="02c47-133">For more information about securing websites in the IIS Manager console, see [Configure Web Server Security (IIS7)](https://technet.microsoft.com/library/cc731278).</span></span>

<span data-ttu-id="02c47-134">Para más información sobre los procedimientos recomendados de IIS y la prevención de ataques por denegación de servicio, consulte [Best Practices for Preventing DoS/Denial of Service Attacks](https://technet.microsoft.com/library/cc750213) (Procedimientos recomendados para impedir ataques por denegación de servicio (DoS)).</span><span class="sxs-lookup"><span data-stu-id="02c47-134">For more information about IIS best practices and preventing denial-of-service attacks, see [Best Practices for Preventing DoS/Denial of Service Attacks](https://technet.microsoft.com/library/cc750213).</span></span>
<span data-ttu-id="02c47-135">Los administradores también pueden comprar e instalar software de autenticación de venta minorista adicional.</span><span class="sxs-lookup"><span data-stu-id="02c47-135">An administrator can also buy and install additional retail authentication software.</span></span>

<span data-ttu-id="02c47-136">En la siguiente tabla, se describen los cuatro niveles de seguridad entre los usuarios finales y los equipos de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-136">The following table describes the four layers of security between end users and target computers.</span></span>

|<span data-ttu-id="02c47-137">Nivel</span><span class="sxs-lookup"><span data-stu-id="02c47-137">Level</span></span>|<span data-ttu-id="02c47-138">Nivel</span><span class="sxs-lookup"><span data-stu-id="02c47-138">Layer</span></span>|
|-|-|
|<span data-ttu-id="02c47-139">1</span><span class="sxs-lookup"><span data-stu-id="02c47-139">1</span></span>|[<span data-ttu-id="02c47-140">características de seguridad de servidor web de IIS</span><span class="sxs-lookup"><span data-stu-id="02c47-140">iis web server security features</span></span>](#iis-web-server-security-features)|
|<span data-ttu-id="02c47-141">2</span><span class="sxs-lookup"><span data-stu-id="02c47-141">2</span></span>|[<span data-ttu-id="02c47-142">autenticación de puerta de enlace basada en formularios de Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="02c47-142">windows powershell web access forms-based gateway authentication</span></span>](#windows-powershell-web-access-forms-based-gateway-authentication)|
|<span data-ttu-id="02c47-143">3</span><span class="sxs-lookup"><span data-stu-id="02c47-143">3</span></span>|[<span data-ttu-id="02c47-144">reglas de autorización de Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="02c47-144">windows powershell web access authorization rules</span></span>](#windows-powershell-web-access-authorization-rules)|
|<span data-ttu-id="02c47-145">4</span><span class="sxs-lookup"><span data-stu-id="02c47-145">4</span></span>|[<span data-ttu-id="02c47-146">reglas de autorización y autenticación de destino</span><span class="sxs-lookup"><span data-stu-id="02c47-146">target authentication and authorization rules</span></span>](#target-authentication-and-authorization-rules)|

<span data-ttu-id="02c47-147">En los siguientes encabezados encontrará información detallada sobre cada nivel:</span><span class="sxs-lookup"><span data-stu-id="02c47-147">Detailed information about each layer can be found under the following headings:</span></span>

#### <a name="iis-web-server-security-features"></a><span data-ttu-id="02c47-148">Características de seguridad de Servidor web de IIS</span><span class="sxs-lookup"><span data-stu-id="02c47-148">IIS Web Server security features</span></span>

<span data-ttu-id="02c47-149">Los usuarios de Windows PowerShell Web Access siempre deben proporcionar un nombre de usuario y una contraseña para autenticar sus cuentas en la puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="02c47-149">Windows PowerShell Web Access users must always provide a user name and password to authenticate their accounts on the gateway.</span></span> <span data-ttu-id="02c47-150">Pero los administradores de Windows PowerShell Web Access también pueden activar o desactivar la autenticación de certificados de cliente opcional (consulte [Instalación y uso de Windows PowerShell Web Access](install-and-use-windows-powershell-web-access.md) para habilitar un certificado de prueba y luego configurar un certificado original).</span><span class="sxs-lookup"><span data-stu-id="02c47-150">However, Windows PowerShell Web Access administrators can also turn optional client certificate authentication on or off, see [install and use windows powershell web access](install-and-use-windows-powershell-web-access.md) to enable a test certificate and, later, how to configure a genuine certificate).</span></span>

<span data-ttu-id="02c47-151">La característica de certificado de cliente opcional, que forma parte de la configuración de Servidor web (IIS), requiere que los usuarios finales tengan un certificado de cliente válido, además de sus nombres de usuario y contraseñas.</span><span class="sxs-lookup"><span data-stu-id="02c47-151">The optional client certificate feature requires end users to have a valid client certificate, in addition to their user names and passwords, and is part of Web Server (IIS) configuration.</span></span> <span data-ttu-id="02c47-152">Cuando el nivel de certificado de cliente está habilitado, la página de inicio de sesión de Windows PowerShell Web Access solicita a los usuarios que proporcionen certificados válidos antes de evaluar sus credenciales de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="02c47-152">When the client certificate layer is enabled, the Windows PowerShell Web Access sign-in page prompts users to provide valid certificates before their sign-in credentials are evaluated.</span></span> <span data-ttu-id="02c47-153">La autenticación de certificados de cliente comprueba automáticamente si existe un certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="02c47-153">Client certificate authentication automatically checks for the client certificate.</span></span> <span data-ttu-id="02c47-154">Si no se encuentra un certificado válido, Windows PowerShell Web Access lo notifica a los usuarios para que lo proporcionen.</span><span class="sxs-lookup"><span data-stu-id="02c47-154">If a valid certificate is not found, Windows PowerShell Web Access informs users, so they can provide the certificate.</span></span> <span data-ttu-id="02c47-155">En el caso de que sí se encuentre uno, Windows PowerShell Web Access abre la página de inicio de sesión para que los usuarios proporcionen sus nombres de usuario y contraseñas.</span><span class="sxs-lookup"><span data-stu-id="02c47-155">If a valid client certificate is found, Windows PowerShell Web Access opens the sign-in page for users to provide their user names and passwords.</span></span>

<span data-ttu-id="02c47-156">A continuación se muestra un ejemplo de una configuración de seguridad adicional proporcionada por Servidor web de IIS.</span><span class="sxs-lookup"><span data-stu-id="02c47-156">This is one example of additional security settings that are offered by IIS Web Server.</span></span> <span data-ttu-id="02c47-157">Para más información sobre otras características de seguridad de IIS, vea [Configure Web Server Security (IIS 7)](https://technet.microsoft.com/library/cc731278) (Configurar la seguridad de los servidores web, IIS 7).</span><span class="sxs-lookup"><span data-stu-id="02c47-157">For more information about other IIS security features, see [Configure Web Server Security (IIS 7)](https://technet.microsoft.com/library/cc731278).</span></span>

#### <a name="windows-powershell-web-access-forms-based-gateway-authentication"></a><span data-ttu-id="02c47-158">Autenticación de puerta de enlace basada en formularios de Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="02c47-158">Windows PowerShell Web Access forms-based gateway authentication</span></span>

<span data-ttu-id="02c47-159">La página de inicio de sesión de Windows PowerShell Web Access requiere un conjunto de credenciales (nombre de usuario y contraseña) y ofrece a los usuarios la opción de proporcionar distintas credenciales para el equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-159">The Windows PowerShell Web Access sign-in page requires a set of credentials (user name and password) and offers users the option of providing different credentials for the target computer.</span></span>
<span data-ttu-id="02c47-160">Si el usuario no proporciona credenciales alternativas, el nombre de usuario y la contraseña principales usados para la conexión con la puerta de enlace también se usarán para la conexión con el equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-160">If the user does not provide alternate credentials, the primary user name and password that are used to connect to the gateway are also used to connect to the target computer.</span></span>

<span data-ttu-id="02c47-161">Las credenciales requeridas se autentican en la puerta de enlace de Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-161">The required credentials are authenticated on the Windows PowerShell Web Access gateway.</span></span> <span data-ttu-id="02c47-162">Estas credenciales deben ser cuentas de usuario válidas en el servidor de puerta de enlace de Windows PowerShell Web Access local o en Active Directory.</span><span class="sxs-lookup"><span data-stu-id="02c47-162">These credentials must be valid user accounts on either the local Windows PowerShell Web Access gateway server, or in Active Directory.</span></span>

#### <a name="windows-powershell-web-access-authorization-rules"></a><span data-ttu-id="02c47-163">Reglas de autorización de Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="02c47-163">Windows PowerShell Web Access authorization rules</span></span>

<span data-ttu-id="02c47-164">Una vez autenticado un usuario en la puerta de enlace, Windows PowerShell Web Access comprueba las reglas de autorización para averiguar si el usuario tiene acceso al equipo de destino solicitado.</span><span class="sxs-lookup"><span data-stu-id="02c47-164">After a user is authenticated at the gateway, Windows PowerShell Web Access checks authorization rules to verify if the user has access to the requested target computer.</span></span> <span data-ttu-id="02c47-165">Una vez completada la autorización correctamente, las credenciales del usuario se pasan al equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-165">After successful authorization, the user's credentials are passed along to the target computer.</span></span>

<span data-ttu-id="02c47-166">Estas reglas solo se evalúan una vez que la puerta de enlace ha autenticado al usuario y antes de que el usuario pueda autenticarse en el equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-166">These rules are evaluated only after a user has been authenticated by the gateway, and before a user can be authenticated on a target computer.</span></span>

#### <a name="target-authentication-and-authorization-rules"></a><span data-ttu-id="02c47-167">Reglas de autorización y autenticación de destino</span><span class="sxs-lookup"><span data-stu-id="02c47-167">Target authentication and authorization rules</span></span>

<span data-ttu-id="02c47-168">El nivel de seguridad final de Windows PowerShell Web Access es la configuración de seguridad propia del equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-168">The final layer of security for Windows PowerShell Web Access is the target computer's own security configuration.</span></span> <span data-ttu-id="02c47-169">Los usuarios deben tener configurados los derechos de acceso correspondientes en el equipo de destino, y en la reglas de autorización de Windows PowerShell Web Access, para ejecutar una consola de Windows PowerShell basada en web que afecte a un equipo de destino mediante Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-169">Users must have the appropriate access rights configured on the target computer, and also in the Windows PowerShell Web Access authorization rules, to run a Windows PowerShell web-based console that affects a target computer through Windows PowerShell Web Access.</span></span>

<span data-ttu-id="02c47-170">Este nivel ofrece los mismos mecanismos de seguridad que evaluarían los intentos de conexión si los usuarios intentaran crear una sesión remota de Windows PowerShell a un equipo de destino desde dentro de Windows PowerShell mediante la ejecución de los cmdlets [Enter-PSSession](/powershell/module/microsoft.powershell.core/Enter-PSSession) o [New-PSSession](/powershell/module/microsoft.powershell.core/new-pssession).</span><span class="sxs-lookup"><span data-stu-id="02c47-170">This layer offers the same security mechanisms that would evaluate connection attempts if users tried to create a remote Windows PowerShell session to a target computer from within Windows PowerShell by running the [Enter-PSSession](/powershell/module/microsoft.powershell.core/Enter-PSSession) or [New-PSSession](/powershell/module/microsoft.powershell.core/new-pssession) cmdlets.</span></span>

<span data-ttu-id="02c47-171">De manera predeterminada, Windows PowerShell Web Access usa el nombre de usuario y la contraseña principales para la autenticación, tanto en la puerta de enlace como en el equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-171">By default, Windows PowerShell Web Access uses the primary user name and password for authentication on both the gateway and the target computer.</span></span> <span data-ttu-id="02c47-172">La página de inicio de sesión basada en web, en una sección titulada **Configuración de conexión opcional**, ofrece a los usuarios la opción de proporcionar distintas credenciales para el equipo de destino, en caso de que sean necesarias.</span><span class="sxs-lookup"><span data-stu-id="02c47-172">The web-based sign-in page, in a section titled **Optional connection settings**, offers users the option of providing different credentials for the target computer, if they are required.</span></span> <span data-ttu-id="02c47-173">Si el usuario no proporciona credenciales alternativas, el nombre de usuario y la contraseña principales usados para la conexión con la puerta de enlace también se usarán para la conexión con el equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-173">If the user does not provide alternate credentials, the primary user name and password that are used to connect to the gateway are also used to connect to the target computer.</span></span>

<span data-ttu-id="02c47-174">Las reglas de autorización se pueden usar para conceder a los usuarios acceso a una configuración de sesión determinada.</span><span class="sxs-lookup"><span data-stu-id="02c47-174">Authorization rules can be used to allow users access to a particular session configuration.</span></span> <span data-ttu-id="02c47-175">Puede crear configuraciones de sesión o _espacios de ejecución restringidos_ para Windows PowerShell Web Access y permitir a usuarios específicos conectarse únicamente a configuraciones de sesión determinadas cuando inician sesión en Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-175">You can create _restricted runspaces_ or session configurations for Windows PowerShell Web Access, and allow specific users to connect only to specific session configurations when they sign in to Windows PowerShell Web Access.</span></span> <span data-ttu-id="02c47-176">Puede usar listas de control de acceso (ACL) para determinar qué usuarios tendrán acceso a extremos específicos y para restringir aún más el acceso al extremo para un conjunto específico de usuarios mediante las reglas de autorización descritas en esta sección.</span><span class="sxs-lookup"><span data-stu-id="02c47-176">You can use access control lists (ACLs) to determine which users have access to specific endpoints, and further restrict access to the endpoint for a specific set of users by using authorization rules described in this section.</span></span> <span data-ttu-id="02c47-177">Para más información sobre los espacios de ejecución restringidos, vea [Creating a constrained runspace](https://msdn.microsoft.com/library/dn614668) (Crear un espacio de ejecución restringido).</span><span class="sxs-lookup"><span data-stu-id="02c47-177">For more information about restricted runspaces, see [Creating a constrained runspace](https://msdn.microsoft.com/library/dn614668).</span></span>

### <a name="configuring-authorization-rules"></a><span data-ttu-id="02c47-178">Configuración de reglas de autorización</span><span class="sxs-lookup"><span data-stu-id="02c47-178">Configuring authorization rules</span></span>

<span data-ttu-id="02c47-179">Es probable que los administradores deseen usar para los usuarios de Windows PowerShell Web Access la misma regla de autorización que ya está definida en su entorno para la administración remota de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="02c47-179">Administrators likely want the same authorization rule for Windows PowerShell Web Access users that is already defined in their environment for Windows PowerShell remote management.</span></span> <span data-ttu-id="02c47-180">El primer procedimiento de esta sección describe cómo agregar una regla de autorización segura que conceda acceso a un usuario que inicia sesión para administrar un equipo dentro de una sola configuración de sesión.</span><span class="sxs-lookup"><span data-stu-id="02c47-180">The first procedure in this section describes how to add a secure authorization rule that grants access to one user, signing in to manage one computer, and within a single session configuration.</span></span> <span data-ttu-id="02c47-181">El segundo procedimiento describe cómo quitar una regla de autorización que ya no se necesita.</span><span class="sxs-lookup"><span data-stu-id="02c47-181">The second procedure describes how to remove an authorization rule that is no longer needed.</span></span>

<span data-ttu-id="02c47-182">Si planea usar configuraciones de sesión personalizadas para permitir a usuarios específicos trabajar solo dentro de espacios de ejecución restringidos en Windows PowerShell Web Access, cree sus propias configuraciones de sesión personalizadas antes de agregar reglas de autorización que hagan referencia a ellas.</span><span class="sxs-lookup"><span data-stu-id="02c47-182">If you plan to use custom session configurations to allow specific users to work only within restricted runspaces in Windows PowerShell Web Access, create your custom session configurations before you add authorization rules that refer to them.</span></span> <span data-ttu-id="02c47-183">No se pueden usar los cmdlets de Windows PowerShell Web Access para crear configuraciones de sesión personalizadas.</span><span class="sxs-lookup"><span data-stu-id="02c47-183">You cannot use the Windows PowerShell Web Access cmdlets to create custom session configurations.</span></span> <span data-ttu-id="02c47-184">Para más información sobre cómo crear configuraciones de sesión personalizadas, vea [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configuration_files).</span><span class="sxs-lookup"><span data-stu-id="02c47-184">For more information about creating custom session configurations, see [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configuration_files).</span></span>

<span data-ttu-id="02c47-185">Los cmdlets de Windows PowerShell Web Access admiten un carácter comodín: un asterisco (\*).</span><span class="sxs-lookup"><span data-stu-id="02c47-185">Windows PowerShell Web Access cmdlets support one wildcard character, an asterisk ( \* ).</span></span> <span data-ttu-id="02c47-186">No se admiten los caracteres comodín dentro de las cadenas. Use un solo asterisco por propiedad (usuarios, equipos o configuraciones de sesión).</span><span class="sxs-lookup"><span data-stu-id="02c47-186">Wildcard characters within strings are not supported; use a single asterisk per property (users, computers, or session configurations).</span></span>

> [!NOTE]
> <span data-ttu-id="02c47-187">Para conocer otros modos de usar las reglas de autorización para conceder acceso a los usuarios y ayudar a proteger el entorno de Windows PowerShell Web Access, vea [Otros ejemplos de escenarios de reglas de autorización](#other-authorization-rule-scenario-examples) en este tema.</span><span class="sxs-lookup"><span data-stu-id="02c47-187">For more ways you can use authorization rules to grant access to users and help secure the Windows PowerShell Web Access environment, see [other authorization rule scenario examples](#other-authorization-rule-scenario-examples) in this topic.</span></span>

#### <a name="to-add-a-restrictive-authorization-rule"></a><span data-ttu-id="02c47-188">Para agregar una regla de autorización restrictiva</span><span class="sxs-lookup"><span data-stu-id="02c47-188">To add a restrictive authorization rule</span></span>

1. <span data-ttu-id="02c47-189">Realice una de las siguientes acciones para abrir una sesión de Windows PowerShell con derechos de usuario elevados.</span><span class="sxs-lookup"><span data-stu-id="02c47-189">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

   - <span data-ttu-id="02c47-190">En el escritorio de Windows, haga clic con el botón derecho en **Windows PowerShell**, en la barra de tareas y, luego,en **Ejecutar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="02c47-190">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>

   - <span data-ttu-id="02c47-191">En la pantalla **Inicio** de Windows, haga clic con el botón derecho en **Windows PowerShell** y, luego, en **Ejecutar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="02c47-191">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

2. <span data-ttu-id="02c47-192">**Paso opcional** Para restringir el acceso de usuario mediante configuraciones de sesión:</span><span class="sxs-lookup"><span data-stu-id="02c47-192">**Optional step** For restricting user access by using session configurations:</span></span>

   <span data-ttu-id="02c47-193">Compruebe que las configuraciones de sesión que quiere usar ya existen en las reglas.</span><span class="sxs-lookup"><span data-stu-id="02c47-193">Verify that the session configurations that you want to use, already exist in your rules .</span></span>

   <span data-ttu-id="02c47-194">Si aún no se han creado, use las instrucciones para crear configuraciones de sesión proporcionadas en [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configuration_files).</span><span class="sxs-lookup"><span data-stu-id="02c47-194">If they have not yet been created, use instructions for creating session configurations in [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configuration_files).</span></span>

3. <span data-ttu-id="02c47-195">Esta regla de autorización concede a un usuario específico acceso a un equipo de la red al que tiene acceso normalmente, con acceso a una configuración de sesión determinada en el ámbito de las necesidades de cmdlet y scripting típicas del usuario.</span><span class="sxs-lookup"><span data-stu-id="02c47-195">This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user'™s typical scripting and cmdlet needs.</span></span> <span data-ttu-id="02c47-196">Escriba lo siguiente y, después, presione **Entrar**.</span><span class="sxs-lookup"><span data-stu-id="02c47-196">Type the following, and then press **Enter**.</span></span>

   ```
   Add-PswaAuthorizationRule -UserName <domain\user | computer\user> `
      -ComputerName <computer_name> -ConfigurationName <session_configuration_name>
   ```

   - <span data-ttu-id="02c47-197">En el siguiente ejemplo, se concede acceso a un usuario llamado _JSmith_ en el dominio _Contoso_ para administrar el equipo _Contoso_214_ y usar una configuración de sesión llamada _NewAdminsOnly_.</span><span class="sxs-lookup"><span data-stu-id="02c47-197">In the following example, a user named _JSmith_ in the _Contoso_ domain is granted access to manage the computer _Contoso_214_, and use a session configuration named _NewAdminsOnly_.</span></span>

   ```powershell
   Add-PswaAuthorizationRule -UserName 'Contoso\JSmith' `
      -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly
   ```

4. <span data-ttu-id="02c47-198">Compruebe que la regla se haya creado mediante la ejecución del cmdlet **Get-PswaAuthorizationRule** o `Test-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName** <computer_name>`.</span><span class="sxs-lookup"><span data-stu-id="02c47-198">Verify that the rule has been created by running either the **Get-PswaAuthorizationRule** cmdlet, or `Test-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName** <computer_name>`.</span></span>
   <span data-ttu-id="02c47-199">Por ejemplo, `Test-PswaAuthorizationRule -UserName Contoso\\JSmith -ComputerName Contoso_214`.</span><span class="sxs-lookup"><span data-stu-id="02c47-199">For example, `Test-PswaAuthorizationRule -UserName Contoso\\JSmith -ComputerName Contoso_214`.</span></span>

#### <a name="to-remove-an-authorization-rule"></a><span data-ttu-id="02c47-200">Para quitar una regla de autorización</span><span class="sxs-lookup"><span data-stu-id="02c47-200">To remove an authorization rule</span></span>

1. <span data-ttu-id="02c47-201">Si aún no tiene abierta ninguna sesión de Windows PowerShell, vea el paso 1 de [Agregar una regla de autorización restrictiva](#to-add-a-restrictive-authorization-rule) de esta sección.</span><span class="sxs-lookup"><span data-stu-id="02c47-201">If a Windows PowerShell session is not already open, see step 1 of [to add a restrictive authorization rule](#to-add-a-restrictive-authorization-rule) in this section.</span></span>

2. <span data-ttu-id="02c47-202">Escriba lo siguiente y, a continuación, presione **Entrar**, donde *identificador de regla* representa el número de identificación único de la regla que desea quitar.</span><span class="sxs-lookup"><span data-stu-id="02c47-202">Type the following, and then press **Enter**, where *rule ID* represents the unique ID number of the rule that you want to remove.</span></span>

   ```
   Remove-PswaAuthorizationRule -ID <rule ID>
   ```

   <span data-ttu-id="02c47-203">Como alternativa, si no conoces el número de identificación, pero sabes el nombre descriptivo de la regla que quieres quitar, puedes conseguir el nombre de la regla y canalizarlo en el cmdlet `Remove-PswaAuthorizationRule` para eliminar la regla, como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="02c47-203">Alternatively, if you do not know the ID number, but know the friendly name of the rule you want to remove, you can get the name of the rule, and pipe it to the `Remove-PswaAuthorizationRule` cmdlet to remove the rule, as shown in the following example:</span></span>

   ```
   Get-PswaAuthorizationRule `
      -RuleName <rule-name> | Remove-PswaAuthorizationRule
   ```

> [!NOTE]
> <span data-ttu-id="02c47-204">No se le pedirá confirmación para eliminar la regla de autorización especificada; esta se eliminará al presionar **Entrar**.</span><span class="sxs-lookup"><span data-stu-id="02c47-204">You are not prompted to confirm whether you want to delete the specified authorization rule; the rule is deleted when you press **Enter**.</span></span> <span data-ttu-id="02c47-205">Asegúrese de que realmente desea quitar la regla antes de ejecutar el cmdlet `Remove-PswaAuthorizationRule`.</span><span class="sxs-lookup"><span data-stu-id="02c47-205">Be sure that you want to remove the authorization rule before running the `Remove-PswaAuthorizationRule` cmdlet.</span></span>

#### <a name="other-authorization-rule-scenario-examples"></a><span data-ttu-id="02c47-206">Ejemplos de otros escenarios de reglas de autorización</span><span class="sxs-lookup"><span data-stu-id="02c47-206">Other authorization rule scenario examples</span></span>

<span data-ttu-id="02c47-207">Cada sesión de Windows PowerShell usa una configuración de sesión. Si esta no se especifica para una sesión, Windows PowerShell usa la configuración de sesión de Windows PowerShell integrada predeterminada, que se llama Microsoft.PowerShell.</span><span class="sxs-lookup"><span data-stu-id="02c47-207">Every Windows PowerShell session uses a session configuration; if one is not specified for a session, Windows PowerShell uses the default, built-in Windows PowerShell session configuration, called Microsoft.PowerShell.</span></span> <span data-ttu-id="02c47-208">La configuración de sesión predeterminada incluye todos los cmdlets que se encuentran disponibles en un equipo.</span><span class="sxs-lookup"><span data-stu-id="02c47-208">The default session configuration includes all cmdlets that are available on a computer.</span></span> <span data-ttu-id="02c47-209">Los administradores pueden restringir el acceso a todos los equipos mediante la definición de una configuración de sesión con un espacio de ejecución restringido (una variedad limitada de cmdlets y tareas que los usuarios finales pueden realizar).</span><span class="sxs-lookup"><span data-stu-id="02c47-209">Administrators can restrict access to all computers by defining a session configuration with a restricted runspace (a limited range of cmdlets and tasks that their end users could perform).</span></span> <span data-ttu-id="02c47-210">Un usuario al que se le concede acceso a un equipo con acceso de lenguaje completo o acceso únicamente a los cmdlets de administración remota de Windows PowerShell puede conectarse a otros equipos conectados al primer equipo.</span><span class="sxs-lookup"><span data-stu-id="02c47-210">A user who is granted access to one computer with either full language access or only the Windows PowerShell remote management cmdlets can connect to other computers that are connected to the first computer.</span></span> <span data-ttu-id="02c47-211">La definición de un espacio de ejecución restringido puede impedir que los usuarios obtengan acceso a otros equipos desde su espacio de ejecución de Windows PowerShell permitido y mejora la seguridad del entorno de Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-211">Defining a restricted runspace can prevent users from accessing other computers from their allowed Windows PowerShell runspace, and improves the security of your Windows PowerShell Web Access environment.</span></span> <span data-ttu-id="02c47-212">La configuración de sesión se puede distribuir (mediante la directiva de grupo) a todos los equipos que los administradores desean que sean accesibles mediante Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-212">The session configuration can be distributed (by using Group Policy) to all computers that administrators want to make accessible through Windows PowerShell Web Access.</span></span> <span data-ttu-id="02c47-213">Para más información sobre las configuraciones de sesión, vea [about_Session_Configurations](https://technet.microsoft.com/library/dd819508.aspx) (Acerca de las configuraciones de sesión).</span><span class="sxs-lookup"><span data-stu-id="02c47-213">For more information about session configurations, see [about_Session_Configurations](https://technet.microsoft.com/library/dd819508.aspx).</span></span> <span data-ttu-id="02c47-214">A continuación, se proporcionan algunos ejemplos de este escenario.</span><span class="sxs-lookup"><span data-stu-id="02c47-214">The following are some examples of this scenario.</span></span>

- <span data-ttu-id="02c47-215">Un administrador crea un punto de conexión, llamado **PswaEndpoint**, con un espacio de ejecución restringido.</span><span class="sxs-lookup"><span data-stu-id="02c47-215">An administrator creates an endpoint, called **PswaEndpoint**, with a restricted runspace.</span></span> <span data-ttu-id="02c47-216">Después, crea una regla, `*,*,PswaEndpoint`, y distribuye el punto de conexión a otros equipos.</span><span class="sxs-lookup"><span data-stu-id="02c47-216">Then, the administrator creates a rule, `*,*,PswaEndpoint`, and distributes the endpoint to other computers.</span></span> <span data-ttu-id="02c47-217">La regla permite a todos los usuarios obtener acceso a todos los equipos con el punto de conexión **PswaEndpoint**.</span><span class="sxs-lookup"><span data-stu-id="02c47-217">The rule allows all users to access all computers with the endpoint **PswaEndpoint**.</span></span>
  <span data-ttu-id="02c47-218">Si esta es la única regla de autorización definida en el conjunto de reglas, no se podrá obtener acceso a los equipos que no tengan ese extremo.</span><span class="sxs-lookup"><span data-stu-id="02c47-218">If this is the only authorization rule defined in the rule set, computers without that endpoint would not be accessible.</span></span>

- <span data-ttu-id="02c47-219">Un administrador ha creado un punto de conexión con un espacio de ejecución restringido, llamado **PswaEndpoint**, y desea restringir el acceso a usuarios específicos.</span><span class="sxs-lookup"><span data-stu-id="02c47-219">The administrator created an endpoint with a restricted runspace called **PswaEndpoint**,and wants to restrict access to specific users.</span></span> <span data-ttu-id="02c47-220">El administrador crea un grupo de usuarios llamado **Level1Support** y define la regla siguiente: **Level1Support,\*,PswaEndpoint**.</span><span class="sxs-lookup"><span data-stu-id="02c47-220">The administrator creates a group of users called **Level1Support**, and defines the following rule: **Level1Support,\*,PswaEndpoint**.</span></span> <span data-ttu-id="02c47-221">La regla concede a cualquier usuario del grupo **Level1Support** acceso a todos los equipos con la configuración **PswaEndpoint**.</span><span class="sxs-lookup"><span data-stu-id="02c47-221">The rule grants any users in the group **Level1Support** access to all computers with the **PswaEndpoint** configuration.</span></span> <span data-ttu-id="02c47-222">De modo semejante, se puede restringir el acceso a un conjunto específico de equipos.</span><span class="sxs-lookup"><span data-stu-id="02c47-222">Similarly, access can be restricted to a specific set of computers.</span></span>

- <span data-ttu-id="02c47-223">Algunos administradores proporcionan a determinados usuarios más acceso que a otros.</span><span class="sxs-lookup"><span data-stu-id="02c47-223">Some administrators provide certain users more access than others.</span></span> <span data-ttu-id="02c47-224">Por ejemplo, un administrador crea dos grupos de usuarios, **Admins** y **BasicSupport**.</span><span class="sxs-lookup"><span data-stu-id="02c47-224">For example, an administrator creates two user groups, **Admins** and **BasicSupport**.</span></span> <span data-ttu-id="02c47-225">El administrador también crea un punto de conexión con un espacio de ejecución restringido llamado **PswaEndpoint** y define las dos reglas siguientes: **Admins,\*,\*** y **BasicSupport,\*,PswaEndpoint**.</span><span class="sxs-lookup"><span data-stu-id="02c47-225">The administrator also creates an endpoint with a restricted runspace called **PswaEndpoint**, and defines the following two rules: **Admins,\*,\*** and **BasicSupport,\*,PswaEndpoint**.</span></span> <span data-ttu-id="02c47-226">La primera regla proporciona a todos los usuarios del grupo **Admin** acceso a todos los equipos y la segunda regla proporciona a todos los usuarios del grupo **BasicSupport** acceso únicamente a los equipos con **PswaEndpoint**.</span><span class="sxs-lookup"><span data-stu-id="02c47-226">The first rule provides all users in the **Admin** group access to all computers, and the second rule provides all users in the **BasicSupport** group access only to those computers with **PswaEndpoint**.</span></span>

- <span data-ttu-id="02c47-227">Un administrador ha configurado un entorno de prueba privado y desea conceder a todos los usuarios de red autorizados acceso a todos los equipos de la red a los que tienen acceso normalmente, con acceso a todas las configuraciones de sesión a las que tienen acceso normalmente.</span><span class="sxs-lookup"><span data-stu-id="02c47-227">An administrator has set up a private test environment, and wants to allow all authorized network users access to all computers on the network to which they typically have access, with access to all session configurations to which they typically have access.</span></span> <span data-ttu-id="02c47-228">Como se trata de un entorno de prueba privado, el administrador crea una regla de autorización que no es segura.</span><span class="sxs-lookup"><span data-stu-id="02c47-228">Because this is a private test environment, the administrator creates an authorization rule that is not secure.</span></span> <span data-ttu-id="02c47-229">- Ejecuta el cmdlet `Add-PswaAuthorizationRule * * *`, que usa el carácter comodín **\*** para representar todos los usuarios, todos los equipos y todas las configuraciones.</span><span class="sxs-lookup"><span data-stu-id="02c47-229">- The administrator runs the cmdlet `Add-PswaAuthorizationRule * * *`, which uses the wildcard character **\*** to represent all users, all computers, and all configurations.</span></span> <span data-ttu-id="02c47-230">- Esta regla equivale a lo siguiente: `Add-PswaAuthorizationRule -UserName * -ComputerName * -ConfigurationName *`.</span><span class="sxs-lookup"><span data-stu-id="02c47-230">- This rule is the equivalent of the following: `Add-PswaAuthorizationRule -UserName * -ComputerName * -ConfigurationName *`.</span></span>

  > [!NOTE]
  > <span data-ttu-id="02c47-231">Esta regla no se recomienda en un entorno seguro, ya que omite el nivel de seguridad de reglas de autorización proporcionado por Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-231">This rule is not recommended in a secure environment, and bypasses the authorization rule layer of security provided by Windows PowerShell Web Access.</span></span>

- <span data-ttu-id="02c47-232">Un administrador debe permitir a los usuarios conectarse a los equipos de destino en un entorno que incluye tanto grupos de trabajo como dominios, en el que los equipos de los grupos de trabajo ocasionalmente se usan para conectar con equipos de destino de los dominios, y los equipos de los dominios ocasionalmente se usan para conectar con equipos de destino de los grupos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="02c47-232">An administrator must allow users to connect to target computers in an environment that includes both workgroups and domains, where workgroup computers are occasionally used to connect to target computers in domains, and computers in domains are occasionally used to connect to target computers in workgroups.</span></span> <span data-ttu-id="02c47-233">El administrador tiene un servidor de puerta de enlace, llamado *PswaServer*, en un grupo de trabajo, y el equipo de destino *srv1.contoso.com* se encuentra en un dominio.</span><span class="sxs-lookup"><span data-stu-id="02c47-233">The administrator has a gateway server, *PswaServer*, in a workgroup; and target computer *srv1.contoso.com* is in a domain.</span></span> <span data-ttu-id="02c47-234">El usuario *Chris* es un usuario local autorizado tanto en el servidor de puerta de enlace del grupo de trabajo como en el equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-234">User *Chris* is an authorized local user on both the workgroup gateway server and the target computer.</span></span> <span data-ttu-id="02c47-235">Su nombre de usuario en el servidor del grupo de trabajo es *chrisLocal* y su nombre de usuario en el equipo de destino es *contoso\\chris*.</span><span class="sxs-lookup"><span data-stu-id="02c47-235">His user name on the workgroup server is *chrisLocal*; and his user name on the target computer is *contoso\\chris*.</span></span> <span data-ttu-id="02c47-236">Para autorizar el acceso de Chris a srv1.contoso.com, el administrador agrega la regla siguiente.</span><span class="sxs-lookup"><span data-stu-id="02c47-236">To authorize access to srv1.contoso.com for Chris, the administrator adds the following rule.</span></span>

```powershell
Add-PswaAuthorizationRule -userName PswaServer\chrisLocal `
   -computerName srv1.contoso.com -configurationName Microsoft.PowerShell
```

<span data-ttu-id="02c47-237">En el ejemplo de regla anterior, se autentica a Chris en el servidor de puerta de enlace y, a continuación, se autoriza su acceso a *srv1*.</span><span class="sxs-lookup"><span data-stu-id="02c47-237">The preceding rule example authenticates Chris on the gateway server, and then authorizes his access to *srv1*.</span></span> <span data-ttu-id="02c47-238">En la página de inicio de sesión, Chris debe proporcionar un segundo conjunto de credenciales en el área **Configuración de conexión opcional** (*contoso\\chris*).</span><span class="sxs-lookup"><span data-stu-id="02c47-238">On the sign-in page, Chris must provide a second set of credentials in the **Optional connection settings** area (*contoso\\chris*).</span></span> <span data-ttu-id="02c47-239">El servidor de puerta de enlace usa el conjunto de credenciales adicional para autenticarlo en el equipo de destino, *srv1.contoso.com*.</span><span class="sxs-lookup"><span data-stu-id="02c47-239">The gateway server uses the additional set of credentials to authenticate him on the target computer, *srv1.contoso.com*.</span></span>

<span data-ttu-id="02c47-240">En el escenario anterior, Windows PowerShell Web Access solo establecerá una conexión correcta con el equipo de destino una vez que se hayan completado correctamente los siguientes procesos (y estos se hayan permitido mediante una regla de autorización como mínimo).</span><span class="sxs-lookup"><span data-stu-id="02c47-240">In the preceding scenario, Windows PowerShell Web Access establishes a successful connection to the target computer only after the following have been successful, and allowed by at least one authorization rule.</span></span>

1. <span data-ttu-id="02c47-241">Autenticación en el servidor de puerta de enlace del grupo de trabajo mediante la adición de un nombre de usuario, con el formato *nombre_servidor*\\*nombre_usuario* a la regla de autorización.</span><span class="sxs-lookup"><span data-stu-id="02c47-241">Authentication on the workgroup gateway server by adding a user name in the format *server_name*\\*user_name* to the authorization rule</span></span>

2. <span data-ttu-id="02c47-242">Autenticación en el equipo cliente mediante credenciales alternativas proporcionadas en la página de inicio de sesión, en el área **Configuración de conexión opcional**</span><span class="sxs-lookup"><span data-stu-id="02c47-242">Authentication on the target computer by using alternate credentials provided on the sign-in page, in the **Optional connection settings** area</span></span>

   > [!NOTE]
   > <span data-ttu-id="02c47-243">Si los equipos de destino y de la puerta de enlace se encuentran en grupos de trabajo o dominios diferentes, se debe establecer una relación de confianza entre los dos equipos del grupo de trabajo, entre los dos dominios o entre el grupo de trabajo y el dominio.</span><span class="sxs-lookup"><span data-stu-id="02c47-243">If gateway and target computers are in different workgroups or domains, a trust relationship must be established between the two workgroup computers, the two domains, or between the workgroup and the domain.</span></span> <span data-ttu-id="02c47-244">Esta relación no se puede configurar mediante los cmdlets de reglas de autorización de Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-244">This relationship cannot be configured by using Windows PowerShell Web Access authorization rule cmdlets.</span></span> <span data-ttu-id="02c47-245">Las reglas de autorización no definen una relación de confianza entre equipos; solo pueden autorizar a los usuarios para que se conecten a equipos de destino y configuraciones de sesión específicos.</span><span class="sxs-lookup"><span data-stu-id="02c47-245">Authorization rules do not define a trust relationship between computers; they can only authorize users to connect to specific target computers and session configurations.</span></span> <span data-ttu-id="02c47-246">Para más información sobre el modo de configurar una relación de confianza entre dominios diferentes, consulte [Creating Domain and Forest Trusts](https://technet.microsoft.com/library/cc794775.aspx) (Creación de confianzas entre dominios y bosques).</span><span class="sxs-lookup"><span data-stu-id="02c47-246">For more information about how to configure a trust relationship between different domains, see [Creating Domain and Forest Trusts](https://technet.microsoft.com/library/cc794775.aspx).</span></span>
   > <span data-ttu-id="02c47-247">Para obtener más información sobre el modo de agregar equipos del grupo de trabajo a una lista de hosts de confianza, consulta el tema [Administración remota con el Administrador del servidor](https://technet.microsoft.com/library/dd759202.aspx).</span><span class="sxs-lookup"><span data-stu-id="02c47-247">For more information about how to add workgroup computers to a trusted hosts list, see [Remote Management with Server Manager](https://technet.microsoft.com/library/dd759202.aspx).</span></span>

### <a name="using-a-single-set-of-authorization-rules-for-multiple-sites"></a><span data-ttu-id="02c47-248">Uso de un solo conjunto de reglas de autorización para varios sitios</span><span class="sxs-lookup"><span data-stu-id="02c47-248">Using a single set of authorization rules for multiple sites</span></span>

<span data-ttu-id="02c47-249">Las reglas de autorización se almacenan en un archivo XML.</span><span class="sxs-lookup"><span data-stu-id="02c47-249">Authorization rules are stored in an XML file.</span></span> <span data-ttu-id="02c47-250">De forma predeterminada, el nombre de la ruta de acceso del archivo XML es `$env:windir\Web\PowershellWebAccess\data\AuthorizationRules.xml`.</span><span class="sxs-lookup"><span data-stu-id="02c47-250">By default, the path name of the XML file is `$env:windir\Web\PowershellWebAccess\data\AuthorizationRules.xml`.</span></span>

<span data-ttu-id="02c47-251">La ruta de acceso al archivo XML de reglas de autorización se almacena en el archivo **powwa.config**, que se encuentra en `$env:windir\Web\PowershellWebAccess\data`.</span><span class="sxs-lookup"><span data-stu-id="02c47-251">The path to the authorization rules XML file is stored in the **powwa.config** file, which is found in `$env:windir\Web\PowershellWebAccess\data`.</span></span> <span data-ttu-id="02c47-252">El administrador tiene flexibilidad para cambiar la referencia a la ruta de acceso predeterminada en **powwa.config** para satisfacer preferencias o cumplir requisitos.</span><span class="sxs-lookup"><span data-stu-id="02c47-252">The administrator has the flexibility to change the reference to the default path in **powwa.config** to suit preferences or requirements.</span></span> <span data-ttu-id="02c47-253">Al permitir al administrador cambiar la ubicación del archivo, se permite que varias puertas de enlace de Windows PowerShell Web Access usen las mismas reglas de autorización, en el caso de que se desee este tipo de configuración.</span><span class="sxs-lookup"><span data-stu-id="02c47-253">Allowing the administrator to change the location of the file lets multiple Windows PowerShell Web Access gateways use the same authorization rules, if such a configuration is desired.</span></span>

## <a name="session-management"></a><span data-ttu-id="02c47-254">Administración de sesiones</span><span class="sxs-lookup"><span data-stu-id="02c47-254">Session management</span></span>

<span data-ttu-id="02c47-255">De forma predeterminada, Windows PowerShell Web Access limita a los usuarios a tres sesiones al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="02c47-255">By default, Windows PowerShell Web Access limits a user to three sessions at one time.</span></span> <span data-ttu-id="02c47-256">Puede editar el archivo **web.config** de la aplicación web en el Administrador de IIS para permitir un número diferente de sesiones por usuario.</span><span class="sxs-lookup"><span data-stu-id="02c47-256">You can edit the web application's **web.config** file in IIS Manager to support a different number of sessions per user.</span></span> <span data-ttu-id="02c47-257">El archivo **web.config** es `$env:windir\Web\PowerShellWebAccess\wwwroot\Web.config`.</span><span class="sxs-lookup"><span data-stu-id="02c47-257">The path to the **web.config** file is `$env:windir\Web\PowerShellWebAccess\wwwroot\Web.config`.</span></span>

<span data-ttu-id="02c47-258">De forma predeterminada, el Servidor web de IIS está configurado para reiniciar el grupo de aplicaciones si se edita alguna configuración.</span><span class="sxs-lookup"><span data-stu-id="02c47-258">By default, IIS Web Server is configured to restart the application pool if any settings are edited.</span></span> <span data-ttu-id="02c47-259">Por ejemplo, el grupo de aplicaciones se reinicia si se realizan cambios en el archivo **web.config**.</span><span class="sxs-lookup"><span data-stu-id="02c47-259">For example, the application pool is restarted if changes are made to the **web.config** file.</span></span> <span data-ttu-id="02c47-260">>Como **Windows PowerShell Web Access** usa estados de sesión en memoria, los usuarios que han iniciado sesiones en **Windows PowerShell Web Access** las pierden cuando el grupo de aplicaciones se reinicia.</span><span class="sxs-lookup"><span data-stu-id="02c47-260">>Because **Windows PowerShell Web Access** uses in-memory session states, >users signed in to **Windows PowerShell Web Access** sessions lose their sessions when the application pool is restarted.</span></span>

### <a name="setting-default-parameters-on-the-sign-in-page"></a><span data-ttu-id="02c47-261">Establecer parámetros predeterminados en la página de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="02c47-261">Setting default parameters on the sign-in page</span></span>

<span data-ttu-id="02c47-262">Si la puerta de enlace de Windows PowerShell Web Access se ejecuta en Windows Server 2012 R2, puede definir valores predeterminados para la configuración que se muestra en la página de inicio de sesión de Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="02c47-262">If your Windows PowerShell Web Access gateway is running on Windows Server 2012 R2, you can configure default values for the settings that are displayed on the Windows PowerShell Web Access sign-in page.</span></span> <span data-ttu-id="02c47-263">Puede configurar valores en el archivo **web.config** que se describe en el párrafo anterior.</span><span class="sxs-lookup"><span data-stu-id="02c47-263">You can configure values in the **web.config** file that is described in the preceding paragraph.</span></span> <span data-ttu-id="02c47-264">Los valores predeterminados para la configuración de la página de inicio de sesión se encuentran en la sección **appSettings** del archivo web.config; a continuación se muestra un ejemplo de la sección **appSettings**.</span><span class="sxs-lookup"><span data-stu-id="02c47-264">Default values for the sign-in page settings are found in the **appSettings** section of the web.config file; the following is an example of the **appSettings** section.</span></span> <span data-ttu-id="02c47-265">Los valores válidos para muchas de estas opciones son los mismos que para los parámetros correspondientes del cmdlet [New-PSSession](https://technet.microsoft.com/library/hh849717.aspx) de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="02c47-265">Valid values for many of these settings are the same as those for the corresponding parameters of the [New-PSSession](https://technet.microsoft.com/library/hh849717.aspx) cmdlet in Windows PowerShell.</span></span>

<span data-ttu-id="02c47-266">Por ejemplo, la clave `defaultApplicationName`, como se muestra en el siguiente bloque de código, es el valor de la variable de preferencia **$PSSessionApplicationName** del equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="02c47-266">For example, the `defaultApplicationName` key, as shown in the following code block, is the value of the **$PSSessionApplicationName** preference variable on the target computer.</span></span>

```xml
  <appSettings>
      <add key="maxSessionsAllowedPerUser" value="3"/>
      <add key="defaultPortNumber" value="5985"/>
      <add key="defaultSSLPortNumber" value="5986"/>
      <add key="defaultApplicationName" value="WSMAN"/>
      <add key="defaultUseSslSelection" value="0"/>
      <add key="defaultAuthenticationType" value="0"/>
      <add key="defaultAllowRedirection" value="0"/>
      <add key="defaultConfigurationName" value="Microsoft.PowerShell"/>
  </appSettings>
```

### <a name="time-outs-and-unplanned-disconnections"></a><span data-ttu-id="02c47-267">Tiempos de espera y desconexiones no planeadas</span><span class="sxs-lookup"><span data-stu-id="02c47-267">Time-outs and unplanned disconnections</span></span>

<span data-ttu-id="02c47-268">Tiempo de espera de las sesiones de Windows PowerShell Web Access. En Windows PowerShell Web Access cuando se ejecuta en Windows Server 2012 se muestra un mensaje de tiempo de espera agotado cuando los usuarios conectados no han realizado ninguna actividad en la sesión en 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="02c47-268">Windows PowerShell Web Access sessions time out. In Windows PowerShell Web Access running on Windows Server 2012, A time-out message is displayed to signed-in users after 15 minutes of session inactivity.</span></span> <span data-ttu-id="02c47-269">Si el usuario no responde dentro de los cinco minutos posteriores al envío del mensaje, la sesión del usuario se cerrará. Puede cambiar los períodos de tiempo de espera de las sesiones en la configuración del sitio web en el Administrador de IIS.</span><span class="sxs-lookup"><span data-stu-id="02c47-269">If the user does not respond within five minutes after the time-out message is displayed, the session is ended, and the user is signed out. You can change time-out periods for sessions in the website settings in IIS Manager.</span></span>

<span data-ttu-id="02c47-270">En Windows PowerShell Web Access cuando se ejecuta en Windows Server 2012 R2, se agota el tiempo de espera de las sesiones después de 20 minutos de inactividad.</span><span class="sxs-lookup"><span data-stu-id="02c47-270">In Windows PowerShell Web Access running on Windows Server 2012 R2, sessions time out, by default, after 20 minutes of inactivity.</span></span> <span data-ttu-id="02c47-271">Si los usuarios están desconectados de sesiones en la consola basada en web debido a errores de red u otros apagados o errores no planificados, y no porque se hayan cerrado las sesiones ellas mismas, las sesiones de Windows PowerShell Web Access continúan ejecutándose, conectadas a equipos de destino, hasta que vence el período de tiempo de espera del cliente.</span><span class="sxs-lookup"><span data-stu-id="02c47-271">If users are disconnected from sessions in the web-based console because of network errors or other unplanned shutdowns or failures, and not because they have closed the sessions themselves, the Windows PowerShell Web Access sessions continue to run, connected to target computers, until the time-out period on the client side lapses.</span></span> <span data-ttu-id="02c47-272">La sesión se desconecta después de los 20 minutos predeterminados o después del período de tiempo de espera especificado por el administrador de la puerta de enlace, el que sea más corto.</span><span class="sxs-lookup"><span data-stu-id="02c47-272">The session is disconnected after either the default 20 minutes, or after the time-out period specified by the gateway administrator, whichever is shorter.</span></span>

<span data-ttu-id="02c47-273">Si el servidor de puerta de enlace está ejecutando Windows Server 2012 R2, Windows PowerShell Web Access permite a los usuarios volver a conectarse a las sesiones guardadas en otro momento, pero cuando errores de red, apagados no planificados u otros errores desconectan las sesiones, los usuarios no pueden ver o volver a conectarse a las sesiones guardadas hasta que haya vencido el período de tiempo de espera especificado por el administrador de la puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="02c47-273">If the gateway server is running Windows Server 2012 R2, Windows PowerShell Web Access lets users reconnect to saved sessions at a later time, but when network errors, unplanned shutdowns, or other failures disconnect sessions, users cannot see or reconnect to saved sessions until after the time-out period specified by the gateway administrator has lapsed.</span></span>

## <a name="see-also"></a><span data-ttu-id="02c47-274">Véase también</span><span class="sxs-lookup"><span data-stu-id="02c47-274">See Also</span></span>

<span data-ttu-id="02c47-275">[Instalación y uso de Windows PowerShell Web Access](https://technet.microsoft.com/library/hh831611(v=ws.11).aspx)</span><span class="sxs-lookup"><span data-stu-id="02c47-275">[Install and Use Windows PowerShell Web Access](https://technet.microsoft.com/library/hh831611(v=ws.11).aspx)</span></span>

[<span data-ttu-id="02c47-276">about_Session_Configurations</span><span class="sxs-lookup"><span data-stu-id="02c47-276">about_Session_Configurations</span></span>](https://technet.microsoft.com/library/dd819508.aspx)

[<span data-ttu-id="02c47-277">Cmdlets de Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="02c47-277">Windows PowerShell Web Access Cmdlets</span></span>](/powershell/module/powershellwebaccess/?view=winserver2012r2-ps)
