---
ms.date: 06/05/2017
keywords: powershell, cmdlet
title: Iniciar el motor de Windows PowerShell 2.0
ms.openlocfilehash: 824077008d2dcfd707e977d2112f0882d07a8aca
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2019
ms.locfileid: "67030429"
---
# <a name="starting-the-windows-powershell-20-engine"></a><span data-ttu-id="9bdb1-103">Iniciar el motor de Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="9bdb1-103">Starting the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="9bdb1-104">En esta sección se explica cómo iniciar el motor de Windows PowerShell 2.0 en Windows 8.1, Windows Server 2012 R2, Windows 8 y Windows Server 2012, que incluyen el motor de Windows PowerShell 2.0, y en otros sistemas que tienen instalado Windows PowerShell 2.0, Windows PowerShell 3.0 y Windows PowerShell 4.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-104">This section explains how to start the Windows PowerShell 2.0 Engine on Windows 8.1, Windows Server 2012 R2, Windows 8, and Windows Server 2012, which include the Windows PowerShell 2.0 Engine, and on other systems on which Windows PowerShell 2.0, Windows PowerShell 3.0, and Windows PowerShell 4.0 are installed.</span></span>

<span data-ttu-id="9bdb1-105">Windows PowerShell 4.0 y Windows PowerShell 3.0 están diseñados para ser compatibles con versiones anteriores de Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-105">Windows PowerShell 4.0 and Windows PowerShell 3.0 are designed to be backwards compatible with Windows PowerShell 2.0.</span></span> <span data-ttu-id="9bdb1-106">Los cmdlets, proveedores, complementos, módulos y scripts escritos para Windows PowerShell 2.0 se ejecutan sin cambios en Windows PowerShell 4.0 y Windows PowerShell 3.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-106">Cmdlets, providers, snap-ins, modules, and scripts written for Windows PowerShell 2.0 run unchanged in Windows PowerShell 4.0 and Windows PowerShell 3.0.</span></span> <span data-ttu-id="9bdb1-107">Sin embargo, debido a un cambio en la directiva de activación de tiempo de ejecución en Microsoft .NET Framework 4, los programas host de Windows PowerShell escritos para Windows PowerShell 2.0 y compilados con Common Language Runtime (CLR) 2.0 no se pueden ejecutar sin modificaciones en Windows PowerShell 3.0 o Windows PowerShell 4.0, que están compilados con CLR 4.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-107">However, due to a change in the runtime activation policy in Microsoft .NET Framework 4, Windows PowerShell host programs that were written for Windows PowerShell 2.0 and compiled with Common Language Runtime (CLR) 2.0 cannot run without modification in Windows PowerShell 3.0 or Windows PowerShell 4.0, which are compiled with CLR 4.0.</span></span> <span data-ttu-id="9bdb1-108">El motor de Windows PowerShell 2.0 está destinado a usarse solo cuando un programa host o un script existente no se puede ejecutar porque es incompatible con Windows PowerShell 4.0, Windows PowerShell 3.0 o Microsoft .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-108">The Windows PowerShell 2.0 Engine is intended to be used only when an existing script or host program cannot run because it is incompatible with Windows PowerShell 4.0, Windows PowerShell 3.0, or Microsoft .NET Framework 4.</span></span> <span data-ttu-id="9bdb1-109">Estos casos deben ser infrecuentes.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-109">Such cases are expected to be rare.</span></span>

<span data-ttu-id="9bdb1-110">Muchos programas que requieren el motor de Windows PowerShell 2.0 lo inician automáticamente.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-110">Many programs that require the Windows PowerShell 2.0 Engine start it automatically.</span></span> <span data-ttu-id="9bdb1-111">Estas instrucciones se incluyen para las situaciones excepcionales en que necesite iniciar el motor de forma manual.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-111">These instructions are included for the rare situations in which you need to start the engine manually.</span></span>

## <a name="installing-and-enabling-required-programs"></a><span data-ttu-id="9bdb1-112">Instalar y habilitar los programas requeridos</span><span class="sxs-lookup"><span data-stu-id="9bdb1-112">Installing and Enabling Required Programs</span></span>

<span data-ttu-id="9bdb1-113">Antes de iniciar el motor de Windows PowerShell 2.0, habilite el motor de Windows PowerShell 2.0 y Microsoft .NET Framework 3.5 con Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-113">Before starting the Windows PowerShell 2.0 Engine, enable the Windows PowerShell 2.0 Engine and Microsoft .NET Framework 3.5 with Service Pack 1.</span></span> <span data-ttu-id="9bdb1-114">Para obtener instrucciones, consulte [instalar Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="9bdb1-114">For instructions, see [Installing Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span></span>

<span data-ttu-id="9bdb1-115">Los sistemas con Windows Management Framework 4.0 o Windows Management Framework 3.0 instalado tienen todos los componentes necesarios.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-115">Systems on which Windows Management Framework 4.0 or Windows Management Framework 3.0 are installed have all of the required components.</span></span> <span data-ttu-id="9bdb1-116">No es necesario realizar ninguna otra configuración.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-116">No further configuration is necessary.</span></span> <span data-ttu-id="9bdb1-117">Para más información sobre cómo instalar [Windows Management Framework 4.0](https://go.microsoft.com/fwlink/?LinkID=293881) o Windows Management Framework 3.0, vea [Installing Windows PowerShell](../install/Installing-Windows-PowerShell.md) (Instalación de Windows PowerShell).</span><span class="sxs-lookup"><span data-stu-id="9bdb1-117">For information about installing [Windows Management Framework 4.0](https://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0, see [Installing Windows PowerShell](../install/Installing-Windows-PowerShell.md).</span></span>

## <a name="how-to-start-the-windows-powershell-20-engine"></a><span data-ttu-id="9bdb1-118">Iniciar el motor de Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="9bdb1-118">How to start the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="9bdb1-119">Al iniciar Windows PowerShell, se inicia la versión más reciente de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-119">When you start Windows PowerShell the newest version starts by default.</span></span> <span data-ttu-id="9bdb1-120">Para iniciar Windows PowerShell con el motor de Windows PowerShell 2.0, use el parámetro Version de PowerShell.exe.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-120">To start Windows PowerShell with the Windows PowerShell 2.0 Engine, use the Version parameter of PowerShell.exe.</span></span> <span data-ttu-id="9bdb1-121">Puede ejecutar el comando en cualquier símbolo del sistema, incluidos Windows PowerShell y Cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-121">You can run the command at any command prompt, including Windows PowerShell and Cmd.exe.</span></span>

```
PowerShell.exe -Version 2
```

## <a name="how-to-start-a-remote-session-with-the-windows-powershell-20-engine"></a><span data-ttu-id="9bdb1-122">Iniciar una sesión remota con el motor de Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="9bdb1-122">How to start a remote session with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="9bdb1-123">Para ejecutar el motor de Windows PowerShell 2.0 en una sesión remota, cree una configuración de sesión (también conocida como "punto de conexión") en el equipo remoto que carga el motor de Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-123">To run the Windows PowerShell 2.0 Engine in a remote session, create a session configuration (also known as an "endpoint") on the remote computer that loads the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="9bdb1-124">La configuración de sesión se guarda en el equipo remoto y puede usarla cualquier usuario autorizado para crear sesiones que usen el motor de Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-124">The session configuration is saved on the remote computer and can be used by any authorized user to create sessions that use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="9bdb1-125">Se trata de una tarea avanzada que suele realizarla un administrador del sistema.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-125">This is an advanced task that is typically performed by a system administrator.</span></span>

<span data-ttu-id="9bdb1-126">El siguiente procedimiento usa el parámetro **PSVersion** del cmdlet [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) para crear una configuración de sesión que use el motor de Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-126">The following procedure uses the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet to create a session configuration that uses the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="9bdb1-127">También puede usar el parámetro **PowerShellVersion** del cmdlet [New-PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) para crear un archivo de configuración de sesión para una sesión que cargue el motor de Windows PowerShell 2.0 y el parámetro **PSVersion** del cmdlet [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) para cambiar una configuración de sesión para que use el motor de Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-127">You can also use the **PowerShellVersion** parameter of the [New-PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet to create a session configuration file for a session that loads the Windows PowerShell 2.0 Engine and you can use the **PSVersion** parameter of the [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parameter to change a session configuration to use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="9bdb1-128">Para más información sobre los archivos de configuración de sesión, vea [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8). Para obtener información sobre las configuraciones de sesión, incluida la de configuración y seguridad,vea [about_Session_Configurations[v4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span><span class="sxs-lookup"><span data-stu-id="9bdb1-128">For more information about session configuration files, see [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8).For information about session configurations, including setup and security, see [about_Session_Configurations[v4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span></span>

#### <a name="to-start-a-remote-windows-powershell-20-session"></a><span data-ttu-id="9bdb1-129">Iniciar una sesión de Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="9bdb1-129">To start a remote Windows PowerShell 2.0 session</span></span>

1. <span data-ttu-id="9bdb1-130">Para crear una configuración de sesión que requiera el motor de Windows PowerShell 2.0, use el parámetro **PSVersion** del cmdlet [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) con un valor de "2.0".</span><span class="sxs-lookup"><span data-stu-id="9bdb1-130">To create a session configuration that requires the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet with a value of "2.0".</span></span> <span data-ttu-id="9bdb1-131">Ejecute este comando en el equipo en el "lado servidor" o en el extremo receptor de la conexión.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-131">Run this command on the computer at the "server side" or receiving end of the connection.</span></span>

   <span data-ttu-id="9bdb1-132">El siguiente comando de ejemplo crea la configuración de sesión PS2 en el equipo Server01.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-132">The following sample command creates the PS2 session configuration on the Server01 computer.</span></span> <span data-ttu-id="9bdb1-133">Para ejecutar este comando, inicie Windows PowerShell 4.0 o Windows PowerShell 3.0 con la opción **Ejecutar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-133">To run this command, start Windows PowerShell 4.0 or Windows PowerShell 3.0 with the **Run as administrator** option.</span></span>

   ```powershell
   Register-PSSessionConfiguration -Name PS2 -PSVersion 2.0
   ```

2. <span data-ttu-id="9bdb1-134">Para crear una sesión en el equipo Server01 que use la configuración de sesión PS2, use el parámetro **ConfigurationName** de los cmdlets que crean una sesión remota, como el cmdlet [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f).</span><span class="sxs-lookup"><span data-stu-id="9bdb1-134">To create a session on the Server01 computer that uses the PS2 session configuration, use the **ConfigurationName** parameter of cmdlets that create a remote session, such as the [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span></span>

   <span data-ttu-id="9bdb1-135">Cuando se inicia una sesión que usa la configuración de sesión, el motor de Windows PowerShell 2.0 se carga automáticamente en la sesión.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-135">When a session that uses the session configuration starts, the Windows PowerShell 2.0 Engine is automatically loaded into the session.</span></span>

   <span data-ttu-id="9bdb1-136">El comando siguiente inicia una sesión en el equipo Server01 que usa la configuración de sesión PS2.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-136">The following command starts a session on the Server01 computer that uses the PS2 session configuration.</span></span> <span data-ttu-id="9bdb1-137">El comando guarda la sesión en la variable $s.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-137">The command saves the session in the $s variable.</span></span>

   ```powershell
   $s = New-PSSession -ComputerName Server01 -ConfigurationName PS2
   ```

## <a name="how-to-start-a-background-job-with-the-windows-powershell-20-engine"></a><span data-ttu-id="9bdb1-138">Iniciar un trabajo en segundo plano con el motor de Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="9bdb1-138">How to start a background job with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="9bdb1-139">Para iniciar un trabajo en segundo plano con el motor de Windows PowerShell 2.0, use el parámetro **PSVersion** del cmdlet [Start-Job](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442).</span><span class="sxs-lookup"><span data-stu-id="9bdb1-139">To start a background job with the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Start-Job](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span></span>

<span data-ttu-id="9bdb1-140">El comando siguiente inicia un trabajo en segundo plano con el motor de Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="9bdb1-140">The following command starts a background job with the Windows PowerShell 2.0 Engine</span></span>

```powershell
Start-Job {Get-Process} -PSVersion 2.0
```

<span data-ttu-id="9bdb1-141">Para obtener más información sobre los trabajos en segundo plano, vea [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span><span class="sxs-lookup"><span data-stu-id="9bdb1-141">For more information about background jobs, see [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span></span>
