---
ms.date: 07/10/2019
keywords: jea,powershell,security
title: Consideraciones de seguridad de JEA
ms.openlocfilehash: befc24fec368c4f6d60477daf63bf17e9431133e
ms.sourcegitcommit: debd2b38fb8070a7357bf1a4bf9cc736f3702f31
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/05/2019
ms.locfileid: "70017776"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="4e67b-103">Consideraciones de seguridad de JEA</span><span class="sxs-lookup"><span data-stu-id="4e67b-103">JEA Security Considerations</span></span>

<span data-ttu-id="4e67b-104">JEA le ayuda a mejorar su posición en materia de seguridad, ya que reduce el número de administradores permanentes de sus equipos.</span><span class="sxs-lookup"><span data-stu-id="4e67b-104">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span> <span data-ttu-id="4e67b-105">En JEA se usa una configuración de sesión de PowerShell para crear un punto de entrada con el fin de que los usuarios administren el sistema.</span><span class="sxs-lookup"><span data-stu-id="4e67b-105">JEA uses a PowerShell session configuration to create a new entry point for users to manage the system.</span></span> <span data-ttu-id="4e67b-106">A los usuarios que necesiten acceso con privilegios elevados, pero no ilimitado, al equipo para realizar tareas administrativas se les puede conceder acceso al punto de conexión de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-106">Users who need elevated, but not unlimited, access to the machine to do administrative tasks can be granted access to the JEA endpoint.</span></span> <span data-ttu-id="4e67b-107">Como JEA permite a estos usuarios ejecutar comandos de administrador sin tener acceso de administrador completo, después puede quitar a esos usuarios de los grupos de seguridad con privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="4e67b-107">Since JEA allows these users to run admin commands without having full admin access, you can then remove those users from highly privileged security groups.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="4e67b-108">Cuenta de ejecución</span><span class="sxs-lookup"><span data-stu-id="4e67b-108">Run-As account</span></span>

<span data-ttu-id="4e67b-109">Cada punto de conexión de JEA tiene una cuenta de **ejecución** designada.</span><span class="sxs-lookup"><span data-stu-id="4e67b-109">Each JEA endpoint has a designated **run-as** account.</span></span> <span data-ttu-id="4e67b-110">Es la cuenta bajo la que se ejecutan las acciones del usuario que se conecta.</span><span class="sxs-lookup"><span data-stu-id="4e67b-110">This is the account under which the connecting user's actions are executed.</span></span> <span data-ttu-id="4e67b-111">Esta cuenta se puede configurar en el [archivo de configuración de sesión](session-configurations.md), y la cuenta que elija influye de forma significativa en la seguridad del punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="4e67b-111">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="4e67b-112">Las **cuentas virtuales** son la forma recomendada de configurar la cuenta de **ejecución**.</span><span class="sxs-lookup"><span data-stu-id="4e67b-112">**Virtual accounts** are the recommended way of configuring the **run-as** account.</span></span> <span data-ttu-id="4e67b-113">Las cuentas virtuales son cuentas locales únicas y temporales creadas por el usuario que se conecta para usarlas durante la sesión de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-113">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span> <span data-ttu-id="4e67b-114">Una vez finalizada la sesión, la cuenta virtual se destruye y ya no se puede volver a usar.</span><span class="sxs-lookup"><span data-stu-id="4e67b-114">As soon as their session is terminated, the virtual account is destroyed and can't be used anymore.</span></span> <span data-ttu-id="4e67b-115">El usuario que se conecta desconoce las credenciales de la cuenta virtual.</span><span class="sxs-lookup"><span data-stu-id="4e67b-115">The connecting user doesn't know the credentials for the virtual account.</span></span> <span data-ttu-id="4e67b-116">La cuenta virtual no se puede usar para acceder al sistema a través de otros medios como Escritorio remoto o un punto de conexión de PowerShell sin restricciones.</span><span class="sxs-lookup"><span data-stu-id="4e67b-116">The virtual account can't be used to access the system via other means like Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="4e67b-117">De manera predeterminada, las cuentas virtuales pertenecen al grupo de **administradores** locales del equipo.</span><span class="sxs-lookup"><span data-stu-id="4e67b-117">By default, virtual accounts belong to the local **Administrators** group on the machine.</span></span> <span data-ttu-id="4e67b-118">Esto les otorga derechos completos para administrar todo en el sistema, pero no les otorga ningún derecho para administrar recursos de la red.</span><span class="sxs-lookup"><span data-stu-id="4e67b-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="4e67b-119">Para la autenticación con otros equipos, el contexto de usuario es el de la cuenta de equipo local, no la cuenta virtual.</span><span class="sxs-lookup"><span data-stu-id="4e67b-119">When authenticating with other machines, the user context is that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="4e67b-120">Los controladores de dominio son un caso especial ya que no hay ningún grupo de **administradores** local.</span><span class="sxs-lookup"><span data-stu-id="4e67b-120">Domain controllers are a special case since there isn't a local **Administrators** group.</span></span> <span data-ttu-id="4e67b-121">En su lugar, las cuentas virtuales pertenecen a **Administradores de dominio** y pueden administrar los servicios de directorio en el controlador de dominio.</span><span class="sxs-lookup"><span data-stu-id="4e67b-121">Instead, virtual accounts belong to **Domain Admins** and can manage the directory services on the domain controller.</span></span> <span data-ttu-id="4e67b-122">La identidad de dominio sigue estando restringida para su uso en el controlador de dominio donde se ha creado la instancia de la sesión de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-122">The domain identity is still restricted for use on the domain controller where the JEA session was instantiated.</span></span> <span data-ttu-id="4e67b-123">En su lugar, cualquier acceso de red parece proceder del objeto de equipo de controlador de dominio.</span><span class="sxs-lookup"><span data-stu-id="4e67b-123">Any network access appears to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="4e67b-124">En ambos casos, puede definir de forma explícita a qué grupos de seguridad pertenece la cuenta virtual.</span><span class="sxs-lookup"><span data-stu-id="4e67b-124">In both cases, you may explicitly define which security groups the virtual account belongs to.</span></span> <span data-ttu-id="4e67b-125">Es un procedimiento recomendado cuando la tarea se puede realizar sin privilegios de administrador local o de dominio.</span><span class="sxs-lookup"><span data-stu-id="4e67b-125">This is a good practice when the task can be done without local or domain admin privileges.</span></span> <span data-ttu-id="4e67b-126">Si ya tiene un grupo de seguridad definido para los administradores, conceda la pertenencia a la cuenta virtual a ese grupo.</span><span class="sxs-lookup"><span data-stu-id="4e67b-126">If you already have a security group defined for your admins, grant the virtual account membership to that group.</span></span> <span data-ttu-id="4e67b-127">La pertenencia al grupo de la cuenta virtual se limita a los grupos de seguridad locales en servidores miembro y estaciones de trabajo.</span><span class="sxs-lookup"><span data-stu-id="4e67b-127">Virtual account group membership is limited to local security groups on workstation and member servers.</span></span> <span data-ttu-id="4e67b-128">En los controladores de dominio, las cuentas virtuales deben ser miembros de grupos de seguridad de dominio.</span><span class="sxs-lookup"><span data-stu-id="4e67b-128">On domain controllers, virtual accounts must be members of domain security groups.</span></span>
<span data-ttu-id="4e67b-129">Una vez agregada la cuenta virtual a uno o varios grupos de seguridad, ya no pertenece a los grupos predeterminados (administradores de dominio o locales).</span><span class="sxs-lookup"><span data-stu-id="4e67b-129">Once the virtual account has been added to one or more security groups, it no longer belongs to the default groups (local or domain admins).</span></span>

<span data-ttu-id="4e67b-130">En la tabla siguiente se resumen las posibles opciones de configuración y los permisos resultantes de las cuentas virtuales:</span><span class="sxs-lookup"><span data-stu-id="4e67b-130">The following table summarizes the possible configuration options and resulting permissions for virtual accounts:</span></span>

|        <span data-ttu-id="4e67b-131">Tipo de equipo</span><span class="sxs-lookup"><span data-stu-id="4e67b-131">Computer type</span></span>         | <span data-ttu-id="4e67b-132">Configuración del grupo de cuenta virtual</span><span class="sxs-lookup"><span data-stu-id="4e67b-132">Virtual account group configuration</span></span> |                   <span data-ttu-id="4e67b-133">Contexto de usuario local</span><span class="sxs-lookup"><span data-stu-id="4e67b-133">Local user context</span></span>                    | <span data-ttu-id="4e67b-134">Contexto de usuario de red</span><span class="sxs-lookup"><span data-stu-id="4e67b-134">Network user context</span></span> |
| ---------------------------- | ----------------------------------- | ------------------------------------------------------- | -------------------- |
| <span data-ttu-id="4e67b-135">Controlador de dominio</span><span class="sxs-lookup"><span data-stu-id="4e67b-135">Domain controller</span></span>            | <span data-ttu-id="4e67b-136">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="4e67b-136">Default</span></span>                             | <span data-ttu-id="4e67b-137">Usuario de dominio, miembro de "*DOMINIO*\Administradores de domino"</span><span class="sxs-lookup"><span data-stu-id="4e67b-137">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="4e67b-138">Cuenta de equipo</span><span class="sxs-lookup"><span data-stu-id="4e67b-138">Computer account</span></span>     |
| <span data-ttu-id="4e67b-139">Controlador de dominio</span><span class="sxs-lookup"><span data-stu-id="4e67b-139">Domain controller</span></span>            | <span data-ttu-id="4e67b-140">Grupos de dominio A y B</span><span class="sxs-lookup"><span data-stu-id="4e67b-140">Domain groups A and B</span></span>               | <span data-ttu-id="4e67b-141">Usuario de dominio, miembro de "*DOMINIO*\A", "*DOMINIO*\B"</span><span class="sxs-lookup"><span data-stu-id="4e67b-141">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="4e67b-142">Cuenta de equipo</span><span class="sxs-lookup"><span data-stu-id="4e67b-142">Computer account</span></span>     |
| <span data-ttu-id="4e67b-143">Servidor miembro o estación de trabajo</span><span class="sxs-lookup"><span data-stu-id="4e67b-143">Member server or workstation</span></span> | <span data-ttu-id="4e67b-144">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="4e67b-144">Default</span></span>                             | <span data-ttu-id="4e67b-145">Usuario local, miembro de "*BUILTIN*\Administradores"</span><span class="sxs-lookup"><span data-stu-id="4e67b-145">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="4e67b-146">Cuenta de equipo</span><span class="sxs-lookup"><span data-stu-id="4e67b-146">Computer account</span></span>     |
| <span data-ttu-id="4e67b-147">Servidor miembro o estación de trabajo</span><span class="sxs-lookup"><span data-stu-id="4e67b-147">Member server or workstation</span></span> | <span data-ttu-id="4e67b-148">Grupos locales C y D</span><span class="sxs-lookup"><span data-stu-id="4e67b-148">Local groups C and D</span></span>                | <span data-ttu-id="4e67b-149">Usuario local, miembro de "*EQUIPO*\C" y "*EQUIPO*\D"</span><span class="sxs-lookup"><span data-stu-id="4e67b-149">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="4e67b-150">Cuenta de equipo</span><span class="sxs-lookup"><span data-stu-id="4e67b-150">Computer account</span></span>     |

<span data-ttu-id="4e67b-151">Al examinar los eventos de auditoría de seguridad y los registros de eventos de la aplicación, puede ver que cada sesión de usuario de JEA tiene una cuenta virtual única.</span><span class="sxs-lookup"><span data-stu-id="4e67b-151">When you look at security audit events and application event logs, you see that each JEA user session has a unique virtual account.</span></span> <span data-ttu-id="4e67b-152">Esta cuenta única ayuda a realizar el seguimiento de las acciones del usuario en un punto de conexión de JEA hasta el usuario original que ha ejecutado el comando.</span><span class="sxs-lookup"><span data-stu-id="4e67b-152">This unique account helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span> <span data-ttu-id="4e67b-153">Los nombres de cuenta virtual siguen el formato `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>`. Por ejemplo, si el usuario **Alice** del dominio **Contoso** reinicia un servicio en un punto de conexión de JEA, el nombre de usuario asociado con todos los eventos del administrador de control de servicio sería `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span><span class="sxs-lookup"><span data-stu-id="4e67b-153">Virtual account names follow the format `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` For example, if user **Alice** in domain **Contoso** restarts a service in a JEA endpoint, the username associated with any service control manager events would be `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span></span>

<span data-ttu-id="4e67b-154">Las **cuentas de servicio administradas de grupo (gMSA)** son útiles cuando un servidor miembro necesita tener acceso a recursos de red en la sesión de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-154">**Group-managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span> <span data-ttu-id="4e67b-155">Por ejemplo, cuando se usa un punto de conexión de JEA para controlar el acceso a una API REST hospedada en otro equipo.</span><span class="sxs-lookup"><span data-stu-id="4e67b-155">For example, when a JEA endpoint is used to control access to a REST API service hosted on a different machine.</span></span> <span data-ttu-id="4e67b-156">Es fácil escribir funciones para invocar las API REST, pero se necesita una identidad de red para autenticarse con la API.</span><span class="sxs-lookup"><span data-stu-id="4e67b-156">It's easy to write functions to invoke the REST APIs, but you need a network identity to authenticate with the API.</span></span> <span data-ttu-id="4e67b-157">El uso de una cuenta de servicio administrada de grupo posibilita el segundo salto, mientras se conserva el control sobre los equipos que pueden usar la cuenta.</span><span class="sxs-lookup"><span data-stu-id="4e67b-157">Using a group-managed service account makes the second hop possible while maintaining control over which computers can use the account.</span></span> <span data-ttu-id="4e67b-158">Los permisos efectivos de la gMSA se definen mediante los grupos de seguridad, ya sean locales o de dominio, a los que pertenece la cuenta gMSA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-158">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="4e67b-159">Cuando un punto de conexión de JEA se configura para usar una cuenta gMSA, parece que las acciones de todos los usuarios de JEA provienen de la misma gMSA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-159">When a JEA endpoint is configured to use a gMSA, the actions of all JEA users appear to come from the same gMSA.</span></span> <span data-ttu-id="4e67b-160">La única manera de realizar el seguimiento de las acciones hasta un usuario específico consiste en identificar el conjunto de comandos que se ejecutan en una transcripción de la sesión de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4e67b-160">The only way to trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="4e67b-161">**Las credenciales de paso a través** se usan cuando no se especifica una cuenta de **ejecución**.</span><span class="sxs-lookup"><span data-stu-id="4e67b-161">**Pass-thru credentials** are used when you don't specify a **run-as** account.</span></span> <span data-ttu-id="4e67b-162">PowerShell usa las credenciales del usuario que se conecta para ejecutar comandos en el servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="4e67b-162">PowerShell uses the connecting user's credential to run commands on the remote server.</span></span> <span data-ttu-id="4e67b-163">Esto requiere que se conceda al usuario de conexión acceso directo a grupos de administración con privilegios.</span><span class="sxs-lookup"><span data-stu-id="4e67b-163">This requires you to grant the connecting user direct access to privileged management groups.</span></span> <span data-ttu-id="4e67b-164">Esta configuración **no** se recomienda para JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-164">This configuration is **not** recommended for JEA.</span></span> <span data-ttu-id="4e67b-165">Si el usuario que se conecta ya tiene privilegios de administrador, puede evitar JEA y administrar el sistema a través de otro medio sin restricciones.</span><span class="sxs-lookup"><span data-stu-id="4e67b-165">If the connecting user already has admin privileges, they can avoid JEA and manage the system via other, unconstrained means.</span></span> <span data-ttu-id="4e67b-166">Para obtener más información, vea la sección siguiente sobre cómo [JEA no protege frente a administradores](#jea-doesnt-protect-against-admins).</span><span class="sxs-lookup"><span data-stu-id="4e67b-166">For more information, see the section below on how [JEA doesn't protect against admins](#jea-doesnt-protect-against-admins).</span></span>

<span data-ttu-id="4e67b-167">Las **cuentas de ejecución estándar** permiten especificar cualquier cuenta de usuario bajo la que se ejecuta toda la sesión de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4e67b-167">**Standard run-as accounts** allow you to specify any user account under which the entire PowerShell session runs.</span></span> <span data-ttu-id="4e67b-168">Las configuraciones de sesión en las que se usan cuentas de **ejecución** fijas (con el parámetro `-RunAsCredential`) no son compatibles con JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-168">Session configurations using fixed **run-as** accounts (with the `-RunAsCredential` parameter) aren't JEA-aware.</span></span> <span data-ttu-id="4e67b-169">Las definiciones de roles ya no funcionan según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="4e67b-169">Role definitions no longer function as expected.</span></span> <span data-ttu-id="4e67b-170">A todos los usuarios autorizados para acceder al punto de conexión se les asigna el mismo rol.</span><span class="sxs-lookup"><span data-stu-id="4e67b-170">Every user authorized to access the endpoint is assigned the same role.</span></span>

<span data-ttu-id="4e67b-171">No se debe usar un elemento **RunAsCredential** en un punto de conexión de JEA, ya que dificulta el seguimiento de las acciones hasta usuarios específicos y carece de compatibilidad para asignar usuarios a roles.</span><span class="sxs-lookup"><span data-stu-id="4e67b-171">You shouldn't use a **RunAsCredential** on a JEA endpoint because it's difficult to trace actions back to specific users and lacks support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="4e67b-172">ACL de punto de conexión de WinRM</span><span class="sxs-lookup"><span data-stu-id="4e67b-172">WinRM Endpoint ACL</span></span>

<span data-ttu-id="4e67b-173">Como sucede con los puntos de conexión de comunicación remota de PowerShell normales, cada punto de conexión de JEA tiene una lista de control de acceso (ACL) independiente que controla quién se puede autenticar con el punto de conexión de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-173">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) that controls who can authenticate with the JEA endpoint.</span></span> <span data-ttu-id="4e67b-174">Si no se ha configurado correctamente, es posible que los usuarios de confianza no puedan acceder al punto de conexión de JEA y que los usuarios que no son de confianza sí.</span><span class="sxs-lookup"><span data-stu-id="4e67b-174">If improperly configured, trusted users may not be able to access the JEA endpoint and untrusted users may have access.</span></span> <span data-ttu-id="4e67b-175">La ACL de WinRM no afecta a la asignación de usuarios a roles de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-175">The WinRM ACL doesn't affect the mapping of users to JEA roles.</span></span> <span data-ttu-id="4e67b-176">La asignación se controla mediante el campo **RoleDefinitions** del archivo de configuración de sesión que se ha usado para registrar el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="4e67b-176">Mapping is controlled by the **RoleDefinitions** field in the session configuration file used to register the endpoint.</span></span>

<span data-ttu-id="4e67b-177">De forma predeterminada, cuando un punto de conexión de JEA tiene varias funcionalidades de rol, la ACL de WinRM se configura para permitir el acceso a todos los usuarios asignados.</span><span class="sxs-lookup"><span data-stu-id="4e67b-177">By default, when a JEA endpoint has multiple role capabilities, the WinRM ACL is configured to allow access to all mapped users.</span></span> <span data-ttu-id="4e67b-178">Por ejemplo, una sesión de JEA configurada con los comandos siguientes concede acceso total a `CONTOSO\JEA_Lev1` y `CONTOSO\JEA_Lev2`.</span><span class="sxs-lookup"><span data-stu-id="4e67b-178">For example, a JEA session configured using the following commands grants full access to `CONTOSO\JEA_Lev1` and `CONTOSO\JEA_Lev2`.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="4e67b-179">Puede auditar los permisos de usuario con el cmdlet [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration).</span><span class="sxs-lookup"><span data-stu-id="4e67b-179">You can audit user permissions with the [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission
```

```Output
Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="4e67b-180">Para cambiar los usuarios que tienen acceso, ejecute `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` para obtener un aviso interactivo o `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` para actualizar los permisos.</span><span class="sxs-lookup"><span data-stu-id="4e67b-180">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span> <span data-ttu-id="4e67b-181">Los usuarios necesitan al menos *derechos de invocación* para tener acceso al punto de conexión de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-181">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="4e67b-182">Es posible crear un punto de conexión de JEA que no asigne un rol definido a todos los usuarios que tienen acceso.</span><span class="sxs-lookup"><span data-stu-id="4e67b-182">It's possible to create a JEA endpoint that doesn't map a defined role to every user that has access.</span></span> <span data-ttu-id="4e67b-183">Estos usuarios pueden iniciar una sesión de JEA, pero solo tienen acceso a los cmdlets predeterminados.</span><span class="sxs-lookup"><span data-stu-id="4e67b-183">These users can start a JEA session, but only have access to the default cmdlets.</span></span> <span data-ttu-id="4e67b-184">Puede auditar los permisos de usuario en un punto de conexión de JEA ejecutando `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="4e67b-184">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span> <span data-ttu-id="4e67b-185">Para obtener más información, vea [Auditoría y creación de informes en JEA](audit-and-report.md).</span><span class="sxs-lookup"><span data-stu-id="4e67b-185">For more information, see [Auditing and Reporting on JEA](audit-and-report.md).</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="4e67b-186">Roles con privilegios mínimos</span><span class="sxs-lookup"><span data-stu-id="4e67b-186">Least privilege roles</span></span>

<span data-ttu-id="4e67b-187">Al diseñar roles de JEA, es importante recordar que la cuenta de servicio administrada de grupo y la cuenta virtual que se ejecutan en segundo plano pueden tener acceso sin restricciones al equipo local.</span><span class="sxs-lookup"><span data-stu-id="4e67b-187">When designing JEA roles, it's important to remember that the virtual and group-managed service accounts running behind the scenes can have unrestricted access to the local machine.</span></span> <span data-ttu-id="4e67b-188">Las funcionalidades de rol de JEA ayudan a limitar los comandos y las aplicaciones que se pueden ejecutar en ese contexto con privilegios.</span><span class="sxs-lookup"><span data-stu-id="4e67b-188">JEA role capabilities help limit the commands and applications that can be run in that privileged context.</span></span>
<span data-ttu-id="4e67b-189">Los roles diseñados de manera incorrecta pueden permitir comandos peligrosos que autoricen a un usuario a salir de los límites de JEA u obtener acceso a información confidencial.</span><span class="sxs-lookup"><span data-stu-id="4e67b-189">Improperly designed roles can allow dangerous commands that may permit a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="4e67b-190">Por ejemplo, observe la siguiente entrada de funcionalidad de rol:</span><span class="sxs-lookup"><span data-stu-id="4e67b-190">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="4e67b-191">Esta funcionalidad de rol permite a los usuarios ejecutar cualquier cmdlet de PowerShell con el nombre **Process** del módulo **Microsoft.PowerShell.Management**.</span><span class="sxs-lookup"><span data-stu-id="4e67b-191">This role capability allows users to run any PowerShell cmdlet with the noun **Process** from the **Microsoft.PowerShell.Management** module.</span></span> <span data-ttu-id="4e67b-192">Es posible que los usuarios necesiten acceder a cmdlets como `Get-Process` para ver qué aplicaciones se ejecutan en el sistema y `Stop-Process` para eliminar cualquier aplicación que no responda.</span><span class="sxs-lookup"><span data-stu-id="4e67b-192">Users may need to access cmdlets like `Get-Process` to see what applications are running on the system and `Stop-Process` to kill applications that aren't responding.</span></span> <span data-ttu-id="4e67b-193">En cambio, esta entrada también permite `Start-Process`, que se puede usar para iniciar un programa arbitrario con permisos de administrador total.</span><span class="sxs-lookup"><span data-stu-id="4e67b-193">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span> <span data-ttu-id="4e67b-194">No es necesario instalar el programa de forma local en el sistema.</span><span class="sxs-lookup"><span data-stu-id="4e67b-194">The program doesn't need to be installed locally on the system.</span></span> <span data-ttu-id="4e67b-195">Un usuario conectado podría iniciar un programa desde un recurso compartido de archivos que proporciona al usuario privilegios de administrador local, ejecuta software malintencionado y mucho más.</span><span class="sxs-lookup"><span data-stu-id="4e67b-195">A connected user could start a program from a file share that gives the user local admin privileges, runs malware, and more.</span></span>

<span data-ttu-id="4e67b-196">Una versión más segura de esta misma funcionalidad de rol tendría el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="4e67b-196">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="4e67b-197">Evite usar caracteres comodín en las funcionalidades de rol.</span><span class="sxs-lookup"><span data-stu-id="4e67b-197">Avoid using wildcards in role capabilities.</span></span> <span data-ttu-id="4e67b-198">No olvide [auditar los permisos de usuario efectivos](audit-and-report.md#check-effective-rights-for-a-specific-user) de forma periódica para comprender qué comandos son accesibles para el usuario.</span><span class="sxs-lookup"><span data-stu-id="4e67b-198">Be sure to regularly [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) to understand which commands are accessible to the user.</span></span>

## <a name="jea-doesnt-protect-against-admins"></a><span data-ttu-id="4e67b-199">JEA no protege frente a administradores</span><span class="sxs-lookup"><span data-stu-id="4e67b-199">JEA doesn't protect against admins</span></span>

<span data-ttu-id="4e67b-200">Uno de los principios básicos de JEA es que permite a los usuarios que no son administradores realizar algunas tareas administrativas.</span><span class="sxs-lookup"><span data-stu-id="4e67b-200">One of the core principles of JEA is that it allows non-admins to do some admin tasks.</span></span> <span data-ttu-id="4e67b-201">JEA no protege frente a los usuarios que ya tienen privilegios de administrador.</span><span class="sxs-lookup"><span data-stu-id="4e67b-201">JEA doesn't protect against users who already have administrator privileges.</span></span> <span data-ttu-id="4e67b-202">Los usuarios que pertenecen a los grupos **Admins. del dominio**, **Administradores** local o a otros grupos con privilegios elevados pueden eludir las protecciones de JEA mediante otros medios.</span><span class="sxs-lookup"><span data-stu-id="4e67b-202">Users who belong **Domain Admins**, local **Administrators**, or other highly privileged groups can circumvent JEA's protections via another means.</span></span> <span data-ttu-id="4e67b-203">Por ejemplo, podrían iniciar sesión con RDP, usar consolas MMC remotas o conectarse a puntos de conexión de PowerShell sin restricciones.</span><span class="sxs-lookup"><span data-stu-id="4e67b-203">For example, they could sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span> <span data-ttu-id="4e67b-204">Además, los administradores locales de un sistema pueden modificar las configuraciones de JEA para permitir usuarios adicionales o cambiar una funcionalidad de rol para ampliar el ámbito de lo que puede realizar un usuario en su sesión de JEA.</span><span class="sxs-lookup"><span data-stu-id="4e67b-204">Also, local admins on a system can modify JEA configurations to allow additional users or change a role capability to extend the scope of what a user can do in their JEA session.</span></span> <span data-ttu-id="4e67b-205">Es importante evaluar los permisos extendidos de los usuarios de JEA para ver si hay otras formas de obtener acceso con privilegios al sistema.</span><span class="sxs-lookup"><span data-stu-id="4e67b-205">It's important to evaluate your JEA users' extended permissions to see if there are other ways to gain privileged access to the system.</span></span>

<span data-ttu-id="4e67b-206">Un procedimiento común consiste en usar JEA para el mantenimiento diario habitual y tener una solución de administración de acceso con privilegios "Just-In-Time" que permita que los usuarios se conviertan de forma temporal en administradores locales en situaciones de emergencia.</span><span class="sxs-lookup"><span data-stu-id="4e67b-206">A common practice is to use JEA for regular day-to-day maintenance and have a just-in-time, privileged access management solution that allows users to temporarily become local admins in emergency situations.</span></span> <span data-ttu-id="4e67b-207">Esto ayuda a garantizar que los usuarios no sean administradores de forma permanente en el sistema, pero puedan obtener esos derechos si, y solo cuando, completen un flujo de trabajo en el que se documente el uso que hacen de esos permisos.</span><span class="sxs-lookup"><span data-stu-id="4e67b-207">This helps ensure users aren't permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>
